/**
 * Noticeable JavaScript SDK - Every change matters.
 *
 * @author Noticeable Team (https://noticeable.io)
 * @date Mon Jan 31 2022 21:42:04 GMT+0000 (Coordinated Universal Time)
 * @version 2.0.0 (commit 4751956)
 *
 * Copyright (c) 2017-2022 Noticeable 
 */
!function(){function e(t){return e='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},e(t)}function t(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(i,o){var a=e.apply(n,r);function s(e){t(a,i,o,s,c,'next',e)}function c(e){t(a,i,o,s,c,'throw',e)}s(void 0)}))}}function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,'value'in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,'prototype',{writable:!1}),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function');e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,'prototype',{writable:!1}),t&&u(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function l(){if('undefined'==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if('function'==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t,n){return d=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&u(i,n.prototype),i},d.apply(null,arguments)}function h(e){var t='function'==typeof Map?new Map:void 0;return h=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf('[native code]')))return e;var n;if('function'!=typeof e)throw new TypeError('Super expression must either be null or a function');if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return d(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,e)},h(e)}function p(e){if(void 0===e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return e}function f(e,t){if(t&&('object'==typeof t||'function'==typeof t))return t;if(void 0!==t)throw new TypeError('Derived constructors may only return object or undefined');return p(e)}function g(e){var t=l();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function _(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}function v(){return v='undefined'!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},v.apply(this,arguments)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:'undefined'!=typeof Symbol&&e[Symbol.iterator]||e['@@iterator'];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(e,t)||E(e,t)||function(){throw new TypeError('Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.')}()}function y(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if('undefined'!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e['@@iterator'])return Array.from(e)}(e)||E(e)||function(){throw new TypeError('Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.')}()}function E(e,t){if(e){if('string'==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return'Object'===n&&e.constructor&&(n=e.constructor.name),'Map'===n||'Set'===n?Array.from(e):'Arguments'===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){var n='undefined'!=typeof Symbol&&e[Symbol.iterator]||e['@@iterator'];if(!n){if(Array.isArray(e)||(n=E(e))||t&&e&&'number'==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError('Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.')}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}var I,R;function T(e){throw new Error(e)}!function(e){e.PLAN_UPGRADE_REQUIRED='plan-upgrade-required',e.PROJECT_DATA_MISSING='project-data-missing',e.WIDGET_ALREADY_RENDERED='widget-already-rendered',e.WIDGET_DATA_MISSING='widget-data-missing',e.WIDGET_DISABLED='widget-disabled',e.WIDGET_DISABLED_MOBILE='widget-disabled-mobile'}(I||(I={})),function(e){e.WIDGET_CLOSED='widget:closed',e.WIDGET_HIDDEN='widget:hidden',e.WIDGET_NOTIFICATION_EMAIL_SUBSCRIBED='widget:notification:email:subscribed',e.WIDGET_NOTIFICATION_PUSH_SUBSCRIBED='widget:notification:push:subscribed',e.WIDGET_OPENED='widget:opened',e.WIDGET_PUBLICATION_COMMENT_CREATED='widget:publication:comment:created',e.WIDGET_PUBLICATION_REACTION_CREATED='widget:publication:reaction:created',e.WIDGET_PUBLICATION_REACTION_UPDATED='widget:publication:reaction:updated',e.WIDGET_PUBLICATION_UNREAD_COUNT_CHANGED='widget:publication:unread_count:changed',e.WIDGET_PUBLICATION_UNSEEN_COUNT_CHANGED='widget:publication:unseen_count:changed',e.WIDGET_READY='widget:ready',e.WIDGET_REFRESHED='widget:refreshed',e.WIDGET_RENDERING_ABORTED='widget:rendering:aborted',e.WIDGET_TRIGGER_READY='widget:trigger:ready',e.WIDGET_TRIGGER_REFRESHED='widget:trigger:refreshed',e.WIDGET_TRIGGER_VIEW_CLICKED='widget:trigger_view:clicked',e.WIDGET_TRIGGER_VIEW_MOUSE_ENTERED='widget:trigger_view:mouse_entered',e.WIDGET_TRIGGER_VIEW_MOUSE_LEFT='widget:trigger_view:mouse_left',e.WIDGET_VISIBLE='widget:visible',e.WIDGET_WIDGET_VIEW_MOUSE_ENTERED='widget:widget_view:mouse_entered',e.WIDGET_WIDGET_VIEW_MOUSE_LEFT='widget:widget_view:mouse_left'}(R||(R={}));var O,S=function(){function e(){r(this,e),a(this,'_listeners',void 0),this._listeners=new Map}return o(e,[{key:'dispatchEvent',value:function(e,t,n){var r=this._listeners.get(e);if(r){var i=r.get(t);i&&i({detail:n,resourceId:e,type:t})}}},{key:'hasListener',value:function(e){var t=this._listeners.get(e);if(!t)return!1;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];if(void 0!==t.get(s))return!0}return!1}},{key:'removeListener',value:function(t,n){e._checkEventSupported(n);var r=this._listeners.get(t);return!!r&&r.delete(n)}},{key:'removeListeners',value:function(e){return this._listeners.delete(e)}},{key:'removeListenersByEventType',value:function(e){var t,n=!1,r=w(this._listeners);try{for(r.s();!(t=r.n()).done;){var i=m(t.value,2),o=i[0];i[1];n=n||this._listeners[o].delete(e)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:'setListener',value:function(t,n,r){e._checkEventSupported(t);var i=this._listeners.get(n);i||(i=new Map),i.set(t,r),this._listeners.set(n,i)}}],[{key:'_checkEventSupported',value:function(e){Object.values(R).includes(e)||T('Unknown event name: '+e)}}]),e}();!function(e){e[e.DEBUG=0]='DEBUG',e[e.INFO=1]='INFO',e[e.WARNING=2]='WARNING',e[e.ERROR=3]='ERROR'}(O||(O={}));var A=function(){function e(){r(this,e)}return o(e,null,[{key:'debug',value:function(t){if(this._level<=O.DEBUG){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e._log('debug',t,r)}}},{key:'error',value:function(t){if(this._level<=O.ERROR){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e._log('error',t,r)}}},{key:'info',value:function(t){if(this._level<=O.INFO){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e._log('info',t,r)}}},{key:'setLevel',value:function(e){this._level=e}},{key:'warn',value:function(t){if(this._level<=O.WARNING){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e._log('warn',t,r)}}},{key:'_log',value:function(t,n,r){window.console&&console[t]&&console[t].apply(console,[''.concat(e.PREFIX).concat(n)].concat(y(r)))}}]),e}();a(A,'PREFIX','[noticeable] '),a(A,'_level',O.INFO);!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i='function'==typeof Symbol?Symbol:{},o=i.iterator||'@@iterator',a=i.asyncIterator||'@@asyncIterator',s=i.toStringTag||'@@toStringTag';function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},'')}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof _?t:_,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(e,t,n){var r=d;return function(i,o){if(r===p)throw new Error('Generator is already running');if(r===f){if('throw'===i)throw o;return C()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===g)continue;return s}}if('next'===n.method)n.sent=n._sent=n.arg;else if('throw'===n.method){if(r===d)throw r=f,n.arg;n.dispatchException(n.arg)}else'return'===n.method&&n.abrupt('return',n.arg);r=p;var c=l(e,t,n);if('normal'===c.type){if(r=n.done?f:h,c.arg===g)continue;return{value:c.arg,done:n.done}}'throw'===c.type&&(r=f,n.method='throw',n.arg=c.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:'normal',arg:e.call(t,n)}}catch(e){return{type:'throw',arg:e}}}e.wrap=u;var d='suspendedStart',h='suspendedYield',p='executing',f='completed',g={};function _(){}function v(){}function m(){}var y={};c(y,o,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(N([])));b&&b!==n&&r.call(b,o)&&(y=b);var w=m.prototype=_.prototype=Object.create(y);function I(e){['next','throw','return'].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(i,o,a,s){var c=l(e[i],e,o);if('throw'!==c.type){var u=c.arg,d=u.value;return d&&'object'==typeof d&&r.call(d,'__await')?t.resolve(d.__await).then((function(e){n('next',e,a,s)}),(function(e){n('throw',e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n('throw',e,a,s)}))}s(c.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function T(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,'throw'===n.method){if(e.iterator.return&&(n.method='return',n.arg=t,T(e,n),'throw'===n.method))return g;n.method='throw',n.arg=new TypeError('The iterator does not provide a \'throw\' method')}return g}var i=l(r,e.iterator,n.arg);if('throw'===i.type)return n.method='throw',n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,'return'!==n.method&&(n.method='next',n.arg=t),n.delegate=null,g):o:(n.method='throw',n.arg=new TypeError('iterator result is not an object'),n.delegate=null,g)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type='normal',delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:'root'}],e.forEach(O,this),this.reset(!0)}function N(e){if(e){var n=e[o];if(n)return n.call(e);if('function'==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:C}}function C(){return{value:t,done:!0}}return v.prototype=m,c(w,'constructor',m),c(m,'constructor',v),v.displayName=c(m,s,'GeneratorFunction'),e.isGeneratorFunction=function(e){var t='function'==typeof e&&e.constructor;return!!t&&(t===v||'GeneratorFunction'===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,s,'GeneratorFunction')),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},I(R.prototype),c(R.prototype,a,(function(){return this})),e.AsyncIterator=R,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new R(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,s,'Generator'),c(w,o,(function(){return this})),c(w,'toString',(function(){return'[object Generator]'})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=N,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method='next',this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)'t'===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if('throw'===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type='throw',s.arg=e,n.next=r,i&&(n.method='next',n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if('root'===a.tryLoc)return i('end');if(a.tryLoc<=this.prev){var c=r.call(a,'catchLoc'),u=r.call(a,'finallyLoc');if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error('try statement without catch or finally');if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,'finallyLoc')&&this.prev<i.finallyLoc){var o=i;break}}o&&('break'===e||'continue'===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method='next',this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if('throw'===e.type)throw e.arg;return'break'===e.type||'continue'===e.type?this.next=e.arg:'return'===e.type?(this.rval=this.arg=e.arg,this.method='return',this.next='end'):'normal'===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if('throw'===r.type){var i=r.arg;S(n)}return i}}throw new Error('illegal catch attempt')},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},'next'===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){'object'==typeof globalThis?globalThis.regeneratorRuntime=t:Function('r','regeneratorRuntime = r')(t)}}({exports:{}});var N,C=function(){function e(t){r(this,e),a(this,'_autoRefreshTimer',void 0),a(this,'_projects',void 0),a(this,'_publicationDataCache',void 0),a(this,'_widgets',void 0),this._projects=new Set,this._widgets=t,this._configurePageVisibilityListener()}var t;return o(e,[{key:'_configurePageVisibilityListener',value:function(){var e;void 0!==document.hidden?e='visibilitychange':void 0!==document.msHidden?e='msvisibilitychange':void 0!==document.webkitHidden&&(e='webkitvisibilitychange'),void 0===document.addEventListener||void 0===document.hidden?A.warn('Your browser does not support the Page Visibility API. We suggest upgrading your browser to get a full experience'):document.addEventListener(e,this._onPageVisibilityChange.bind(this),!1)}},{key:'_onPageVisibilityChange',value:function(){document.hidden?this.stop():this.start(!0)}},{key:'_refresh',value:(t=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d,h,p,f,g,_,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._publicationDataCache){e.next=2;break}return e.abrupt('return');case 2:A.debug('Starting auto-refresh iteration...'),t=new Map,n=w(this._widgets),e.prev=5,n.s();case 7:if((r=n.n()).done){e.next=16;break}if(i=m(r.value,2),o=i[0],a=i[1],!this._projects.has(a.projectId)){e.next=14;break}return e.next=12,a.getPublicationState();case 12:s=e.sent,t.set(o,s);case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),n.e(e.t0);case 21:return e.prev=21,n.f(),e.finish(21);case 24:c=w(this._projects);try{for(c.s();!(u=c.n()).done;)l=u.value,A.debug('Invalidating publication data for project '.concat(l)),this._publicationDataCache.invalidate(l)}catch(e){c.e(e)}finally{c.f()}d=w(this._widgets),e.prev=27,d.s();case 29:if((h=d.n()).done){e.next=43;break}if(p=m(h.value,2),f=p[0],g=p[1],!this._projects.has(g.projectId)){e.next=41;break}return _=t.get(f),A.debug('Refreshing widget '.concat(f)),e.next=36,g.refresh();case 36:return e.next=38,g.getPublicationState();case 38:v=e.sent,(null==_?void 0:_.unreadCount)!==v.unreadCount&&g.eventRegistry.dispatchEvent(g.id,R.WIDGET_PUBLICATION_UNREAD_COUNT_CHANGED,{value:v.unreadCount}),(null==_?void 0:_.unseenCount)!==v.unseenCount&&g.eventRegistry.dispatchEvent(g.id,R.WIDGET_PUBLICATION_UNSEEN_COUNT_CHANGED,{value:v.unseenCount});case 41:e.next=29;break;case 43:e.next=48;break;case 45:e.prev=45,e.t1=e.catch(27),d.e(e.t1);case 48:return e.prev=48,d.f(),e.finish(48);case 51:case'end':return e.stop()}}),e,this,[[5,18,21,24],[27,45,48,51]])}))),function(){return t.apply(this,arguments)})},{key:'add',value:function(e){this._projects.add(e),this.start()}},{key:'delete',value:function(e){this._projects.delete(e),this._autoRefreshTimer&&0===this._projects.size&&this.stop()}},{key:'start',value:function(){var t=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!this._autoRefreshTimer&&this._projects.size>0&&(A.debug('Starting auto-refresh...'),this._autoRefreshTimer=setInterval(n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',t._refresh());case 1:case'end':return e.stop()}}),e)}))),e.AUTO_REFRESH_INTERVAL),r&&this._refresh())}},{key:'stop',value:function(){this._autoRefreshTimer&&(A.debug('Stopping auto-refresh...'),clearInterval(this._autoRefreshTimer),this._autoRefreshTimer=void 0)}},{key:'publicationDataCache',set:function(e){this._publicationDataCache=e}}]),e}();a(C,'AUTO_REFRESH_INTERVAL',3e5);!function(e){e.LTR='ltr',e.RTL='rtl'}(N||(N={}));const k=new Map;var D;!function(e){e.NEWSPAGE='newspage',e.TRIGGER_VIEW='trigger',e.WIDGET_VIEW='widget'}(D||(D={}));class P{constructor(e,t){this.DEFAULT_LANGUAGE_TAG='en-US',this.metadata=e,this.phrasesByLanguageTag=t}static format(e,t,n='en',r={}){let i=null==e?t:e;if(Object.keys(r).length>0)for(const e in r){const t=`{${e}}`;i=i.replace(new RegExp(t,'g'),r[e])}return i}static async load(e,t){if('none'===t)return new P({id:'none',languages:[]},k);const n='https://phrases.noticeable.io/1.39.0/'+e,r=await P.fetch(`${n}/${t}/metadata.json`),i=new Map,o=[];for(const e of r.languages)o.push(P.fetch(`${n}/${t}/${t}.${e}.json`).catch((e=>(console.error(e),{}))));const a=await Promise.all(o);let s=0;for(const e of r.languages){const t=a[s],n=Object.entries(t),r=new Map;for(const[e,t]of n)t.key=e,r.set(e,t);i.set(e,r),s++}return new P(r,i)}static async fetch(e){return await(await fetch(e)).json()}phrases(e=this.DEFAULT_LANGUAGE_TAG){let t=this.phrasesByLanguageTag.get(e);return t||(t=this.phrasesByLanguageTag.get(this.DEFAULT_LANGUAGE_TAG),t)?t:k}phrase(e,t){return this.phrases(e).get(t)}}function x(e){if(!e)return 0;for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t}function L(){return window.matchMedia('only screen and (max-width: 760px)').matches}function U(e){return class{static getDirection(e){switch(e){case'ar':case'ar-001':case'ar-AE':case'ar-BH':case'ar-DJ':case'ar-DZ':case'ar-EG':case'ar-EH':case'ar-ER':case'ar-IL':case'ar-IQ':case'ar-JO':case'ar-KM':case'ar-KW':case'ar-LB':case'ar-LY':case'ar-MA':case'ar-MR':case'ar-OM':case'ar-PS':case'ar-QA':case'ar-SA':case'ar-SD':case'ar-SO':case'ar-SS':case'ar-SY':case'ar-TD':case'ar-TN':case'ar-YE':case'ckb':case'ckb-IQ':case'ckb-IR':case'fa':case'fa-AF':case'fa-IR':case'he':case'he-IL':case'ks':case'ks-IN':case'lrc':case'lrc-IQ':case'lrc-IR':case'mzn':case'mzn-IR':case'pa-Arab':case'pa-Arab-PK':case'ps':case'ps-AF':case'sd':case'sd-PK':case'ug':case'ug-CN':case'ur':case'ur-IN':case'ur-PK':case'uz-Arab':case'uz-Arab-AF':case'yi':case'yi-001':return N.RTL;default:return N.LTR}}}.getDirection(e)===N.RTL}function G(e){return e+'px'}var W,j,M,B,V,H=function(){function e(t){r(this,e),a(this,'_autoRefresher',void 0),a(this,'_projectDataCache',void 0),a(this,'_projectDataFetcher',void 0),a(this,'_publicationDataCache',void 0),a(this,'_publicationDataFetcher',void 0),a(this,'_widgetDataCache',void 0),a(this,'_widgetDataFetcher',void 0),this._autoRefresher=t,this._projectDataCache=new z,this._projectDataFetcher=new Z,this._publicationDataCache=new Y,this._publicationDataFetcher=new X,this._widgetDataCache=new K,this._widgetDataFetcher=new $,this._autoRefresher.publicationDataCache=this._publicationDataCache}var t,i,s;return o(e,[{key:'getProjectData',value:(s=n(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',this._projectDataCache.getOrCompute(t,(function(e,r){return n._projectDataFetcher.fetch(t)})));case 1:case'end':return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:'getPublicationData',value:(i=n(regeneratorRuntime.mark((function e(t,n){var r,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',this._publicationDataCache.getOrCompute({projectId:t,labels:null!==(r=null==n?void 0:n.labels)&&void 0!==r?r:[],segments:null!==(i=null==n?void 0:n.segments)&&void 0!==i?i:[]},(function(e,r){return o._publicationDataFetcher.fetch(t,n)})));case 1:case'end':return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:'getWidgetData',value:(t=n(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',this._widgetDataCache.getOrCompute(t,function(){var e=n(regeneratorRuntime.mark((function e(n,i){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._widgetDataFetcher.fetch(t);case 2:return null!=(a=e.sent)&&null!==(o=a.widgetViewSettings)&&void 0!==o&&o.autoRefresh&&a.widgetViewSettings.autoRefresh>0?r._autoRefresher.add(a.projectId):null!=a&&a.projectId&&r._autoRefresher.delete(a.projectId),e.abrupt('return',a);case 5:case'end':return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case'end':return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:'invalidateProjectData',value:function(e){return this._projectDataCache.invalidate(e)}},{key:'invalidatePublicationData',value:function(e){return this._publicationDataCache.invalidate(e)}},{key:'invalidateWidgetData',value:function(e){return this._widgetDataCache.invalidate(e)}},{key:'setProjectCacheControl',value:function(e){this._projectDataFetcher.setCacheControl(e)}},{key:'setPublicationCacheControl',value:function(e){this._publicationDataFetcher.setCacheControl(e)}},{key:'setWidgetCacheControl',value:function(e){this._widgetDataFetcher.setCacheControl(e)}}]),e}(),F=function(){function e(){r(this,e),a(this,'_data',void 0),this._data=new Map}var t,i;return o(e,[{key:'getOrCompute',value:(i=n(regeneratorRuntime.mark((function e(t,n){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._id(t),void 0!==(i=this._data.get(r))){e.next=6;break}return e.next=5,this._compute(r,t,n);case 5:i=e.sent;case 6:return e.abrupt('return',i);case 7:case'end':return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:'invalidate',value:function(e){return this._data.delete(this._id(e))}},{key:'_compute',value:(t=n(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,n);case 2:return(i=e.sent)&&this._data.set(t,i),e.abrupt('return',i);case 5:case'end':return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}(),z=function(e){s(n,e);var t=g(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:'_id',value:function(e){return x(e)}}]),n}(F),Y=function(t){s(l,t);var i,u=g(l);function l(){var e;return r(this,l),a(p(e=u.call(this)),'_dataByProjectId',void 0),e._dataByProjectId=new Map,e}return o(l,[{key:'invalidate',value:function(e){if(void 0===e){var t=this._data.size>0;return this._dataByProjectId.clear(),this._data.clear(),t}if('string'==typeof e){var n=this._dataByProjectId.get(e);if(n){var r,i=w(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;this._data.delete(o)}}catch(e){i.e(e)}finally{i.f()}return this._dataByProjectId.delete(e),!0}return!1}var a=e.projectId;if(a){var s=this._id(e);this._data.delete(s);var c=this._dataByProjectId.get(a);return c&&(1===c.size&&c.has(s)?this._dataByProjectId.delete(a):c.delete(s)),!0}return!1}},{key:'_compute',value:(i=n(regeneratorRuntime.mark((function e(t,n,r){var i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(c(l.prototype),'_compute',this).call(this,t,n,r);case 2:return(i=e.sent)&&(o=n.projectId,(a=this._dataByProjectId.get(o))||(a=new Set,this._dataByProjectId.set(o,a)),a.add(t)),e.abrupt('return',i);case 5:case'end':return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:'_id',value:function(t){for(var n='',r=0,i=Object.entries(t);r<i.length;r++){var o=m(i[r],2),a=o[0],s=o[1],c=e(s);'string'===c?n+=''.concat(a,'=').concat(s,';'):Array.isArray(s)?n+=''.concat(a,'=').concat(y(s).sort().join(','),';'):'boolean'===c?n+=''.concat(a,'=').concat(s?'0':'1',';'):'number'===c?n+=''.concat(a,'=').concat(s,';'):A.warn('Skipping unsupported property '.concat(a,' while computing resourceId for ').concat(t))}return x(n)}}]),l}(F),K=function(e){s(n,e);var t=g(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:'_id',value:function(e){return x(e)}}]),n}(F),J=function(){function e(t,n){r(this,e),a(this,'_cacheControl',void 0),a(this,'_resourceName',void 0),a(this,'_resourceUrlBuilder',void 0),this._cacheControl=!0,this._resourceName=t,this._resourceUrlBuilder=n}var t,i;return o(e,[{key:'fetch',value:(i=n(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetch(t,n);case 2:return e.abrupt('return',e.sent);case 3:case'end':return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:'setCacheControl',value:function(e){this._cacheControl=e}},{key:'_fetchHeaders',value:function(e,t){var n=new Headers;return e||n.append('noticeable-cache','false'),n}},{key:'_fetch',value:(t=n(regeneratorRuntime.mark((function e(t,n){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._resourceUrl(t),A.debug('Fetching resource '.concat(t,' with options=').concat(JSON.stringify(n),': ').concat(r)),e.prev=2,e.next=5,fetch(r,{headers:this._fetchHeaders(this._cacheControl,n)});case 5:return i=e.sent,e.next=8,i.json();case 8:return e.abrupt('return',e.sent);case 11:e.prev=11,e.t0=e.catch(2),A.error('Error while updating '.concat(this._resourceName,' data from url: ').concat(r));case 14:case'end':return e.stop()}}),e,this,[[2,11]])}))),function(e,n){return t.apply(this,arguments)})},{key:'_resourceUrl',value:function(e){return this._resourceUrlBuilder(e)}}]),e}(),Z=function(e){s(n,e);var t=g(n);function n(){return r(this,n),t.call(this,'project',(function(e){return'https://data.widgets.noticeable.io/projects/'+e}))}return o(n)}(J),X=function(e){s(a,e);var t,i=g(a);function a(){return r(this,a),i.call(this,'publication',(function(e){return'https://data.widgets.noticeable.io/projects/'+e+'/publications'}))}return o(a,[{key:'fetch',value:(t=n(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&void 0!==n.limit&&n.limit<=0)){e.next=2;break}return e.abrupt('return',[]);case 2:return e.abrupt('return',v(c(a.prototype),'fetch',this).call(this,t,n));case 3:case'end':return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:'_fetchHeaders',value:function(e,t){var n,r,i=v(c(a.prototype),'_fetchHeaders',this).call(this,e,t);return null!=t&&null!==(n=t.labels)&&void 0!==n&&n.length&&t.labels.length>0&&i.append('noticeable-labels',t.labels.join(',')),null!=t&&t.limit&&i.append('noticeable-limit',t.limit.toString()),null!=t&&null!==(r=t.segments)&&void 0!==r&&r.length&&t.segments.length>0&&i.append('noticeable-segments',t.segments.join(',')),null!=t&&t.segmentsOperator&&i.append('noticeable-segments-operator',t.segmentsOperator),i}}]),a}(J),$=function(e){s(n,e);var t=g(n);function n(){return r(this,n),t.call(this,'widget',(function(e){return'https://data.widgets.noticeable.io/widgets/'+e}))}return o(n)}(J);!function(e){e.IDENTITY_PUBLICATION_READ_INVALIDATE='identity:publication_read:invalidate',e.IDENTITY_PUBLICATION_SEEN_INVALIDATE='identity:publication_seen:invalidate',e.PROJECT_DATA_INVALIDATE='project_data:invalidate',e.PUBLICATION_DATA_INVALIDATE='publication_data:invalidate',e.WIDGET_DATA_INVALIDATE='widget_data:invalidate',e.WIDGET_CLOSE='widget:close',e.WIDGET_HIDE='widget:hide',e.WIDGET_OPEN='widget:open',e.WIDGET_REFRESH='widget:refresh',e.WIDGET_SHOW='widget:show',e.WIDGET_TOGGLE='widget:toggle'}(W||(W={})),function(e){e.WIDGET_PUBLICATION_READ='widget:publication:read',e.WIDGET_PUBLICATION_SEEN='widget:publication:seen',e.WIDGET_PUBLICATION_UNREAD_COUNT='widget:publication:unread_count',e.WIDGET_PUBLICATION_UNSEEN_COUNT='widget:publication:unseen_count'}(j||(j={})),function(e){e.WIDGET_CLOSED='widget:closed',e.WIDGET_HIDDEN='widget:hidden',e.WIDGET_OPENED='widget:opened',e.WIDGET_VISIBLE='widget:visible'}(M||(M={})),function(e){e.PREFERENCES='preferences',e.WIDGET_PUBLICATION_READ='widget:publication:read',e.WIDGET_PUBLICATION_SEEN='widget:publication:seen',e.WIDGET_TRIGGER_VIEW_SETTINGS='widget:trigger_view:settings',e.WIDGET_WIDGET_VIEW_SETTINGS='widget:widget_view:settings'}(B||(B={})),function(e){e.MONTH='month',e.YEAR='year'}(V||(V={}));class q{static getRegionIdentifier(e){if(!e)return q.DEFAULT_REGION_IDENTIFIER;let t=e.split('_');return 2===t.length?t.pop():(t=e.split('-'),2===t.length?t.pop():e.toUpperCase())}static getCurrencyAbbreviation(e){const t=q.LOCALE_CURRENCY_MAP[q.getRegionIdentifier(e).toUpperCase()];return!t||'GBP'!==t&&'EUR'!==t&&'USD'!==t?q.DEFAULT_CURRENCY_ABBREVIATION:t.toUpperCase()}static getPrimaryLocale(e){return e?e.split(',')[0]:q.DEFAULT_REGION_IDENTIFIER}static getCurrencySymbol(e){if(!e)return q.DEFAULT_CURRENCY_SYMBOL;switch(e.toUpperCase()){case'EUR':return'€';case'GBP':return'£';default:return q.DEFAULT_CURRENCY_SYMBOL}}}q.DEFAULT_CURRENCY_ABBREVIATION='USD',q.DEFAULT_CURRENCY_SYMBOL='$',q.DEFAULT_REGION_IDENTIFIER='US',q.LOCALE_CURRENCY_MAP={AD:'EUR',AE:'AED',AF:'AFN',AG:'XCD',AI:'XCD',AL:'ALL',AM:'AMD',AN:'ANG',AO:'AOA',AR:'ARS',AS:'USD',AT:'EUR',AU:'AUD',AW:'AWG',AX:'EUR',AZ:'AZN',BA:'BAM',BB:'BBD',BD:'BDT',BE:'EUR',BF:'XOF',BG:'BGN',BH:'BHD',BI:'BIF',BJ:'XOF',BL:'EUR',BM:'BMD',BN:'BND',BO:'BOB',BQ:'USD',BR:'BRL',BS:'BSD',BT:'BTN',BV:'NOK',BW:'BWP',BY:'BYR',BZ:'BZD',CA:'CAD',CC:'AUD',CD:'CDF',CF:'XAF',CG:'XAF',CH:'CHF',CI:'XOF',CK:'NZD',CL:'CLP',CM:'XAF',CN:'CNY',CO:'COP',CR:'CRC',CU:'CUP',CV:'CVE',CW:'ANG',CX:'AUD',CY:'EUR',CZ:'CZK',DE:'EUR',DJ:'DJF',DK:'DKK',DM:'XCD',DO:'DOP',DZ:'DZD',EC:'USD',EE:'EUR',EG:'EGP',EH:'MAD',ER:'ERN',ES:'EUR',ET:'ETB',FI:'EUR',FJ:'FJD',FK:'FKP',FM:'USD',FO:'DKK',FR:'EUR',GA:'XAF',GB:'GBP',GD:'XCD',GE:'GEL',GF:'EUR',GG:'GBP',GH:'GHS',GI:'GIP',GL:'DKK',GM:'GMD',GN:'GNF',GP:'EUR',GQ:'XAF',GR:'EUR',GS:'GBP',GT:'GTQ',GU:'USD',GW:'XOF',GY:'GYD',HK:'HKD',HM:'AUD',HN:'HNL',HR:'HRK',HT:'HTG',HU:'HUF',ID:'IDR',IE:'EUR',IL:'ILS',IM:'GBP',IN:'INR',IO:'USD',IQ:'IQD',IR:'IRR',IS:'ISK',IT:'EUR',JE:'GBP',JM:'JMD',JO:'JOD',JP:'JPY',KE:'KES',KG:'KGS',KH:'KHR',KI:'AUD',KM:'KMF',KN:'XCD',KP:'KPW',KR:'KRW',KW:'KWD',KY:'KYD',KZ:'KZT',LA:'LAK',LB:'LBP',LC:'XCD',LI:'CHF',LK:'LKR',LR:'LRD',LS:'LSL',LT:'EUR',LU:'EUR',LV:'EUR',LY:'LYD',MA:'MAD',MC:'EUR',MD:'MDL',ME:'EUR',MF:'EUR',MG:'MGA',MH:'USD',MK:'MKD',ML:'XOF',MM:'MMK',MN:'MNT',MO:'MOP',MP:'USD',MQ:'EUR',MR:'MRO',MS:'XCD',MT:'EUR',MU:'MUR',MV:'MVR',MW:'MWK',MX:'MXN',MY:'MYR',MZ:'MZN',NA:'NAD',NC:'XPF',NE:'XOF',NF:'AUD',NG:'NGN',NI:'NIO',NL:'EUR',NO:'NOK',NP:'NPR',NR:'AUD',NU:'NZD',NZ:'NZD',OM:'OMR',PA:'PAB',PE:'PEN',PF:'XPF',PG:'PGK',PH:'PHP',PK:'PKR',PL:'PLN',PM:'EUR',PN:'NZD',PR:'USD',PS:'ILS',PT:'EUR',PW:'USD',PY:'PYG',QA:'QAR',RE:'EUR',RO:'RON',RS:'RSD',RU:'RUB',RW:'RWF',SA:'SAR',SB:'SBD',SC:'SCR',SD:'SDG',SE:'SEK',SG:'SGD',SH:'SHP',SI:'EUR',SJ:'NOK',SK:'EUR',SL:'SLL',SM:'EUR',SN:'XOF',SO:'SOS',SR:'SRD',SS:'SSP',ST:'STD',SV:'SVC',SX:'ANG',SY:'SYP',SZ:'SZL',TC:'USD',TD:'XAF',TF:'EUR',TG:'XOF',TH:'THB',TJ:'TJS',TK:'NZD',TL:'USD',TM:'TMT',TN:'TND',TO:'TOP',TR:'TRY',TT:'TTD',TV:'AUD',TW:'TWD',TZ:'TZS',UA:'UAH',UG:'UGX',UM:'USD',US:'USD',UY:'UYU',UZ:'UZS',VA:'EUR',VC:'XCD',VE:'VEF',VG:'USD',VI:'USD',VN:'VND',VU:'VUV',WF:'XPF',WS:'WST',YE:'YER',YT:'EUR',ZA:'ZAR',ZM:'ZMW',ZW:'ZWL'};class Q{constructor(e,t,n){this.code=e,this.name=t,this.symbol=n}format(e,t){return new Intl.NumberFormat(t||'en-US',{style:'currency',currency:this.code,minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}}class ee{static from(e){return ee.values().find((t=>t.code===e.toUpperCase()))}static fromAcceptLanguage(e){return ee.fromLocale(q.getPrimaryLocale(e))}static fromLocale(e){return ee.from(q.getCurrencyAbbreviation(e))}static values(){return[ee.EURO,ee.POUND_STERLING,ee.UNITED_STATES_DOLLAR]}}ee.EURO=new class extends Q{constructor(){super('EUR','Euro','€')}},ee.POUND_STERLING=new class extends Q{constructor(){super('GBP','Pound Sterling','£')}},ee.UNITED_STATES_DOLLAR=new class extends Q{constructor(){super('USD','United States Dollar','$')}};class te{constructor(e){this.name=e}isSupportedBy(e){return e.includes(this)}}class ne{static from(e){for(const t in ne)if(t.toString()===e)return ne[t];return null}}ne.APPEARANCE_CUSTOMIZATION=new te('Appearance Customization'),ne.AUTO_REFRESH=new te('Auto-refresh'),ne.CODE_INJECTION=new te('Code Injection (CSS & JavaScript)'),ne.CROSS_DEVICE_SYNCHRONIZATION=new te('Cross-Device Synchronization'),ne.CUSTOM_DOMAINS=new te('Custom Domains with HTTPs'),ne.EMAIL_NOTIFICATIONS=new te('Email Notifications'),ne.EMAIL_REPORTS=new te('Email Reports'),ne.EMOJI_REACTIONS=new te('Emoji Reactions'),ne.EXPIRING_PUBLICATIONS=new te('Expiring Publications'),ne.GRAPHQL_API=new te('GraphQL API'),ne.IP_FILTERING=new te('IP Access Control'),ne.MODAL_WIDGET=new te('Modal Widget'),ne.NEWSPAGE_EMBED_WIDGET=new te('Newspage Embed Widget'),ne.PINNED_PUBLICATIONS=new te('Pinned Publications'),ne.POPUP_WIDGET=new te('Popup Widget'),ne.PRIVATE_LABELS=new te('Private Labels'),ne.PRIVATE_NEWSPAGES=new te('Private Newspages'),ne.PRIVATE_NEWSPAGES_TOKEN_AUTHENTICATION=new te('Proxy-based Authentication'),ne.PROJECT_ANALYTICS=new te('Project Analytics'),ne.PUBLICATION_ANALYTICS=new te('Publication Analytics'),ne.PUBLICATION_SCHEDULING=new te('Publication Scheduling'),ne.REDIRECTION_WIDGET=new te('Redirection Widget'),ne.SEGMENTATION=new te('Publication Segmentation'),ne.SSO_INTEGRATION=new te('Single Sign-On'),ne.TOP_BANNER_WIDGET=new te('Top Banner Widget'),ne.USER_FEEDBACK=new te('User Feedback'),ne.WEB_NOTIFICATIONS=new te('Web Notifications'),ne.WHITE_LABEL=new te('White Label'),ne.ZAPIER_INTEGRATION=new te('Zapier Integration');class re{constructor(e,t,n,r){if(!e||t||n||r){if(!e)throw Error('Name required!');if(!this.isValid(e))throw new Error('Invalid name: '+e);this.currency=n,this.cycle=r,this.name=e,this.version=t}else{const t=e.split('-');switch(t.length){case 1:this.currency=null,this.cycle=null,this.name=t[0],this.version=re.DEFAULT_VERSION;break;case 2:this.currency=null,this.cycle=null,this.name=t[1],this.version=re.parseVersion(t[0]);break;case 3:this.currency=re.parseCurrency(t[2]),this.cycle=null,this.name=t[1],this.version=re.parseVersion(t[0]);break;case 4:this.currency=re.parseCurrency(t[2]),this.cycle=re.parseCycle(t[3]),this.name=t[1],this.version=re.parseVersion(t[0]);break;default:throw new Error}if(!this.isValid(this.name))throw new Error('Invalid name: '+this.name)}}static parseCurrency(e){const t=ee.from(e);if(!t)throw new Error('Invalid currency: '+e);return t}static parseCycle(e){const t=class{static from(e){return'month'===e?V.MONTH:'year'===e?V.YEAR:null}}.from(e);if(!t)throw new Error('Invalid cycle: '+e);return t}static parseVersion(e){if(!e.startsWith('')||e.length<2)throw new Error('Invalid version: '+e);const t=e.substring(1),n=parseInt(t);if(isNaN(n))throw new Error('Invalid number: '+t);return n}equals(e){return this.name===e.name&&this.version===e.version&&this.currency===e.currency&&this.cycle===e.cycle}toString(){let e=`v${this.version}-${this.name}`;return this.currency&&(e+=`-${this.currency.code.toLowerCase()}`),this.cycle&&(e+=`-${this.cycle}`),e}}re.DEFAULT_VERSION=3;class ie{constructor(e){this.prices=e,this.pricesIndex=new Map,e.forEach((e=>{let t=this.pricesIndex.get(e.currency);t||(t=new Map,this.pricesIndex.set(e.currency,t)),t.set(e.cycle,e)}))}get(e,t){const n=this.pricesIndex.get(e);return n?n.get(t):null}get values(){return this.prices}}class oe{constructor(e,t,n){this.currency=e,this.cycle=t,this.value=n}}class ae extends re{isValid(e){return ce.values().map((e=>e.name)).some((t=>e===t))}}class se{constructor(e,t,n,r){this.name=e,this.prices=new ie(t),this.title=n,this.version=r}getId(e,t){return new ae(this.name,re.DEFAULT_VERSION,e,t)}isFree(){return this.prices.values.every((e=>0===e.value))}}class ce{static from(e){return ce.values().find((t=>t.name===e.name))}static values(){return[ce.EXTRA_ACTIVE_USERS,ce.EXTRA_COLLABORATOR,ce.EXTRA_PROJECT,ce.EXTRA_WIDGET]}}ce.EXTRA_ACTIVE_USERS=new se('extra_active_users',[new oe(ee.EURO,V.MONTH,20),new oe(ee.EURO,V.YEAR,200),new oe(ee.POUND_STERLING,V.MONTH,19),new oe(ee.POUND_STERLING,V.YEAR,190),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,23),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,230)],'Extra 1000 active users',3),ce.EXTRA_COLLABORATOR=new se('extra_collaborator',[new oe(ee.EURO,V.MONTH,4),new oe(ee.EURO,V.YEAR,40),new oe(ee.POUND_STERLING,V.MONTH,4),new oe(ee.POUND_STERLING,V.YEAR,40),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,5),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,50)],'Extra collaborator',3),ce.EXTRA_PROJECT=new se('extra_project',[new oe(ee.EURO,V.MONTH,26),new oe(ee.EURO,V.YEAR,260),new oe(ee.POUND_STERLING,V.MONTH,24),new oe(ee.POUND_STERLING,V.YEAR,240),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,29),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,290)],'Extra project',3),ce.EXTRA_WIDGET=new se('extra_widget',[new oe(ee.EURO,V.MONTH,9),new oe(ee.EURO,V.YEAR,99),new oe(ee.POUND_STERLING,V.MONTH,9),new oe(ee.POUND_STERLING,V.YEAR,99),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,9),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,99)],'Extra widget',3);class ue{constructor(e){this.name=e}}class le{constructor(e,t){this.name=e,this.value=t}}class de{constructor(...e){this.limits=new Map;for(const t of e)this.limits.set(t.name,t)}get(e){return this.limits.get(e)}}class he{static getLimits(e){const t=e.items.data;let n=0,r=0,i=0,o=0;for(const e of t)try{const t=ge.from(new fe(e.plan.id));n+=t.get(he.ORGANIZATION_ACTIVE_USERS).value,r+=t.get(he.ORGANIZATION_PROJECTS).value,i+=t.get(he.PROJECT_COLLABORATORS).value,o+=t.get(he.PROJECT_WIDGETS).value}catch(t){try{const t=ce.from(new ae(e.plan.id));t===ce.EXTRA_ACTIVE_USERS&&(n+=1e3*e.quantity),t===ce.EXTRA_COLLABORATOR&&(i+=e.quantity),t===ce.EXTRA_PROJECT&&(r+=e.quantity),t===ce.EXTRA_WIDGET&&(o+=e.quantity)}catch(e){}}return new de(new le(he.ORGANIZATION_PROJECTS,r),new le(he.ORGANIZATION_ACTIVE_USERS,n),new le(he.PROJECT_COLLABORATORS,i),new le(he.PROJECT_WIDGETS,o))}}he.ORGANIZATION_PROJECTS=new ue('projects'),he.ORGANIZATION_ACTIVE_USERS=new ue('activeUsers'),he.PROJECT_COLLABORATORS=new ue('collaborators'),he.PROJECT_WIDGETS=new ue('widgets');class pe extends se{constructor(e,t,n,r,i,o,a,s,c,u){super(t,a,e,u),this.description=n,this.features=new Set,r.forEach((e=>{this.features.add(e)})),this.hidden=s,this.quicklist=i,this.quotaLimits=new Map,o.forEach((e=>{this.quotaLimits.set(e.name,e)})),this.trialPeriodDays=c}get(e){return this.quotaLimits.get(e)}getId(e,t){return new fe(this.name,re.DEFAULT_VERSION,e,t)}includes(e){let t;return t='string'==typeof e?ne.from(e):e,this.features.has(t)}}class fe extends re{isValid(e){return ge.values().some((t=>t.name===e))}}class ge{static default(){return ge.FREE}static from(e,t=ge.FREE){if(!e)return t;const n='string'==typeof e?new fe(e):e,r=ge.values().find((e=>e.name===n.name));return r||t}static include(e,t=!1){return ge.values().filter((n=>n.hidden===t&&n.includes(e))).sort(((e,t)=>e.prices.get(ee.UNITED_STATES_DOLLAR,V.MONTH).value-t.prices.get(ee.UNITED_STATES_DOLLAR,V.MONTH).value))}static values(){return ge.PLANS}}ge.ACADEMIC=new class extends pe{constructor(){super('Academic','academic','Ideal for Academic organizations',[ne.APPEARANCE_CUSTOMIZATION,ne.CUSTOM_DOMAINS,ne.EMOJI_REACTIONS,ne.MODAL_WIDGET,ne.NEWSPAGE_EMBED_WIDGET,ne.POPUP_WIDGET,ne.PROJECT_ANALYTICS,ne.PUBLICATION_ANALYTICS,ne.PUBLICATION_SCHEDULING,ne.ZAPIER_INTEGRATION],['Publication analytics','Publication scheduling','Emoji reactions','Custom domain with HTTPS','Noticeable watermark','Zapier integrations','Lovely support'],[new le(he.ORGANIZATION_ACTIVE_USERS,2e3),new le(he.ORGANIZATION_PROJECTS,1),new le(he.PROJECT_COLLABORATORS,2),new le(he.PROJECT_WIDGETS,2)],[new oe(ee.EURO,V.MONTH,0),new oe(ee.EURO,V.YEAR,0),new oe(ee.POUND_STERLING,V.MONTH,0),new oe(ee.POUND_STERLING,V.YEAR,0),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,0),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,0)],!0,0,3)}},ge.BUSINESS=new class extends pe{constructor(){super('Business','business','Ideal for companies requiring a full-featured solution',[ne.APPEARANCE_CUSTOMIZATION,ne.AUTO_REFRESH,ne.CODE_INJECTION,ne.CROSS_DEVICE_SYNCHRONIZATION,ne.CUSTOM_DOMAINS,ne.EMAIL_NOTIFICATIONS,ne.EMAIL_REPORTS,ne.EMOJI_REACTIONS,ne.EXPIRING_PUBLICATIONS,ne.GRAPHQL_API,ne.MODAL_WIDGET,ne.NEWSPAGE_EMBED_WIDGET,ne.PINNED_PUBLICATIONS,ne.POPUP_WIDGET,ne.PRIVATE_LABELS,ne.PRIVATE_NEWSPAGES,ne.PROJECT_ANALYTICS,ne.PUBLICATION_ANALYTICS,ne.PUBLICATION_SCHEDULING,ne.REDIRECTION_WIDGET,ne.SEGMENTATION,ne.TOP_BANNER_WIDGET,ne.USER_FEEDBACK,ne.WEB_NOTIFICATIONS,ne.WHITE_LABEL,ne.ZAPIER_INTEGRATION],['<strong>3</strong> projects','<strong>5</strong> collaborators','Auto-refresh (Newspage and Widgets)','Code injection (CSS & JavaScript)','Private labels','Cross-Device Synchronization','Private Newspages','Segmentation','User feedback','Priority support'],[new le(he.ORGANIZATION_ACTIVE_USERS,1e4),new le(he.ORGANIZATION_PROJECTS,3),new le(he.PROJECT_COLLABORATORS,5),new le(he.PROJECT_WIDGETS,3)],[new oe(ee.EURO,V.MONTH,99),new oe(ee.EURO,V.YEAR,999),new oe(ee.POUND_STERLING,V.MONTH,99),new oe(ee.POUND_STERLING,V.YEAR,999),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,99),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,999)],!1,14,3)}},ge.ENTERPRISE=new class extends pe{constructor(){super('Enterprise','enterprise','Ideal for companies with custom needs',[ne.APPEARANCE_CUSTOMIZATION,ne.AUTO_REFRESH,ne.CODE_INJECTION,ne.CROSS_DEVICE_SYNCHRONIZATION,ne.CUSTOM_DOMAINS,ne.EMAIL_NOTIFICATIONS,ne.EMAIL_REPORTS,ne.EMOJI_REACTIONS,ne.EXPIRING_PUBLICATIONS,ne.GRAPHQL_API,ne.IP_FILTERING,ne.MODAL_WIDGET,ne.NEWSPAGE_EMBED_WIDGET,ne.PINNED_PUBLICATIONS,ne.POPUP_WIDGET,ne.PRIVATE_LABELS,ne.PRIVATE_NEWSPAGES,ne.PRIVATE_NEWSPAGES_TOKEN_AUTHENTICATION,ne.PROJECT_ANALYTICS,ne.PUBLICATION_ANALYTICS,ne.PUBLICATION_SCHEDULING,ne.REDIRECTION_WIDGET,ne.SEGMENTATION,ne.SSO_INTEGRATION,ne.TOP_BANNER_WIDGET,ne.USER_FEEDBACK,ne.WEB_NOTIFICATIONS,ne.WHITE_LABEL,ne.ZAPIER_INTEGRATION],['Custom number of projects','Unlimited collaborators','Unlimited publications','Single Sign-On (OIDC or SAML)','Bank transfers: Alipay, SEPA, Sofort, etc.','Personal executive','Assisted installation','Advanced support'],[new le(he.ORGANIZATION_ACTIVE_USERS,2e4),new le(he.ORGANIZATION_PROJECTS,5),new le(he.PROJECT_COLLABORATORS,-1),new le(he.PROJECT_WIDGETS,5)],[new oe(ee.EURO,V.MONTH,399),new oe(ee.EURO,V.YEAR,3999),new oe(ee.POUND_STERLING,V.MONTH,399),new oe(ee.POUND_STERLING,V.YEAR,3999),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,399),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,3999)],!1,14,3)}},ge.FREE=new class extends pe{constructor(){super('Free','free','Ideal for getting started',[ne.MODAL_WIDGET,ne.NEWSPAGE_EMBED_WIDGET,ne.POPUP_WIDGET],['<strong>1</strong> project','Unlimited views','Beautiful widgets','Public newspage','Custom labels','Noticeable watermark'],[new le(he.ORGANIZATION_ACTIVE_USERS,1e3),new le(he.ORGANIZATION_PROJECTS,1),new le(he.PROJECT_COLLABORATORS,1),new le(he.PROJECT_WIDGETS,1)],[new oe(ee.EURO,V.MONTH,0),new oe(ee.EURO,V.YEAR,0),new oe(ee.POUND_STERLING,V.MONTH,0),new oe(ee.POUND_STERLING,V.YEAR,0),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,0),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,0)],!1,0,3)}},ge.GROWTH=new class extends pe{constructor(){super('Growth','growth','Ideal for growing brands',[ne.APPEARANCE_CUSTOMIZATION,ne.CUSTOM_DOMAINS,ne.EMAIL_NOTIFICATIONS,ne.EMAIL_REPORTS,ne.EMOJI_REACTIONS,ne.EXPIRING_PUBLICATIONS,ne.GRAPHQL_API,ne.MODAL_WIDGET,ne.NEWSPAGE_EMBED_WIDGET,ne.PINNED_PUBLICATIONS,ne.POPUP_WIDGET,ne.PROJECT_ANALYTICS,ne.PUBLICATION_ANALYTICS,ne.PUBLICATION_SCHEDULING,ne.REDIRECTION_WIDGET,ne.TOP_BANNER_WIDGET,ne.WHITE_LABEL,ne.ZAPIER_INTEGRATION],['<strong>2</strong> projects','<strong>3</strong> collaborators','Expiring publications','GraphQL API','Pinned publications','Publication analytics','Emoji reactions','Priority support'],[new le(he.ORGANIZATION_ACTIVE_USERS,5e3),new le(he.ORGANIZATION_PROJECTS,2),new le(he.PROJECT_COLLABORATORS,3),new le(he.PROJECT_WIDGETS,2)],[new oe(ee.EURO,V.MONTH,49),new oe(ee.EURO,V.YEAR,499),new oe(ee.POUND_STERLING,V.MONTH,49),new oe(ee.POUND_STERLING,V.YEAR,499),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,49),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,499)],!1,14,3)}},ge.OPENSOURCE=new class extends pe{constructor(){super('Open Source','opensource','Ideal for Open Source organizations',[ne.APPEARANCE_CUSTOMIZATION,ne.CUSTOM_DOMAINS,ne.EMOJI_REACTIONS,ne.MODAL_WIDGET,ne.NEWSPAGE_EMBED_WIDGET,ne.POPUP_WIDGET,ne.PROJECT_ANALYTICS,ne.PUBLICATION_ANALYTICS,ne.PUBLICATION_SCHEDULING,ne.ZAPIER_INTEGRATION],['Publication analytics','Publication scheduling','Emoji reactions','Custom domain with HTTPS','Noticeable watermark','Zapier integrations','Lovely support'],[new le(he.ORGANIZATION_ACTIVE_USERS,2e3),new le(he.ORGANIZATION_PROJECTS,1),new le(he.PROJECT_COLLABORATORS,2),new le(he.PROJECT_WIDGETS,2)],[new oe(ee.EURO,V.MONTH,0),new oe(ee.EURO,V.YEAR,0),new oe(ee.POUND_STERLING,V.MONTH,0),new oe(ee.POUND_STERLING,V.YEAR,0),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,0),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,0)],!0,0,3)}},ge.STARTER=new class extends pe{constructor(){super('Starter','starter','Ideal for individuals',[ne.APPEARANCE_CUSTOMIZATION,ne.CUSTOM_DOMAINS,ne.EMAIL_NOTIFICATIONS,ne.EMAIL_REPORTS,ne.MODAL_WIDGET,ne.NEWSPAGE_EMBED_WIDGET,ne.POPUP_WIDGET,ne.PROJECT_ANALYTICS,ne.PUBLICATION_SCHEDULING,ne.REDIRECTION_WIDGET,ne.TOP_BANNER_WIDGET,ne.WHITE_LABEL,ne.ZAPIER_INTEGRATION],['<strong>1</strong> project','Appearance customization','Custom domain with HTTPS','Noticeable branding removal','Project analytics','Publication scheduling','Zapier integrations','Support'],[new le(he.ORGANIZATION_ACTIVE_USERS,2e3),new le(he.ORGANIZATION_PROJECTS,1),new le(he.PROJECT_COLLABORATORS,1),new le(he.PROJECT_WIDGETS,1)],[new oe(ee.EURO,V.MONTH,19),new oe(ee.EURO,V.YEAR,199),new oe(ee.POUND_STERLING,V.MONTH,19),new oe(ee.POUND_STERLING,V.YEAR,199),new oe(ee.UNITED_STATES_DOLLAR,V.MONTH,19),new oe(ee.UNITED_STATES_DOLLAR,V.YEAR,199)],!1,14,3)}},ge.PLANS=[ge.ACADEMIC,ge.BUSINESS,ge.ENTERPRISE,ge.FREE,ge.GROWTH,ge.OPENSOURCE,ge.STARTER];var _e=function(e){s(n,e);var t=g(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return r(this,n),a(p(e=t.call(this)),'capacity',void 0),e.capacity=i,e}return o(n,[{key:'add',value:function(e){return 0===this.capacity||v(c(n.prototype),'has',this).call(this,e)?this:(v(c(n.prototype),'size',this)<this.capacity||v(c(n.prototype),'delete',this).call(this,this.values().next().value),v(c(n.prototype),'add',this).call(this,e))}},{key:'addAll',value:function(e){if(0===this.capacity)return this;var t,r=w(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;v(c(n.prototype),'add',this).call(this,i)}}catch(e){r.e(e)}finally{r.f()}for(var o=this.values();v(c(n.prototype),'size',this)>this.capacity;)v(c(n.prototype),'delete',this).call(this,o.next().value);return this}},{key:'toArray',value:function(){return Array.from(this)}}]),n}(h(Set)),ve=function(e){s(n,e);var t=g(n);function n(e){var i;return r(this,n),i=t.call(this,99),e&&e.length>0&&i.addAll(e),i}return o(n)}(_e),me={},ye={},Ee={};Object.defineProperty(Ee,'__esModule',{value:!0}),Ee.formatCookie=void 0;var be=function(e){var t=e.path,n=e.domain,r=e.expires,i=e.secure,o=function(e){var t=e.sameSite;return void 0===t?null:['none','lax','strict'].indexOf(t.toLowerCase())>=0?t:null}(e);return[null==t?'':';path='+t,null==n?'':';domain='+n,null==r?'':';expires='+r.toUTCString(),void 0===i||!1===i?'':';secure',null===o?'':';SameSite='+o].join('')};Ee.formatCookie=function(e,t,n){return[encodeURIComponent(e),'=',encodeURIComponent(t),be(n)].join('')};var we={};function Ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if('undefined'==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if('string'==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);'Object'===n&&e.constructor&&(n=e.constructor.name);if('Map'===n||'Set'===n)return Array.from(e);if('Arguments'===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e,t)||function(){throw new TypeError('Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.')}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(we,'__esModule',{value:!0}),we.parseCookies=void 0;function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,'value'in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}we.parseCookies=function(e){if(0===e.length)return{};var t={},n=new RegExp('\\s*;\\s*');return e.split(n).forEach((function(e){var n=Ie(e.split('='),2),r=n[0],i=n[1],o=decodeURIComponent(r),a=decodeURIComponent(i);t[o]=a})),t},Object.defineProperty(ye,'__esModule',{value:!0}),ye.CookieStorage=void 0;var Oe=Ee,Se=we,Ae=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}(this,e),this._defaultOptions=Object.assign({domain:null,expires:null,path:null,secure:!1},t),'undefined'!=typeof Proxy)return new Proxy(this,Ne)}var t,n,r;return t=e,(n=[{key:'clear',value:function(){var e=this,t=Se.parseCookies(this._getCookie());Object.keys(t).forEach((function(t){return e.removeItem(t)}))}},{key:'getItem',value:function(e){var t=Se.parseCookies(this._getCookie());return Object.prototype.hasOwnProperty.call(t,e)?t[e]:null}},{key:'key',value:function(e){var t=Se.parseCookies(this._getCookie()),n=Object.keys(t).sort();return e<n.length?n[e]:null}},{key:'removeItem',value:function(e,t){var n=Object.assign(Object.assign(Object.assign({},this._defaultOptions),t),{expires:new Date(0)}),r=Oe.formatCookie(e,'',n);this._setCookie(r)}},{key:'setItem',value:function(e,t,n){var r=Object.assign(Object.assign({},this._defaultOptions),n),i=Oe.formatCookie(e,t,r);this._setCookie(i)}},{key:'_getCookie',value:function(){return'undefined'==typeof document||void 0===document.cookie?'':document.cookie}},{key:'_setCookie',value:function(e){document.cookie=e}},{key:'length',get:function(){var e=Se.parseCookies(this._getCookie());return Object.keys(e).length}}])&&Te(t.prototype,n),r&&Te(t,r),e}();ye.CookieStorage=Ae;var Ne={defineProperty:function(e,t,n){return e.setItem(t.toString(),String(n.value)),!0},deleteProperty:function(e,t){return e.removeItem(t.toString()),!0},get:function(e,t,n){if('string'==typeof t&&t in e)return e[t];var r=e.getItem(t.toString());return null!==r?r:void 0},getOwnPropertyDescriptor:function(e,t){if(!(t in e))return{configurable:!0,enumerable:!0,value:e.getItem(t.toString()),writable:!0}},has:function(e,t){return'string'==typeof t&&t in e||null!==e.getItem(t.toString())},ownKeys:function(e){for(var t=[],n=0;n<e.length;n++){var r=e.key(n);null!==r&&t.push(r)}return t},preventExtensions:function(e){throw new TypeError('can\'t prevent extensions on this proxy object')},set:function(e,t,n,r){return e.setItem(t.toString(),String(n)),!0}};!function(e){Object.defineProperty(e,'__esModule',{value:!0});var t=ye;Object.defineProperty(e,'CookieStorage',{enumerable:!0,get:function(){return t.CookieStorage}});var n=Ee;Object.defineProperty(e,'formatCookie',{enumerable:!0,get:function(){return n.formatCookie}});var r=we;Object.defineProperty(e,'parseCookies',{enumerable:!0,get:function(){return r.parseCookies}})}(me);var Ce={},ke=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,'value'in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var De=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}(this,e),this._keys=[],this._memory={}}return ke(e,[{key:'clear',value:function(){this._memory={},this._keys=[]}},{key:'getItem',value:function(e){return this._memory.hasOwnProperty(e)?this._memory[e]:null}},{key:'key',value:function(e){var t=this._keys[e];return void 0===t?null:t}},{key:'removeItem',value:function(e){delete this._memory[e];var t=this._keys.indexOf(e);t<0||this._keys.splice(t,1)}},{key:'setItem',value:function(e,t){this._memory[e]=t,this._keys.indexOf(e)<0&&this._keys.push(e)}},{key:'length',get:function(){return this._keys.length}}]),e}();Ce.SimpleMemoryStorage=De;var Pe,xe=Ce.SimpleMemoryStorage,Le=o((function e(t,n){r(this,e),a(this,'lastPublicationRead',void 0),a(this,'lastPublicationSeen',void 0),this.lastPublicationRead=t,this.lastPublicationSeen=n})),Ue=function(){function e(){r(this,e)}return o(e,null,[{key:'_hasStorage',value:function(e){try{var t=window[e],n='__noticeable_storage_test';t.setItem(n,'1');var r=t.getItem(n);return t.removeItem(n),'1'===r}catch(e){return!1}}},{key:'_storage',value:function(){return window.noticeable._preferences.firstPartyCookies.localStorage?e._hasStorage('localStorage')?window.localStorage:e._hasStorage('sessionStorage')?window.sessionStorage:new xe:new me.CookieStorage({expires:new Date(Date.now()+window.noticeable._preferences.firstPartyCookies.retentionPeriod),sameSite:'Lax'})}},{key:'deleteUserId',value:function(t){e.COOKIE_STORAGE.removeItem('noticeable_uid_'+t)}},{key:'deleteAllUserTraits',value:function(){for(var e in sessionStorage){var t=e.split('_');3===t.length&&'noticeable'===t[0]&&'traits'===t[1]&&sessionStorage.removeItem(e)}}},{key:'deletePublicationReadSeen',value:function(t){var n=e._storage();for(var r in n)(t||!r.startsWith('noticeable_lpr_')&&!r.startsWith('noticeable_lps_'))&&(!t||r!=='noticeable_lpr_'.concat(t)&&r!=='noticeable_lps_'.concat(t))||n.removeItem(r)}},{key:'deleteUserTraits',value:function(e){sessionStorage.removeItem('noticeable_traits_'+e)}},{key:'deleteVisitorId',value:function(t){e.COOKIE_STORAGE.removeItem('noticeable_vid_'+t)}},{key:'getProjectStates',value:function(){var t=new Map,n=e._storage();for(var r in n){var i=r.split('_'),o=void 0;if(3===i.length&&'noticeable'===i[0])if('lpr'===i[1]){o=i[2];var a=e.getOrCreateProjectState(t,o),s=n.getItem(r);s&&(a.lastPublicationRead=new ve(JSON.parse(s)))}else if('lps'===i[1]){o=i[2];var c=e.getOrCreateProjectState(t,o),u=n.getItem(r);u&&(c.lastPublicationSeen=new ve(JSON.parse(u)))}}return t}},{key:'getOrCreateProjectState',value:function(e,t){var n=e.get(t);return n||(n=new Le(new ve,new ve),e.set(t,n)),n}},{key:'getPublicationRead',value:function(t){var n=e._storage().getItem('noticeable_lpr_'.concat(t));return n?new ve(JSON.parse(n)):new Set}},{key:'getPublicationSeen',value:function(t){var n=e._storage().getItem('noticeable_lps_'.concat(t));return n?new ve(JSON.parse(n)):new Set}},{key:'getUserId',value:function(t){return e.COOKIE_STORAGE.getItem('noticeable_uid_'+t)}},{key:'getUserIds',value:function(){return this._getIdCookieValueByProject('noticeable_uid')}},{key:'getAllUserTraits',value:function(){var e=new Map;for(var t in sessionStorage){var n=t.split('_');if(3===n.length&&'noticeable'===n[0]&&'traits'===n[1]){var r=sessionStorage.getItem(t);r&&e.set(n[2],JSON.parse(r))}}return e}},{key:'getUserTraits',value:function(e){var t=sessionStorage.getItem('noticeable_traits_'+e);return t?JSON.parse(t):{}}},{key:'getVisitorId',value:function(t){return e.COOKIE_STORAGE.getItem('noticeable_vid_'+t)}},{key:'getVisitorIds',value:function(){return this._getIdCookieValueByProject('noticeable_vid')}},{key:'_getIdCookieValueByProject',value:function(t){var n=e.COOKIE_STORAGE,r=new Map;for(var i in n)if(i.startsWith(t)){var o=i.split('_');3===o.length&&r.set(o[2],n[i])}return r}},{key:'reset',value:function(t){if(this.deletePublicationReadSeen(t),t)this.deleteUserId(t),this.deleteUserTraits(t),this.deleteVisitorId(t);else{for(var n in e.COOKIE_STORAGE)(n.startsWith('noticeable_vid_')||n.startsWith('noticeable_uid_'))&&e.COOKIE_STORAGE.removeItem(n);this.deleteAllUserTraits()}}},{key:'setPublicationSeen',value:function(t,n){e._storage().setItem('noticeable_lps_'.concat(t),JSON.stringify(n.toArray()))}},{key:'setPublicationRead',value:function(t,n){e._storage().setItem('noticeable_lpr_'.concat(t),JSON.stringify(n.toArray()))}},{key:'setUserId',value:function(t,n){e.COOKIE_STORAGE.setItem('noticeable_uid_'+t,n,{expires:new Date(Date.now()+window.noticeable._preferences.firstPartyCookies.retentionPeriod),sameSite:'None',secure:!0})}},{key:'setUserTraits',value:function(e,t){t&&0!==Object.keys(t).length?sessionStorage.setItem('noticeable_traits_'+e,JSON.stringify(t)):sessionStorage.removeItem('noticeable_traits_'+e)}},{key:'setVisitorId',value:function(t,n){e.COOKIE_STORAGE.setItem('noticeable_vid_'+t,n,{expires:new Date(Date.now()+window.noticeable._preferences.firstPartyCookies.retentionPeriod),sameSite:'None',secure:!0})}}]),e}();a(Ue,'COOKIE_STORAGE',new me.CookieStorage);var Ge=new Uint8Array(16);function We(){if(!Pe&&!(Pe='undefined'!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||'undefined'!=typeof msCrypto&&'function'==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');return Pe(Ge)}var je=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Me(e){return'string'==typeof e&&je.test(e)}for(var Be=[],Ve=0;Ve<256;++Ve)Be.push((Ve+256).toString(16).substr(1));function He(e,t,n){var r=(e=e||{}).random||(e.rng||We)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Be[e[t+0]]+Be[e[t+1]]+Be[e[t+2]]+Be[e[t+3]]+'-'+Be[e[t+4]]+Be[e[t+5]]+'-'+Be[e[t+6]]+Be[e[t+7]]+'-'+Be[e[t+8]]+Be[e[t+9]]+'-'+Be[e[t+10]]+Be[e[t+11]]+Be[e[t+12]]+Be[e[t+13]]+Be[e[t+14]]+Be[e[t+15]]).toLowerCase();if(!Me(n))throw TypeError('Stringified UUID is invalid');return n}(r)}var Fe,ze,Ye,Ke,Je,Ze,Xe=function(){function e(t,n){r(this,e),a(this,'_dataRepository',void 0),a(this,'_lastPublicationRead',void 0),a(this,'_lastPublicationSeen',void 0),a(this,'_pendingIdentityUpdates',void 0),a(this,'_preferences',void 0),a(this,'_userIds',void 0),a(this,'_userTraits',void 0),a(this,'_visitorIds',void 0),this._dataRepository=t,this._lastPublicationRead=new Map,this._lastPublicationSeen=new Map,this._pendingIdentityUpdates=new Map,this._preferences=n,this._userIds=new Map,this._userTraits=new Map,this._visitorIds=new Map}var t,i,s,c,u,l,d,h;return o(e,[{key:'initialize',value:function(){var e,t=w(Ue.getUserIds());try{for(t.s();!(e=t.n()).done;){var n=m(e.value,2),r=n[0],i=n[1];this._userIds.set(r,i)}}catch(e){t.e(e)}finally{t.f()}var o,a=w(Ue.getAllUserTraits());try{for(a.s();!(o=a.n()).done;){var s=m(o.value,2),c=s[0],u=s[1];this._userTraits.set(c,u)}}catch(e){a.e(e)}finally{a.f()}var l,d=w(Ue.getVisitorIds());try{for(d.s();!(l=d.n()).done;){var h=m(l.value,2),p=h[0],f=h[1];this._visitorIds.set(p,f)}}catch(e){d.e(e)}finally{d.f()}var g,_=w(Ue.getProjectStates().entries());try{for(_.s();!(g=_.n()).done;){var v=m(g.value,2),y=v[0],E=v[1];this._lastPublicationRead.set(y,E.lastPublicationRead),this._lastPublicationSeen.set(y,E.lastPublicationSeen)}}catch(e){_.e(e)}finally{_.f()}}},{key:'clearLastPublicationRead',value:function(){this._lastPublicationRead.clear()}},{key:'clearLastPublicationSeen',value:function(){this._lastPublicationSeen.clear()}},{key:'createOrExtendVisitorId',value:function(e){var t=this._visitorIds.get(e);if(t)Ue.setVisitorId(e,t);else{var n=He();this._visitorIds.set(e,n),Ue.setVisitorId(e,n)}}},{key:'setLastPublicationRead',value:(h=n(regeneratorRuntime.mark((function e(t,n,r){var i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null!==(i=this._lastPublicationRead.get(t))&&void 0!==i?i:new ve,r.merge||o.clear(),o.addAll(n),this._lastPublicationRead.set(t,o),Ue.setPublicationRead(t,o),!(o.size>0)){e.next=8;break}return e.next=8,this._remoteStateUpdate(t,n,null,!r.merge,!1);case 8:return e.abrupt('return',o);case 9:case'end':return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:'setLastPublicationSeen',value:(d=n(regeneratorRuntime.mark((function e(t,n,r){var i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null!==(i=this._lastPublicationSeen.get(t))&&void 0!==i?i:new ve,r.merge||o.clear(),o.addAll(n),this._lastPublicationSeen.set(t,o),Ue.setPublicationSeen(t,o),!(o.size>0)){e.next=8;break}return e.next=8,this._remoteStateUpdate(t,null,n,!1,!r.merge);case 8:return e.abrupt('return',o);case 9:case'end':return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:'remoteIdentityUpdate',value:(l=n(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.createOrExtendVisitorId(t),e.next=3,this._isCrossDeviceSynchronizationEnabled(t);case 3:if(e.sent){e.next=5;break}return e.abrupt('return');case 5:return A.debug('Calling identify for project '.concat(t)),e.prev=6,(n=this._userTraits.get(t))&&delete n.id,e.next=11,fetch('https://pipeline.noticeable.io/i',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({p:t,t:n,u:this._userIds.get(t),v:this._visitorIds.get(t)})});case 11:return r=e.sent,e.next=14,r.json();case 14:return i=e.sent,e.next=17,this.setLastPublicationReadSeen(t,new ve(i.lastPublicationRead),new ve(i.lastPublicationSeen),!0,!0,!1);case 17:i.userId&&(this._userIds.set(t,i.userId),Ue.setUserId(t,i.userId)),this._userTraits.set(t,i.traits),i.visitorId&&(this._visitorIds.set(t,i.visitorId),Ue.setVisitorId(t,i.visitorId)),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(6),A.error('Error while calling identify endpoint',e.t0);case 25:case'end':return e.stop()}}),e,this,[[6,22]])}))),function(e){return l.apply(this,arguments)})},{key:'getLastPublicationRead',value:function(e){var t;return null!==(t=this._lastPublicationRead.get(e))&&void 0!==t?t:new ve}},{key:'getLastPublicationSeen',value:function(e){var t;return null!==(t=this._lastPublicationSeen.get(e))&&void 0!==t?t:new ve}},{key:'getPendingIdentityUpdate',value:function(e){return this._pendingIdentityUpdates.get(e)}},{key:'getUserId',value:function(e){return this._userIds.get(e)}},{key:'getUserTraits',value:function(e){return this._userTraits.get(e)}},{key:'getVisitorId',value:function(e){return this._visitorIds.get(e)}},{key:'isRead',value:function(e,t){var n=this._lastPublicationRead.get(e);return!!n&&n.has(t)}},{key:'isSeen',value:function(e,t){var n=this._lastPublicationSeen.get(e);return!!n&&n.has(t)}},{key:'reset',value:function(e){if(Ue.reset(e),e)this._lastPublicationRead.delete(e),this._lastPublicationSeen.delete(e),this._userIds.delete(e),this._userTraits.delete(e),this._visitorIds.delete(e),this.createOrExtendVisitorId(e);else{var t=new Set(this._visitorIds.keys());this._lastPublicationRead.clear(),this._lastPublicationSeen.clear(),this._userIds.clear(),this._userTraits.clear(),this._visitorIds.clear();var n,r=w(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.createOrExtendVisitorId(i)}}catch(e){r.e(e)}finally{r.f()}}}},{key:'setLastPublicationReadSeen',value:(u=n(regeneratorRuntime.mark((function e(t,n,r,i,o){var a,s,c,u,l,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(d.length>5&&void 0!==d[5])||d[5],n&&(i?(this._lastPublicationRead.set(t,n),Ue.setPublicationRead(t,n)):((c=null!==(s=this._lastPublicationRead.get(t))&&void 0!==s?s:new ve).addAll(n.toArray()),this._lastPublicationRead.set(t,c),Ue.setPublicationRead(t,c))),r&&(o?(this._lastPublicationSeen.set(t,r),Ue.setPublicationSeen(t,r)):((l=null!==(u=this._lastPublicationSeen.get(t))&&void 0!==u?u:new ve).addAll(r.toArray()),this._lastPublicationSeen.set(t,l),Ue.setPublicationSeen(t,l))),!a){e.next=5;break}return e.abrupt('return',this._remoteStateUpdate(t,n.toArray(),r.toArray(),i,o));case 5:case'end':return e.stop()}}),e,this)}))),function(e,t,n,r,i){return u.apply(this,arguments)})},{key:'update',value:(c=n(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._pendingIdentityUpdates.has(t)){e.next=3;break}return A.warn('Skipping identify(\''.concat(t,'\', ').concat(JSON.stringify(n),') since another call is already in progress. Make sure you do not call \'identify\' multiple times consecutively.')),e.abrupt('return');case 3:return r=this._update(t,n),this._pendingIdentityUpdates.set(t,r),e.abrupt('return',r);case 6:case'end':return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:'_update',value:(s=n(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.createOrExtendVisitorId(t),n.id&&(this._userIds.set(t,n.id),Ue.setUserId(t,n.id)),this._userTraits.set(t,n),Ue.setUserTraits(t,n),e.next=6,this.remoteIdentityUpdate(t);case 6:this._pendingIdentityUpdates.delete(t);case 7:case'end':return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:'_isCrossDeviceSynchronizationEnabled',value:(i=n(regeneratorRuntime.mark((function e(t){var n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dataRepository.getProjectData(t);case 2:if(i=e.sent,'disabled'!==(o=null==i||null===(n=i.features)||void 0===n?void 0:n.crossDeviceSynchronization)){e.next=6;break}return e.abrupt('return',!1);case 6:if(ge.from(null!==(r=null==i?void 0:i.planId)&&void 0!==r?r:'').includes(ne.CROSS_DEVICE_SYNCHRONIZATION)){e.next=9;break}return A.warn('Skipping cross-device synchronization. You need to upgrade to the '.concat(ge.include(ne.CROSS_DEVICE_SYNCHRONIZATION)[0].title,' plan or higher to get this feature')),e.abrupt('return',!1);case 9:if('disabled'===o||this._userIds.get(t)){e.next=12;break}return A.debug('Skipping cross-device synchronization because no user ID is defined'),e.abrupt('return',!1);case 12:if(!1!==this._preferences.crossDeviceSynchronization){e.next=15;break}return A.debug('Cross-device synchronization disabled at preferences level'),e.abrupt('return',!1);case 15:return e.abrupt('return',!0);case 16:case'end':return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:'_remoteStateUpdate',value:(t=n(regeneratorRuntime.mark((function e(t,n,r,i,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._isCrossDeviceSynchronizationEnabled(t);case 2:if(e.sent){e.next=4;break}return e.abrupt('return');case 4:A.debug('Calling _remoteStateUpdate for project '.concat(t));try{fetch('https://pipeline.noticeable.io/s',{method:'PUT',headers:{'content-type':'application/json'},body:JSON.stringify({lpr:n||null,lps:r||null,olpr:i,olps:o,p:t,u:this._userIds.get(t),v:this._visitorIds.get(t)})})}catch(e){A.error('Error while calling identify endpoint',e)}case 6:case'end':return e.stop()}}),e,this)}))),function(e,n,r,i,o){return t.apply(this,arguments)})}]),e}();!function(e){e.WIDGET='widget'}(Fe||(Fe={})),function(e){e.Call='call',e.Reply='reply',e.Syn='syn',e.SynAck='synAck',e.Ack='ack'}(ze||(ze={})),function(e){e.Fulfilled='fulfilled',e.Rejected='rejected'}(Ye||(Ye={})),function(e){e.ConnectionDestroyed='ConnectionDestroyed',e.ConnectionTimeout='ConnectionTimeout',e.NoIframeSrc='NoIframeSrc'}(Ke||(Ke={})),function(e){e.DataCloneError='DataCloneError'}(Je||(Je={})),function(e){e.Message='message'}(Ze||(Ze={}));const $e={'http:':'80','https:':'443'},qe=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,Qe=['file:','data:'];const et=({name:e,message:t,stack:n})=>({name:e,message:t,stack:n});let tt=0;var nt=()=>++tt;const rt=e=>e?e.split('.'):[],it=(e,t,n)=>{const r=rt(t);return r.reduce(((e,t,i)=>(void 0===e[t]&&(e[t]={}),i===r.length-1&&(e[t]=n),e[t])),e),e},ot=(e,t)=>{const n={};return Object.keys(e).forEach((r=>{const i=e[r],o=((e,t)=>{const n=rt(t||'');return n.push(e),(e=>e.join('.'))(n)})(r,t);'object'==typeof i&&Object.assign(n,ot(i,o)),'function'==typeof i&&(n[o]=i)})),n};var at=(e,t,n,r,i)=>{const{localName:o,local:a,remote:s,originForSending:c,originForReceiving:u}=t;let l=!1;i(`${o}: Connecting call sender`);const d=e=>(...t)=>{let n;i(`${o}: Sending ${e}() call`);try{s.closed&&(n=!0)}catch(e){n=!0}if(n&&r(),l){const t=new Error(`Unable to send ${e}() call due to destroyed connection`);throw t.code=Ke.ConnectionDestroyed,t}return new Promise(((n,r)=>{const l=nt(),d=t=>{if(t.source!==s||t.data.penpal!==ze.Reply||t.data.id!==l)return;if('*'!==u&&t.origin!==u)return void i(`${o} received message from origin ${t.origin} which did not match expected origin ${u}`);const c=t.data;i(`${o}: Received ${e}() reply`),a.removeEventListener(Ze.Message,d);let h=c.returnValue;c.returnValueIsError&&(h=(e=>{const t=new Error;return Object.keys(e).forEach((n=>t[n]=e[n])),t})(h)),(c.resolution===Ye.Fulfilled?n:r)(h)};a.addEventListener(Ze.Message,d);const h={penpal:ze.Call,id:l,methodName:e,args:t};s.postMessage(h,c)}))},h=n.reduce(((e,t)=>(e[t]=d(t),e)),{});return Object.assign(e,(e=>{const t={};for(const n in e)it(t,n,e[n]);return t})(h)),()=>{l=!0}},st=(e,t,n,r,i)=>{const{destroy:o,onDestroy:a}=r;let s,c;const u={};return r=>{if('*'!==t&&r.origin!==t)return void i(`Parent: Handshake - Received ACK message from origin ${r.origin} which did not match expected origin ${t}`);i('Parent: Handshake - Received ACK');const l={localName:'Parent',local:window,remote:r.source,originForSending:n,originForReceiving:t};s&&s(),s=((e,t,n)=>{const{localName:r,local:i,remote:o,originForSending:a,originForReceiving:s}=e;let c=!1;const u=e=>{if(e.source!==o||e.data.penpal!==ze.Call)return;if('*'!==s&&e.origin!==s)return void n(`${r} received message from origin ${e.origin} which did not match expected origin ${s}`);const i=e.data,{methodName:u,args:l,id:d}=i;n(`${r}: Received ${u}() call`);const h=e=>t=>{if(n(`${r}: Sending ${u}() reply`),c)return void n(`${r}: Unable to send ${u}() reply due to destroyed connection`);const i={penpal:ze.Reply,id:d,resolution:e,returnValue:t};e===Ye.Rejected&&t instanceof Error&&(i.returnValue=et(t),i.returnValueIsError=!0);try{o.postMessage(i,a)}catch(e){if(e.name===Je.DataCloneError){const t={penpal:ze.Reply,id:d,resolution:Ye.Rejected,returnValue:et(e),returnValueIsError:!0};o.postMessage(t,a)}throw e}};new Promise((e=>e(t[u].apply(t,l)))).then(h(Ye.Fulfilled),h(Ye.Rejected))};return i.addEventListener(Ze.Message,u),()=>{c=!0,i.removeEventListener(Ze.Message,u)}})(l,e,i),a(s),c&&c.forEach((e=>{delete u[e]})),c=r.data.methodNames;const d=at(u,l,c,o,i);return a(d),u}};var ct=e=>{let{iframe:t,methods:n={},childOrigin:r,timeout:i,debug:o=!1}=e;const a=(e=>(...t)=>{e&&console.log('[Penpal]',...t)})(o),s=((e,t)=>{const n=[];let r=!1;return{destroy(i){r||(r=!0,t(`${e}: Destroying connection`),n.forEach((e=>{e(i)})))},onDestroy(e){r?e():n.push(e)}}})('Parent',a),{onDestroy:c,destroy:u}=s;r||((e=>{if(!e.src&&!e.srcdoc){const e=new Error('Iframe must have src or srcdoc property defined.');throw e.code=Ke.NoIframeSrc,e}})(t),r=(e=>{if(e&&Qe.find((t=>e.startsWith(t))))return'null';const t=document.location,n=qe.exec(e);let r,i,o;return n?(r=n[1]?n[1]:t.protocol,i=n[2],o=n[4]):(r=t.protocol,i=t.hostname,o=t.port),`${r}//${i}${o&&o!==$e[r]?`:${o}`:''}`})(t.src));const l='null'===r?'*':r,d=ot(n),h=((e,t,n,r)=>i=>{if('*'!==n&&i.origin!==n)return void e(`Parent: Handshake - Received SYN message from origin ${i.origin} which did not match expected origin ${n}`);e('Parent: Handshake - Received SYN, responding with SYN-ACK');const o={penpal:ze.SynAck,methodNames:Object.keys(t)};i.source.postMessage(o,r)})(a,d,r,l),p=st(d,r,l,s,a),f=new Promise(((e,n)=>{const r=((e,t)=>{let n;return void 0!==e&&(n=window.setTimeout((()=>{const n=new Error(`Connection timed out after ${e}ms`);n.code=Ke.ConnectionTimeout,t(n)}),e)),()=>{clearTimeout(n)}})(i,u),o=n=>{if(n.source===t.contentWindow&&n.data)if(n.data.penpal!==ze.Syn)if(n.data.penpal!==ze.Ack);else{const t=p(n);t&&(r(),e(t))}else h(n)};window.addEventListener(Ze.Message,o),a('Parent: Awaiting handshake'),((e,t)=>{const{destroy:n,onDestroy:r}=t,i=setInterval((()=>{e.isConnected||(clearInterval(i),n())}),6e4);r((()=>{clearInterval(i)}))})(t,s),c((e=>{window.removeEventListener(Ze.Message,o),e&&n(e)}))}));return{promise:f,destroy(){u()}}},ut=document.createElement('div');ut.id='noticeable-lightbox',ut.innerHTML='<figure><img src="" alt=""><figcaption></figcaption></figure>',ut.onclick=function(){ut.style.display='none',ut.remove(),lt.remove()};var lt=document.createElement('style');function dt(e,t,n){ut.isConnected||document.body.appendChild(ut),lt.isConnected||document.head.insertBefore(lt,document.head.firstChild);var r=ut.getElementsByTagName('figcaption')[0],i=ut.getElementsByTagName('img')[0];ut.style.display='flex',i.alt=t.trim().length>0?t:n.trim().length>0?n:'',i.src=e,i.style.transition='all 0.3s';var o=n.trim().length>0?n:t.trim().length>0?t:void 0;o&&(r.innerHTML=o,r.style.display='block')}lt.appendChild(document.createTextNode('\n#noticeable-lightbox {\n    align-items: center;\n    background: rgb(0, 0, 0);\n    cursor: zoom-out;\n    display: none;\n    flex-direction: column;\n    height: 100%;\n    inset: 0;\n    justify-content: center;\n    left: 0;\n    margin: 0;\n    overflow: auto;\n    padding: 0;\n    position: fixed;\n    right: 0;\n    top: 0;\n    width: 100%;\n    z-index: 2147483001;\n}\n\n#noticeable-lightbox figure {\n    display: block;\n    left: 50%;\n    margin: 0;\n    max-height: 100%;\n    max-width: 100%;\n    position: absolute;\n    top: 50%;\n    transform: translate(-50%, -50%);\n}\n\n#noticeable-lightbox figure img {\n    animation-duration: 0.6s;\n    animation-name: noticeable-zoom;\n    display: block;\n    margin: 0;\n    max-width: none;\n    padding: 48px 48px 0 48px;\n    transition: all 0.3s ease 0s;\n}\n\n#noticeable-lightbox figure figcaption {\n    box-sizing: border-box;\n    color: rgb(204, 204, 204);\n    display: none;\n    margin: 0;\n    padding: 24px 48px 48px 48px;\n    text-align: center;\n    width: 100%;\n}\n\n@keyframes noticeable-zoom {\n    from {\n        transform: scale(0.3)\n    }\n    to {\n        transform: scale(1)\n    }\n}'));var ht=function(){function e(){var t=this;r(this,e),a(this,'_caption',void 0),a(this,'_container',void 0),a(this,'_content',void 0),a(this,'_image',void 0),a(this,'_opened',void 0),this._caption=document.createElement('figcaption'),this._caption.style.color='#ccc',this._caption.style.display='block',this._caption.style.marginTop='24px',this._caption.style.textAlign='center',this._content=document.createElement('figure'),this._content.style.display='block',this._content.style.margin='0',this._content.style.top='50%',this._content.style.maxHeight='100%',this._content.style.maxWidth='100%',this._content.style.left='50%',this._content.style.position='absolute',this._content.style.transform='translate(-50%, -50%)',this._image=document.createElement('img'),this._image.style.display='block',this._image.style.margin='0',this._image.style.padding='48px 48px 16px 48px',this._image.style.transition='0.3s',this._container=document.createElement('div'),this._container.id='noticeable-lightbox',this._content.appendChild(this._image),this._content.appendChild(this._caption),this._container.appendChild(this._content),this._container.style.alignItems='center',this._container.style.background='rgb(0, 0, 0)',this._container.style.bottom='0',this._container.style.cursor='zoom-out',this._container.style.display='flex',this._container.style.flexDirection='column',this._container.style.height='100%',this._container.style.justifyContent='center',this._container.style.left='0',this._container.style.margin='0',this._container.style.overflow='auto',this._container.style.padding='0',this._container.style.position='fixed',this._container.style.right='0',this._container.style.top='0',this._container.style.width='100%',this._container.style.zIndex='2147483001',this._container.addEventListener('click',(function(){return t.close()})),this._opened=!1}return o(e,[{key:'close',value:function(){this._container.remove(),this._opened=!1}},{key:'open',value:function(e,t){this._opened&&this.close(),this._opened=!0,this._image.src=e,t&&(t=t.trim()).length>0?(this._caption.innerHTML=t,this._caption.style.display='block',this._image.alt=t):this._caption.style.display='none',document.body.appendChild(this._container)}}]),e}(),pt=function(){function e(t,n,i){r(this,e),a(this,'_element',void 0),a(this,'_loading',void 0),a(this,'_mouseEnterListener',void 0),a(this,'_mouseLeaveListener',void 0),a(this,'_visible',void 0),this._element=t,this._element.classList.add('noticeable-view_hidden'),this._loading=!0,this._mouseEnterListener=n,this._mouseLeaveListener=i,this._visible=!1}var t,i,s,c,u,l,d;return o(e,[{key:'alreadyRendered',value:(d=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case'end':return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:'element',get:function(){return this._element}},{key:'destroy',value:function(){this._mouseEnterListener&&this._element.removeEventListener('mouseenter',this._mouseEnterListener),this._mouseLeaveListener&&this._element.removeEventListener('mouseleave',this._mouseLeaveListener),this._destroy()}},{key:'_destroy',value:function(){}},{key:'hide',value:(l=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._visible){e.next=2;break}return e.abrupt('return');case 2:return this._visible=!1,e.abrupt('return',this._hide());case 4:case'end':return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:'_hide',value:(u=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._element.classList.add('noticeable-view_hidden'),this._element.style.opacity='0',this._element.style.visibility='hidden';case 3:case'end':return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:'refresh',value:(c=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',this._refresh());case 1:case'end':return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:'render',value:(s=n(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._render(t);case 2:return n=e.sent,this._mouseEnterListener&&this._element.addEventListener('mouseenter',this._mouseEnterListener),this._mouseLeaveListener&&this._element.addEventListener('mouseleave',this._mouseLeaveListener),e.abrupt('return',n);case 6:case'end':return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:'show',value:(i=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._visible){e.next=2;break}return e.abrupt('return');case 2:return this._visible=!0,e.abrupt('return',this._show());case 4:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'_show',value:(t=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._element.classList.remove('noticeable-view_hidden'),this._element.style.opacity='1',this._element.style.visibility='visible',this._element.focus();case 4:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:'visible',get:function(){return this._visible}}]),e}(),ft=function(e){s(l,e);var t,i,u=g(l);function l(e,t,n,i,o){var s;return r(this,l),a(p(s=u.call(this,t,i,o)),'_clickListener',void 0),a(p(s),'_trigger',void 0),s._clickListener=n,s._element.classList.add('noticeable-trigger-view'),s._trigger=e,s}return o(l,[{key:'destroy',value:function(){this._element.removeEventListener('click',this._clickListener),v(c(l.prototype),'destroy',this).call(this)}},{key:'dispatchEvent',value:function(e,t){this._trigger.widget.eventRegistry.dispatchEvent(this._trigger.widget.id,e,t)}},{key:'refresh',value:(i=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._refresh();case 2:return t=e.sent,this.dispatchEvent(R.WIDGET_TRIGGER_REFRESHED),e.abrupt('return',t);case 5:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'render',value:(t=n(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(c(l.prototype),'render',this).call(this,t);case 2:n=e.sent,this._element.addEventListener('click',this._clickListener),this.dispatchEvent(R.WIDGET_TRIGGER_READY,n);case 5:case'end':return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:'_onIdentityChange',value:function(e,t,n){}}]),l}(pt),gt=function(e){s(n,e);var t=g(n);function n(e){var i;return r(this,n),a(p(i=t.call(this,e,yt('Noticeable Trigger',(function(e){i._visible&&(e.target.style.opacity='1',e.target.style.visibility='visible',i._loading=!1)})),(function(){return i.dispatchEvent(R.WIDGET_TRIGGER_VIEW_CLICKED)}),(function(){return i.dispatchEvent(R.WIDGET_TRIGGER_VIEW_MOUSE_ENTERED)}),(function(){return i.dispatchEvent(R.WIDGET_TRIGGER_VIEW_MOUSE_LEFT)}))),'_childConnection',void 0),a(p(i),'_child',void 0),i}return o(n,[{key:'destroy',value:function(){this._childConnection&&(this._childConnection.destroy(),this._child=void 0,this._childConnection=void 0),this._destroy(),this._element.remove()}}]),n}(ft),_t=function(e){s(h,e);var t,i,u,l,d=g(h);function h(e,t){var n;return r(this,h),a(p(n=d.call(this,t,(function(){return n.dispatchEvent(R.WIDGET_WIDGET_VIEW_MOUSE_ENTERED)}),(function(){return n.dispatchEvent(R.WIDGET_WIDGET_VIEW_MOUSE_LEFT)}))),'_backdrop',void 0),a(p(n),'_backdropClickable',void 0),a(p(n),'_backdropElement',void 0),a(p(n),'_backdropClickListener',void 0),a(p(n),'_widget',void 0),a(p(n),'_zIndex',''),n._backdrop=!1,n._backdropClickable=!1,n._backdropClickListener=function(){return n._backdropClickable?n._widget.close():null},n._backdropElement=document.createElement('div'),n._backdropElement.addEventListener('click',n._backdropClickListener),n._backdropElement.id='noticeable-backdrop',n._backdropElement.style.bottom='0',n._backdropElement.style.left='0',n._backdropElement.style.position='fixed',n._backdropElement.style.right='0',n._backdropElement.style.top='0',n._backdropElement.style.zIndex='2147482999',n._element.classList.add('noticeable-widget-view'),n._element.style.zIndex='-1',n._widget=e,n}return o(h,[{key:'dispatchEvent',value:function(e,t){this._widget.eventRegistry.dispatchEvent(this._widget.id,e,t)}},{key:'publicationFetchLimit',get:function(){return 9}},{key:'segmentsOperator',get:function(){return'or'}},{key:'refresh',value:(l=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._refresh();case 2:return t=e.sent,this.dispatchEvent(R.WIDGET_REFRESHED,t),e.abrupt('return',t);case 5:case'end':return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:'render',value:(u=n(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.activeElement,e.next=3,v(c(h.prototype),'render',this).call(this,t);case 3:r=e.sent,n&&n instanceof HTMLElement&&n.focus(),this.dispatchEvent(R.WIDGET_READY,r);case 6:case'end':return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:'destroy',value:function(){this._backdropElement.remove(),v(c(h.prototype),'destroy',this).call(this)}},{key:'_hide',value:(i=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._backdrop&&this._backdropElement.remove(),e.next=3,v(c(h.prototype),'_hide',this).call(this);case 3:this._element.style.zIndex='-1';case 4:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'_show',value:(t=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._backdrop&&document.body.prepend(this._backdropElement),e.next=3,v(c(h.prototype),'_show',this).call(this);case 3:if(this._element.style.zIndex=this._zIndex,-1==navigator.userAgent.indexOf('Safari')||-1!=navigator.userAgent.indexOf('Chrome')){e.next=6;break}return e.abrupt('return',this.refresh());case 6:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),h}(pt),vt=function(e){s(l,e);var t,i,u=g(l);function l(e){var t;return r(this,l),a(p(t=u.call(this,e,yt('Noticeable Widget',(function(e){t._visible&&(e.target.style.opacity='1',e.target.style.visibility='visible',t._loading=!1)})))),'_childConnection',void 0),a(p(t),'_child',void 0),t._element.allowFullscreen=!0,t}return o(l,[{key:'destroy',value:function(){this._childConnection&&(this._childConnection.destroy(),this._child=void 0,this._childConnection=void 0),v(c(l.prototype),'destroy',this).call(this),this._element.remove()}},{key:'iframe',get:function(){return this._element}},{key:'_hide',value:(i=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this._child)||void 0===t||t.onHide(),e.abrupt('return',v(c(l.prototype),'_hide',this).call(this));case 2:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'_onIdentityChange',value:function(e,t,n){var r;return null===(r=this._child)||void 0===r?void 0:r.onIdentityChange(e,t,n)}},{key:'_show',value:(t=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(c(l.prototype),'_show',this).call(this);case 2:return e.abrupt('return',null===(t=this._child)||void 0===t?void 0:t.onShow());case 3:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),l}(_t),mt=function(e){s(u,e);var t,i=g(u);function u(e){var t;return r(this,u),a(p(t=i.call(this,e)),'_windowResizeListener',void 0),t._windowResizeListener=function(){return t.refresh()},t}return o(u,[{key:'_destroy',value:function(){v(c(u.prototype),'_destroy',this).call(this),window.removeEventListener('resize',this._windowResizeListener)}},{key:'_render',value:(t=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.addEventListener('resize',this._windowResizeListener);case 1:case'end':return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),u}(vt);function yt(e,t){var n=document.createElement('iframe');return n.allowtransparency='1',n.frameBorder='1',n.height='0',n.onload=t,n.scrolling='no',n.tabIndex=-1,n.style.border='0',n.style.opacity='0',n.style.overflow='hidden',n.style.userSelect='none',n.style.visibility='hidden',n.title=e,n.width='0',n}var Et=function(e){s(f,e);var t,i,u,l,d,h=g(f);function f(e){var t;return r(this,f),a(p(t=h.call(this,e)),'_lightbox',void 0),t._lightbox=new ht,t}return o(f,[{key:'_destroy',value:function(){this._widget.trigger.destroy(),v(c(f.prototype),'_destroy',this).call(this)}},{key:'render',value:(d=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleFirstTimeLoading();case 2:return e.abrupt('return',v(c(f.prototype),'render',this).call(this,t));case 3:case'end':return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:'handleFirstTimeLoading',value:(l=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this._widget.getLastPublicationSeen().size){e.next=15;break}return e.next=4,this._widget.getWidgetData();case 4:if(!((t=e.sent).widgetViewSettings.firstVisitUnreadUnseenCount>=0)){e.next=15;break}if(!(t.widgetViewSettings.firstVisitUnreadUnseenCount<t.widgetViewSettings.maxPublicationCount)){e.next=15;break}return e.next=10,this._widget.getPublicationData();case 10:for(n=e.sent,r=new ve,i=n.length-1;i>=t.widgetViewSettings.firstVisitUnreadUnseenCount;i--)o=n[i],r.add(o.id);return e.next=15,this._widget.identity.setLastPublicationReadSeen(this._widget.projectId,new ve(r.toArray()),new ve(r.toArray()),!0,!0,!0);case 15:return e.next=17,this._widget.getPublicationState();case 17:a=e.sent,this._widget.eventRegistry.dispatchEvent(this._widget.id,R.WIDGET_PUBLICATION_UNREAD_COUNT_CHANGED,{value:a.unreadCount}),this._widget.eventRegistry.dispatchEvent(this._widget.id,R.WIDGET_PUBLICATION_UNSEEN_COUNT_CHANGED,{value:a.unseenCount});case 20:case'end':return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:'_render',value:(u=n(regeneratorRuntime.mark((function e(t){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._widget.trigger.render({root:null==t?void 0:t.root,selector:null==t?void 0:t.selector}),this._element.src='https://widgets.noticeable.io/modal/index.html',this._element.style.boxShadow='rgba(0, 0, 0, 0.16) 0 5px 40px',this._element.style.position='fixed',this._zIndex='2147482999',document.body.appendChild(this._element),e.next=8,v(c(f.prototype),'_render',this).call(this,t);case 8:return this._childConnection=ct({iframe:this._element,methods:{close:function(){return i._widget.close()},dispatchEvent:function(e,t){return i.dispatchEvent(e,t)},getLastPublicationRead:function(){return i._widget.getLastPublicationRead()},getWidgetId:function(){return i._widget.id},getWindowLocationHref:function(){return window.location.href},openUrl:function(e,t){window.open(e,t)},setPublicationRead:function(e){return i._widget.setPublicationRead([e],{merge:!0})},setPublicationSeen:function(e){return i._widget.setPublicationSeen([e],{merge:!0})},zoom:function(e,t){return i._lightbox.open(e,t)}}}),e.next=11,this._childConnection.promise;case 11:return this._child=e.sent,e.next=14,this.refresh();case 14:return r=e.sent,e.next=17,n;case 17:return e.abrupt('return',r);case 18:case'end':return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:'_refresh',value:(i=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._widget.getProjectData(),o=this._widget.getPublicationData(),a=this._widget.getWidgetData(),s=L(),e.next=6,i;case 6:return c=e.sent,e.next=9,o;case 9:return u=e.sent,e.next=12,a;case 12:return l=e.sent,null===(t=this._child)||void 0===t||t.refresh(c,u,l.widgetViewSettings,s),this._backdrop=null!==(n=l.widgetViewSettings.backdrop)&&void 0!==n&&n,this._backdropClickable=null!==(r=l.widgetViewSettings.backdropClickable)&&void 0!==r&&r,this._backdrop?(this._backdropElement.style.background=null!==(d=l.widgetViewSettings.backdropColor)&&void 0!==d?d:'#00000099',this._widget.opened&&!this._backdropElement.isConnected?document.body.prepend(this._backdropElement):!this._widget.opened&&this._backdropElement.isConnected&&this._backdropElement.remove()):this._backdropElement.isConnected&&this._backdropElement.remove(),s?(this._element.style.borderRadius=G(0),this._element.style.bottom=G(0),this._element.style.height='100%',this._element.style.left=G(0),this._element.style.marginLeft=G(0),this._element.style.marginTop=G(0),this._element.style.maxWidth='unset',this._element.style.minWidth='unset',this._element.style.right=G(0),this._element.style.top=G(0),this._element.style.transform='none',this._element.style.width='100%'):(this._element.style.borderRadius=G(null!==(h=l.widgetViewSettings.borderRadius)&&void 0!==h?h:8),this._element.style.height=l.widgetViewSettings.height+'%',this._element.style.left='50%',this._element.style.marginLeft=-this._element.offsetWidth/2+'px',this._element.style.marginTop=-this._element.offsetHeight/2+'px',this._element.style.maxWidth='780px',this._element.style.minWidth='480px',this._element.style.top='50%',this._element.style.width=l.widgetViewSettings.width+'%'),e.abrupt('return',{publications:u});case 19:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'_show',value:(t=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._widget.getPublicationData();case 2:return t=e.sent,e.next=5,v(c(f.prototype),'_show',this).call(this);case 5:return e.next=7,this.refresh();case 7:return e.abrupt('return',this._widget.setPublicationSeen(t.map((function(e){return e.id})),{merge:!0}));case 8:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),f}(mt),bt='#noticeable-widget';function wt(e,t){e||(A.warn('You specified an invalid selector ('.concat(e,'). Falling back to the default ').concat(bt,' selector')),e=bt);var n=(t||window.document).querySelectorAll(e);if(0===n.length)throw new Error('Could not find element matching selector: '+e);return 1===n.length||A.warn('Your selector match several elements on this page. The first one was picked'),n.item(0)}var It,Rt,Tt,Ot,St,At,Nt,Ct,kt,Dt,Pt,xt,Lt,Ut,Gt=function(t){s(d,t);var i,c,u,l=g(d);function d(e){var t;return r(this,d),a(p(t=l.call(this,e)),'_containerElement',void 0),a(p(t),'_hashChangeListener',void 0),a(p(t),'_optionsUrlSuffix',''),a(p(t),'_mustSkipHashChangeEvent',!1),a(p(t),'_spinnerElement',void 0),a(p(t),'_styleElement',void 0),t._hashChangeListener=function(){var e=n(regeneratorRuntime.mark((function e(n){var r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t._widget.getProjectData(),i=t._widget.getWidgetData(),e.next=4,r;case 4:return o=e.sent,e.next=7,i;case 7:a=e.sent,t._mustSkipHashChangeEvent?t._mustSkipHashChangeEvent=!1:t._element.src=t._computeIframeUrl(o,a);case 9:case'end':return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t._containerElement=document.createElement('div'),t._containerElement.style.height='100%',t._containerElement.style.position='relative',t._containerElement.style.width='100%',t.iframe.style.height='100%',t.iframe.style.width='100%',t._spinnerElement=document.createElement('div'),t._spinnerElement.classList.add('noticeable-widget-spinner'),t._spinnerElement.style.animation='noticeable-spinner 1s linear infinite',t._spinnerElement.style.border='5px solid #e1e1e1',t._spinnerElement.style.borderRadius='50%',t._spinnerElement.style.borderTop='4px solid var(--accent-color, #666)',t._spinnerElement.style.boxSizing='content-box',t._spinnerElement.style.height='22px',t._spinnerElement.style.left='50%',t._spinnerElement.style.position='absolute',t._spinnerElement.style.top='50%',t._spinnerElement.style.transform='translate(-50%, -50%)',t._spinnerElement.style.width='22px',t._styleElement=document.createElement('style'),t._styleElement.innerHTML='@keyframes noticeable-spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }',t}return o(d,[{key:'publicationFetchLimit',get:function(){return 0}},{key:'_destroy',value:function(){this._containerElement.remove(),this._styleElement.remove(),this._hashChangeListener&&window.removeEventListener('hashchange',this._hashChangeListener)}},{key:'_render',value:(u=n(regeneratorRuntime.mark((function e(t){var r,i,o,a,s,c,u,l,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._widget.getProjectData(),e.next=3,this._widget.getWidgetData();case 3:if(s=e.sent,c=null!==(r=null!==(i=null==t?void 0:t.selector)&&void 0!==i?i:null===(o=s.widgetViewSettings)||void 0===o?void 0:o.selector)&&void 0!==r?r:bt,u=wt(c,null==t?void 0:t.root)){e.next=9;break}return A.warn('Could not find matching selector: '+c),e.abrupt('return');case 9:return null!=t&&t.root?t.root.appendChild(this._styleElement):document.head.appendChild(this._styleElement),this._containerElement.appendChild(this._spinnerElement),this._containerElement.appendChild(this._element),u.appendChild(this._containerElement),this._optionsUrlSuffix=d._computeOptionsUrlSuffix(s,t),e.next=16,a;case 16:return l=e.sent,this.iframe.addEventListener('load',(function(e){h.iframe.style.opacity='1',h.iframe.style.visibility='visible',h._spinnerElement.style.display='none',h._visible=!0})),this.iframe.src=this._computeIframeUrl(l,s),this.iframe.style.background='transparent',this.iframe.style.border='0',this.iframe.style.opacity='0',this.iframe.style.visibility='hidden',this.iframe.style.width='100%',e.next=26,ct({iframe:this._element,methods:{dispatchEvent:function(e,t){h.dispatchEvent(e,t)},getWidgetId:function(){return h._widget.id},getWindowLocationHref:function(){return window.location.href},openLighbox:function(e,t,n){dt(e,t,n)},setHeight:function(e){h.iframe.height=e+'px',h.iframe.style.height=e+'px'},setLocation:function(e){s.widgetViewSettings.hashRouting&&(e=e.substr(1))!==window.location.hash.substr(1)&&(window.location.hash=e,h._mustSkipHashChangeEvent=!0)},setPublicationRead:function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h._widget.setPublicationRead(t,{merge:!0});case 2:window.noticeable.refresh();case 3:case'end':return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setPublicationReadSeen:function(){var e=n(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h._widget.setPublicationSeen(t,{merge:!0}),r=h._widget.setPublicationRead(t,{merge:!0}),e.next=4,n;case 4:return e.next=6,r;case 6:window.noticeable.refresh();case 7:case'end':return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setPublicationSeen:function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h._widget.setPublicationSeen(t,{merge:!0});case 2:window.noticeable.refresh();case 3:case'end':return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}});case 26:return this._childConnection=e.sent,e.next=29,this._childConnection.promise;case 29:return this._child=e.sent,s.widgetViewSettings.hashRouting&&window.addEventListener('hashchange',this._hashChangeListener,!1),e.abrupt('return',this.refresh());case 32:case'end':return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:'alreadyRendered',value:(c=n(regeneratorRuntime.mark((function e(t){var n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._widget.getWidgetData();case 2:if(r=e.sent,i=null===(n=r.widgetViewSettings)||void 0===n?void 0:n.selector,e.prev=4,o=wt(i,null==t?void 0:t.root)){e.next=8;break}return e.abrupt('return');case 8:0===o.children.length&&o.appendChild(this._containerElement),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:case'end':return e.stop()}}),e,this,[[4,11]])}))),function(e){return c.apply(this,arguments)})},{key:'_computeIframeUrl',value:function(t,n){var r='https://'+t.newspageDomain;if(n.widgetViewSettings.hashRouting){var i=window.location.hash.substr(1);r=r+'/'+(i.startsWith('/')?i.substr(1):i)}if(r+=this._optionsUrlSuffix,this._widget.renderOptions.queryParameters&&'object'===e(this._widget.renderOptions.queryParameters))for(var o=0,a=Object.entries(this._widget.renderOptions.queryParameters);o<a.length;o++){var s=m(a[o],2);r=r+'&'+s[0]+'='+s[1]}return r}},{key:'_refresh',value:(i=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.iframe.contentDocument)||void 0===t||t.location.reload(),e.abrupt('return',{});case 2:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],[{key:'_computeOptionsUrlSuffix',value:function(e,t){var n='?embed=true';if(e.widgetViewSettings.header||(n+='&header=false'),e.widgetViewSettings.labelsPicker||(n+='&menu=false'),null!=t&&t.segments&&t.segments.length>0){var r,i=w(t.segments);try{for(i.s();!(r=i.n()).done;){n=n+'&segment='+r.value}}catch(e){i.e(e)}finally{i.f()}}return null!=t&&t.token&&(n=n+'&stoken='+t.token),n}}]),d}(vt);!function(e){e[e.READ=2]='READ',e[e.WRITE=4]='WRITE',e[e.READ_WRITE=6]='READ_WRITE'}(It||(It={})),function(e){e.API='api',e.SCIM='scim',e.WIDGET='widget',e.ZAPIER='zapier'}(Rt||(Rt={})),function(e){e.IGNORE='ignore',e.OPTIONAL='optional',e.REQUIRED='required'}(Tt||(Tt={})),function(e){e.API='api',e.NEWSPAGE='newspage',e.WIDGET='widget'}(Ot||(Ot={})),function(e){e.PRIVATE='private',e.PUBLIC='public'}(St||(St={})),function(e){e.INVALID_A='invalid-a',e.INVALID_CNAME='invalid-cname',e.INVALID_TXT='invalid-txt',e.MISSING_A='missing-a',e.MISSING_CNAME='missing-cname',e.MISSING_TXT='missing-txt',e.PENDING='pending',e.VERIFIED='verified'}(At||(At={})),function(e){e.COMMENTS_PRIVATE='c',e.COMMENTS_PUBLIC='cp',e.EMAIL_SUBSCRIPTIONS_ARCHIVED='esa',e.EMAIL_SUBSCRIPTIONS_CLEANED='esc',e.EMAIL_SUBSCRIPTIONS_NON_SUBSCRIBED='esns',e.EMAIL_SUBSCRIPTIONS_SUBSCRIBED='ess',e.EMAIL_SUBSCRIPTIONS_UNSUBSCRIBED='esu',e.NEWSPAGE_CTA_CLICKS='ncc',e.NEWSPAGE_LINK_CLICKS='nlc',e.NEWSPAGE_VIEWS='nv',e.PUSH_SUBSCRIPTIONS='ps',e.PUSH_UNSUBSCRIPTIONS='pu',e.REACTIONS_BAD='rb',e.REACTIONS_GOOD='rg',e.REACTIONS_NEUTRAL='rn',e.WIDGET_CTA_CLICKS='wcc',e.WIDGET_LINK_CLICKS='wlc',e.WIDGET_OPENINGS='wo',e.WIDGET_VIEWS='wv'}(Nt||(Nt={})),function(e){e.COMMENTS='c',e.NEWSPAGE_CTA_CLICKS='ncc',e.NEWSPAGE_LINK_CLICKS='nlc',e.NEWSPAGE_VIEWS='nv',e.REACTIONS_BAD='rb',e.REACTIONS_GOOD='rg',e.REACTIONS_NEUTRAL='rn',e.WIDGET_CTA_CLICKS='wcc',e.WIDGET_LINK_CLICKS='wlc',e.WIDGET_VIEWS='wv'}(Ct||(Ct={})),function(e){e.DAILY='d',e.HOURLY='h'}(kt||(kt={})),function(e){e.DAILY='d',e.HOURLY='h'}(Dt||(Dt={})),function(e){e.MESSAGE='message',e.REDIRECT='redirect'}(Pt||(Pt={})),function(e){e.PASSWORD='password',e.TOKEN='token'}(xt||(xt={})),function(e){e.NONE='none',e.ZOOM_IN_ROTATE='zoom-in-rotate'}(Lt||(Lt={})),function(e){e.NOTICEONE='noticeone'}(Ut||(Ut={}));class Wt{constructor(e,...t){this.id=e,this.organizations=t&&0!=t.length?new Set(t):null,this.phrases=P.load(D.NEWSPAGE,e)}static from(e){const t=jt[e];return t?t instanceof Function?(jt[e]=t(),jt[e]):t:null}getId(){return this.id}getOrganizations(){return this.organizations}getPhrases(){return this.phrases}async getPhrase(e,t){return(await this.phrases).phrase(e,t)}isAccessibleFrom(e){return null===this.organizations||this.organizations.has(e)}}const jt={[Ut.NOTICEONE]:()=>new Wt(Ut.NOTICEONE)};var Mt,Bt,Vt,Ht,Ft,zt,Yt,Kt,Jt,Zt,Xt,$t,qt,Qt,en,tn,nn,rn,on,an,sn,cn,un,ln,dn,hn,pn,fn,gn,_n,vn,mn,yn,En,bn,wn;!function(e){e.EMAILS='emails'}(Mt||(Mt={})),function(e){e.OIDC='oidc',e.SAML='saml'}(Bt||(Bt={})),function(e){e.BLANK='b',e.JOIN_PROJECTS_AS_ADMIN='jpaa',e.JOIN_PROJECTS_AS_EDITOR='jpae',e.JOIN_PROJECTS_AS_VIEWER='jpav'}(Vt||(Vt={})),function(e){e.DISABLED='disabled',e.PRIVATE='private',e.PUBLIC='public'}(Ht||(Ht={})),function(e){e.EMAIL='email',e.NOTIFICATION='notification',e.WEBHOOK='webhook',e.ZAPIER='zapier'}(Ft||(Ft={})),function(e){e.CANCELED='canceled',e.FAILED='failed',e.PENDING='pending',e.RUNNING='running',e.SUCCEEDED='succeeded'}(zt||(zt={})),function(e){e.ABSOLUTE='absolute',e.HIDDEN='hidden',e.RELATIVE='relative'}(Yt||(Yt={})),function(e){e.DISABLED='disabled',e.ENABLED='enabled',e.ENABLED_WHEN_UID='enabled-uid'}(Kt||(Kt={})),function(e){e.DOUBLE_OPT_IN='doi',e.SINGLE_OPT_IN='soi'}(Jt||(Jt={})),function(e){e.API='api',e.DASHBOARD='dashboard',e.NEWSPAGE='newspage',e.WIDGET='widget',e.ZAPIER='zapier'}(Zt||(Zt={})),function(e){e.ARCHIVED='archived',e.CLEANED='cleaned',e.NON_SUBSCRIBED='non-subscribed',e.SUBSCRIBED='subscribed',e.UNSUBSCRIBED='unsubscribed'}(Xt||(Xt={})),function(e){e[e.VIEWER=1]='VIEWER',e[e.EDITOR=2]='EDITOR',e[e.ADMIN=4]='ADMIN',e[e.OWNER=7]='OWNER'}($t||($t={})),function(e){e.EMAIL_SUBSCRIPTION_CREATE='email_subscription.create',e.EMAIL_SUBSCRIPTION_DELETE='email_subscription.delete',e.EMAIL_SUBSCRIPTION_UPDATE='email_subscription.update',e.POST_CREATE='post.create',e.POST_CREATE_UPDATE='post.create_update',e.POST_DELETE='post.delete',e.POST_UPDATE='post.update'}(qt||(qt={})),function(e){e.HTTP='http',e.ZAPIER='zapier'}(Qt||(Qt={})),function(e){e.BOUNCE='bounce',e.NONE='none',e.PULSE='pulse',e.SHAKE='shake'}(en||(en={})),function(e){e.NONE='none',e.UNREAD_COUNT='unread',e.UNSEEN_COUNT='unseen'}(tn||(tn={})),function(e){e.END='end',e.START='start'}(nn||(nn={})),function(e){e.DASHED='dashed',e.DOTTED='dotted',e.SOLID='solid'}(rn||(rn={})),function(e){e.ALERT='alert',e.BELL='bell',e.CHAT='chat',e.CUSTOM='custom',e.FLAME='flame',e.GIFT='gift',e.MEGAPHONE='megaphone'}(on||(on={})),function(e){e.BOTTOM_END='bottom-end',e.BOTTOM_START='bottom-start'}(an||(an={})),function(e){e.W100='100',e.W200='200',e.W300='300',e.W400='400',e.W500='500',e.W600='600',e.W700='700',e.W800='800',e.W900='900'}(sn||(sn={})),function(e){e.BUBBLES='bubbles',e.LINE_IN_MOTION='line-in-motion',e.NONE='none',e.SHAPES='shapes',e.WAVES='waves'}(cn||(cn={})),function(e){e.BELL='bell',e.CUSTOM='custom',e.FLAME='flame',e.GIFT='gift',e.MEGAPHONE='megaphone'}(un||(un={})),function(e){e.OPEN_CTA_URL='open-cta',e.OPEN_IN_NEWSPAGE='open-newspage',e.OPEN_IN_WIDGET='open-widget'}(ln||(ln={})),function(e){e.AUTO='auto',e.AUTO_END='auto-end',e.AUTO_START='auto-start',e.BOTTOM='bottom',e.BOTTOM_END='bottom-end',e.BOTTOM_START='bottom-start',e.LEFT='left',e.LEFT_END='left-end',e.LEFT_START='left-start',e.RIGHT='right',e.RIGHT_END='right-end',e.RIGHT_START='right-start',e.TOP='top',e.TOP_END='top-end',e.TOP_START='top-start'}(dn||(dn={})),function(e){e.CTA='cta',e.CUSTOM='custom',e.NEWSPAGE_PUBLICATION='newspage-publication',e.NEWSPAGE='newspage'}(hn||(hn={})),function(e){e.AND='and',e.OR='or'}(pn||(pn={})),function(e){e.CENTER='center',e.END='end',e.START='start'}(fn||(fn={})),function(e){e.BUTTON='button',e.LINK='link'}(gn||(gn={})),function(e){e.BANNER_CLICK='banner-click',e.CLOSE_BUTTON_CLICK='close-button-click',e.CTA_CLICK='cta-click'}(_n||(_n={})),function(e){e.BOTTOM='bottom',e.BOTTOM_STICKY='bottom-sticky',e.TOP='top',e.TOP_STICKY='top-sticky'}(vn||(vn={})),function(e){e.CUSTOM='custom',e.NEWSPAGE='newspage',e.NONE='none'}(mn||(mn={})),function(e){e.LINE_THROUGH='line-through',e.UNDERLINE='underline',e.UNSET='unset'}(yn||(yn={})),function(e){e.NEVER='never',e.WHEN_ALL_READ='when-all-read',e.WHEN_ALL_SEEN='when-all-seen'}(En||(En={})),function(e){e.BADGE='badge',e.CUSTOM='custom',e.FLOATING_BUTTON='floating-button',e.ICON='icon',e.NONE='none'}(bn||(bn={})),function(e){e.CARD='card',e.FLOATING_CARD='floating-card',e.INLINE='inline',e.MODAL='modal',e.NEWSPAGE_EMBED='newspage-embed',e.POPUP='popup',e.REDIRECTION='redirection',e.SIDE_PANEL='side-panel',e.TOP_BANNER='top-banner'}(wn||(wn={}));const In={[wn.CARD]:void 0,[wn.FLOATING_CARD]:void 0,[wn.INLINE]:void 0,[wn.MODAL]:ne.MODAL_WIDGET,[wn.NEWSPAGE_EMBED]:ne.NEWSPAGE_EMBED_WIDGET,[wn.POPUP]:ne.POPUP_WIDGET,[wn.REDIRECTION]:ne.REDIRECTION_WIDGET,[wn.SIDE_PANEL]:void 0,[wn.TOP_BANNER]:ne.TOP_BANNER_WIDGET};var Rn='top',Tn='bottom',On='right',Sn='left',An='auto',Nn=[Rn,Tn,On,Sn],Cn='start',kn='end',Dn='viewport',Pn='popper',xn=Nn.reduce((function(e,t){return e.concat([t+'-'+Cn,t+'-'+kn])}),[]),Ln=[].concat(Nn,[An]).reduce((function(e,t){return e.concat([t,t+'-'+Cn,t+'-'+kn])}),[]),Un=['beforeRead','read','afterRead','beforeMain','main','afterMain','beforeWrite','write','afterWrite'];function Gn(e){return e?(e.nodeName||'').toLowerCase():null}function Wn(e){if(null==e)return window;if('[object Window]'!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function jn(e){return e instanceof Wn(e).Element||e instanceof Element}function Mn(e){return e instanceof Wn(e).HTMLElement||e instanceof HTMLElement}function Bn(e){return'undefined'!=typeof ShadowRoot&&(e instanceof Wn(e).ShadowRoot||e instanceof ShadowRoot)}var Vn={name:'applyStyles',enabled:!0,phase:'write',fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];Mn(i)&&Gn(i)&&(Object.assign(i.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?'':t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:'0',top:'0',margin:'0'},arrow:{position:'absolute'},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],i=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]='',e}),{});Mn(r)&&Gn(r)&&(Object.assign(r.style,o),Object.keys(i).forEach((function(e){r.removeAttribute(e)})))}))}},requires:['computeStyles']};function Hn(e){return e.split('-')[0]}var Fn=Math.max,zn=Math.min,Yn=Math.round;function Kn(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),r=1,i=1;if(Mn(e)&&t){var o=e.offsetHeight,a=e.offsetWidth;a>0&&(r=Yn(n.width)/a||1),o>0&&(i=Yn(n.height)/o||1)}return{width:n.width/r,height:n.height/i,top:n.top/i,right:n.right/r,bottom:n.bottom/i,left:n.left/r,x:n.left/r,y:n.top/i}}function Jn(e){var t=Kn(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Zn(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&Bn(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Xn(e){return Wn(e).getComputedStyle(e)}function $n(e){return['table','td','th'].indexOf(Gn(e))>=0}function qn(e){return((jn(e)?e.ownerDocument:e.document)||window.document).documentElement}function Qn(e){return'html'===Gn(e)?e:e.assignedSlot||e.parentNode||(Bn(e)?e.host:null)||qn(e)}function er(e){return Mn(e)&&'fixed'!==Xn(e).position?e.offsetParent:null}function tr(e){for(var t=Wn(e),n=er(e);n&&$n(n)&&'static'===Xn(n).position;)n=er(n);return n&&('html'===Gn(n)||'body'===Gn(n)&&'static'===Xn(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf('firefox');if(-1!==navigator.userAgent.indexOf('Trident')&&Mn(e)&&'fixed'===Xn(e).position)return null;for(var n=Qn(e);Mn(n)&&['html','body'].indexOf(Gn(n))<0;){var r=Xn(n);if('none'!==r.transform||'none'!==r.perspective||'paint'===r.contain||-1!==['transform','perspective'].indexOf(r.willChange)||t&&'filter'===r.willChange||t&&r.filter&&'none'!==r.filter)return n;n=n.parentNode}return null}(e)||t}function nr(e){return['top','bottom'].indexOf(e)>=0?'x':'y'}function rr(e,t,n){return Fn(e,zn(t,n))}function ir(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function or(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var ar={name:'arrow',enabled:!0,phase:'main',fn:function(e){var t,n=e.state,r=e.name,i=e.options,o=n.elements.arrow,a=n.modifiersData.popperOffsets,s=Hn(n.placement),c=nr(s),u=[Sn,On].indexOf(s)>=0?'height':'width';if(o&&a){var l=function(e,t){return ir('number'!=typeof(e='function'==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:or(e,Nn))}(i.padding,n),d=Jn(o),h='y'===c?Rn:Sn,p='y'===c?Tn:On,f=n.rects.reference[u]+n.rects.reference[c]-a[c]-n.rects.popper[u],g=a[c]-n.rects.reference[c],_=tr(o),v=_?'y'===c?_.clientHeight||0:_.clientWidth||0:0,m=f/2-g/2,y=l[h],E=v-d[u]-l[p],b=v/2-d[u]/2+m,w=rr(y,b,E),I=c;n.modifiersData[r]=((t={})[I]=w,t.centerOffset=w-b,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?'[data-popper-arrow]':n;null!=r&&('string'!=typeof r||(r=t.elements.popper.querySelector(r)))&&('production'!==process.env.NODE_ENV&&(Mn(r)||console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).','To use an SVG arrow, wrap it in an HTMLElement that will be used as','the arrow.'].join(' '))),Zn(t.elements.popper,r)?t.elements.arrow=r:'production'!==process.env.NODE_ENV&&console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper','element.'].join(' ')))},requires:['popperOffsets'],requiresIfExists:['preventOverflow']};function sr(e){return e.split('-')[1]}var cr={top:'auto',right:'auto',bottom:'auto',left:'auto'};function ur(e){var t,n=e.popper,r=e.popperRect,i=e.placement,o=e.variation,a=e.offsets,s=e.position,c=e.gpuAcceleration,u=e.adaptive,l=e.roundOffsets,d=e.isFixed,h=a.x,p=void 0===h?0:h,f=a.y,g=void 0===f?0:f,_='function'==typeof l?l({x:p,y:g}):{x:p,y:g};p=_.x,g=_.y;var v=a.hasOwnProperty('x'),m=a.hasOwnProperty('y'),y=Sn,E=Rn,b=window;if(u){var w=tr(n),I='clientHeight',R='clientWidth';if(w===Wn(n)&&'static'!==Xn(w=qn(n)).position&&'absolute'===s&&(I='scrollHeight',R='scrollWidth'),w=w,i===Rn||(i===Sn||i===On)&&o===kn)E=Tn,g-=(d&&b.visualViewport?b.visualViewport.height:w[I])-r.height,g*=c?1:-1;if(i===Sn||(i===Rn||i===Tn)&&o===kn)y=On,p-=(d&&b.visualViewport?b.visualViewport.width:w[R])-r.width,p*=c?1:-1}var T,O=Object.assign({position:s},u&&cr),S=!0===l?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:Yn(t*r)/r||0,y:Yn(n*r)/r||0}}({x:p,y:g}):{x:p,y:g};return p=S.x,g=S.y,c?Object.assign({},O,((T={})[E]=m?'0':'',T[y]=v?'0':'',T.transform=(b.devicePixelRatio||1)<=1?'translate('+p+'px, '+g+'px)':'translate3d('+p+'px, '+g+'px, 0)',T)):Object.assign({},O,((t={})[E]=m?g+'px':'',t[y]=v?p+'px':'',t.transform='',t))}var lr={passive:!0};var dr={left:'right',right:'left',bottom:'top',top:'bottom'};function hr(e){return e.replace(/left|right|bottom|top/g,(function(e){return dr[e]}))}var pr={start:'end',end:'start'};function fr(e){return e.replace(/start|end/g,(function(e){return pr[e]}))}function gr(e){var t=Wn(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function _r(e){return Kn(qn(e)).left+gr(e).scrollLeft}function vr(e){var t=Xn(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function mr(e){return['html','body','#document'].indexOf(Gn(e))>=0?e.ownerDocument.body:Mn(e)&&vr(e)?e:mr(Qn(e))}function yr(e,t){var n;void 0===t&&(t=[]);var r=mr(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=Wn(r),a=i?[o].concat(o.visualViewport||[],vr(r)?r:[]):r,s=t.concat(a);return i?s:s.concat(yr(Qn(a)))}function Er(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function br(e,t){return t===Dn?Er(function(e){var t=Wn(e),n=qn(e),r=t.visualViewport,i=n.clientWidth,o=n.clientHeight,a=0,s=0;return r&&(i=r.width,o=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=r.offsetLeft,s=r.offsetTop)),{width:i,height:o,x:a+_r(e),y:s}}(e)):jn(t)?function(e){var t=Kn(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):Er(function(e){var t,n=qn(e),r=gr(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=Fn(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Fn(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-r.scrollLeft+_r(e),c=-r.scrollTop;return'rtl'===Xn(i||n).direction&&(s+=Fn(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:a,x:s,y:c}}(qn(e)))}function wr(e,t,n){var r='clippingParents'===t?function(e){var t=yr(Qn(e)),n=['absolute','fixed'].indexOf(Xn(e).position)>=0&&Mn(e)?tr(e):e;return jn(n)?t.filter((function(e){return jn(e)&&Zn(e,n)&&'body'!==Gn(e)})):[]}(e):[].concat(t),i=[].concat(r,[n]),o=i[0],a=i.reduce((function(t,n){var r=br(e,n);return t.top=Fn(r.top,t.top),t.right=zn(r.right,t.right),t.bottom=zn(r.bottom,t.bottom),t.left=Fn(r.left,t.left),t}),br(e,o));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Ir(e){var t,n=e.reference,r=e.element,i=e.placement,o=i?Hn(i):null,a=i?sr(i):null,s=n.x+n.width/2-r.width/2,c=n.y+n.height/2-r.height/2;switch(o){case Rn:t={x:s,y:n.y-r.height};break;case Tn:t={x:s,y:n.y+n.height};break;case On:t={x:n.x+n.width,y:c};break;case Sn:t={x:n.x-r.width,y:c};break;default:t={x:n.x,y:n.y}}var u=o?nr(o):null;if(null!=u){var l='y'===u?'height':'width';switch(a){case Cn:t[u]=t[u]-(n[l]/2-r[l]/2);break;case kn:t[u]=t[u]+(n[l]/2-r[l]/2)}}return t}function Rr(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=void 0===r?e.placement:r,o=n.boundary,a=void 0===o?'clippingParents':o,s=n.rootBoundary,c=void 0===s?Dn:s,u=n.elementContext,l=void 0===u?Pn:u,d=n.altBoundary,h=void 0!==d&&d,p=n.padding,f=void 0===p?0:p,g=ir('number'!=typeof f?f:or(f,Nn)),_=l===Pn?'reference':Pn,v=e.rects.popper,m=e.elements[h?_:l],y=wr(jn(m)?m:m.contextElement||qn(e.elements.popper),a,c),E=Kn(e.elements.reference),b=Ir({reference:E,element:v,strategy:'absolute',placement:i}),w=Er(Object.assign({},v,b)),I=l===Pn?w:E,R={top:y.top-I.top+g.top,bottom:I.bottom-y.bottom+g.bottom,left:y.left-I.left+g.left,right:I.right-y.right+g.right},T=e.modifiersData.offset;if(l===Pn&&T){var O=T[i];Object.keys(R).forEach((function(e){var t=[On,Tn].indexOf(e)>=0?1:-1,n=[Rn,Tn].indexOf(e)>=0?'y':'x';R[e]+=O[n]*t}))}return R}function Tr(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=n.boundary,o=n.rootBoundary,a=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,u=void 0===c?Ln:c,l=sr(r),d=l?s?xn:xn.filter((function(e){return sr(e)===l})):Nn,h=d.filter((function(e){return u.indexOf(e)>=0}));0===h.length&&(h=d,'production'!==process.env.NODE_ENV&&console.error(['Popper: The `allowedAutoPlacements` option did not allow any','placements. Ensure the `placement` option matches the variation','of the allowed placements.','For example, "auto" cannot be used to allow "bottom-start".','Use "auto-start" instead.'].join(' ')));var p=h.reduce((function(t,n){return t[n]=Rr(e,{placement:n,boundary:i,rootBoundary:o,padding:a})[Hn(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}var Or={name:'flip',enabled:!0,phase:'main',fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,o=void 0===i||i,a=n.altAxis,s=void 0===a||a,c=n.fallbackPlacements,u=n.padding,l=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,f=void 0===p||p,g=n.allowedAutoPlacements,_=t.options.placement,v=Hn(_),m=c||(v===_||!f?[hr(_)]:function(e){if(Hn(e)===An)return[];var t=hr(e);return[fr(e),t,fr(t)]}(_)),y=[_].concat(m).reduce((function(e,n){return e.concat(Hn(n)===An?Tr(t,{placement:n,boundary:l,rootBoundary:d,padding:u,flipVariations:f,allowedAutoPlacements:g}):n)}),[]),E=t.rects.reference,b=t.rects.popper,w=new Map,I=!0,R=y[0],T=0;T<y.length;T++){var O=y[T],S=Hn(O),A=sr(O)===Cn,N=[Rn,Tn].indexOf(S)>=0,C=N?'width':'height',k=Rr(t,{placement:O,boundary:l,rootBoundary:d,altBoundary:h,padding:u}),D=N?A?On:Sn:A?Tn:Rn;E[C]>b[C]&&(D=hr(D));var P=hr(D),x=[];if(o&&x.push(k[S]<=0),s&&x.push(k[D]<=0,k[P]<=0),x.every((function(e){return e}))){R=O,I=!1;break}w.set(O,x)}if(I)for(var L=function(e){var t=y.find((function(t){var n=w.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return R=t,'break'},U=f?3:1;U>0;U--){if('break'===L(U))break}t.placement!==R&&(t.modifiersData[r]._skip=!0,t.placement=R,t.reset=!0)}},requiresIfExists:['offset'],data:{_skip:!1}};function Sr(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Ar(e){return[Rn,On,Tn,Sn].some((function(t){return e[t]>=0}))}var Nr={name:'offset',enabled:!0,phase:'main',requires:['popperOffsets'],fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.offset,o=void 0===i?[0,0]:i,a=Ln.reduce((function(e,n){return e[n]=function(e,t,n){var r=Hn(e),i=[Sn,Rn].indexOf(r)>=0?-1:1,o='function'==typeof n?n(Object.assign({},t,{placement:e})):n,a=o[0],s=o[1];return a=a||0,s=(s||0)*i,[Sn,On].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,o),e}),{}),s=a[t.placement],c=s.x,u=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=a}};var Cr={name:'preventOverflow',enabled:!0,phase:'main',fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,o=void 0===i||i,a=n.altAxis,s=void 0!==a&&a,c=n.boundary,u=n.rootBoundary,l=n.altBoundary,d=n.padding,h=n.tether,p=void 0===h||h,f=n.tetherOffset,g=void 0===f?0:f,_=Rr(t,{boundary:c,rootBoundary:u,padding:d,altBoundary:l}),v=Hn(t.placement),m=sr(t.placement),y=!m,E=nr(v),b='x'===E?'y':'x',w=t.modifiersData.popperOffsets,I=t.rects.reference,R=t.rects.popper,T='function'==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,O='number'==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),S=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,A={x:0,y:0};if(w){if(o){var N,C='y'===E?Rn:Sn,k='y'===E?Tn:On,D='y'===E?'height':'width',P=w[E],x=P+_[C],L=P-_[k],U=p?-R[D]/2:0,G=m===Cn?I[D]:R[D],W=m===Cn?-R[D]:-I[D],j=t.elements.arrow,M=p&&j?Jn(j):{width:0,height:0},B=t.modifiersData['arrow#persistent']?t.modifiersData['arrow#persistent'].padding:{top:0,right:0,bottom:0,left:0},V=B[C],H=B[k],F=rr(0,I[D],M[D]),z=y?I[D]/2-U-F-V-O.mainAxis:G-F-V-O.mainAxis,Y=y?-I[D]/2+U+F+H+O.mainAxis:W+F+H+O.mainAxis,K=t.elements.arrow&&tr(t.elements.arrow),J=K?'y'===E?K.clientTop||0:K.clientLeft||0:0,Z=null!=(N=null==S?void 0:S[E])?N:0,X=P+Y-Z,$=rr(p?zn(x,P+z-Z-J):x,P,p?Fn(L,X):L);w[E]=$,A[E]=$-P}if(s){var q,Q='x'===E?Rn:Sn,ee='x'===E?Tn:On,te=w[b],ne='y'===b?'height':'width',re=te+_[Q],ie=te-_[ee],oe=-1!==[Rn,Sn].indexOf(v),ae=null!=(q=null==S?void 0:S[b])?q:0,se=oe?re:te-I[ne]-R[ne]-ae+O.altAxis,ce=oe?te+I[ne]+R[ne]-ae-O.altAxis:ie,ue=p&&oe?function(e,t,n){var r=rr(e,t,n);return r>n?n:r}(se,te,ce):rr(p?se:re,te,p?ce:ie);w[b]=ue,A[b]=ue-te}t.modifiersData[r]=A}},requiresIfExists:['offset']};function kr(e,t,n){void 0===n&&(n=!1);var r,i,o=Mn(t),a=Mn(t)&&function(e){var t=e.getBoundingClientRect(),n=Yn(t.width)/e.offsetWidth||1,r=Yn(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),s=qn(t),c=Kn(e,a),u={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(o||!o&&!n)&&(('body'!==Gn(t)||vr(s))&&(u=(r=t)!==Wn(r)&&Mn(r)?{scrollLeft:(i=r).scrollLeft,scrollTop:i.scrollTop}:gr(r)),Mn(t)?((l=Kn(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=_r(s))),{x:c.left+u.scrollLeft-l.x,y:c.top+u.scrollTop-l.y,width:c.width,height:c.height}}function Dr(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||i(e)})),r}function Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return[].concat(n).reduce((function(e,t){return e.replace(/%s/,t)}),e)}var xr='Popper: modifier "%s" provided an invalid %s property, expected %s but got %s',Lr=['name','enabled','phase','fn','effect','requires','options'];var Ur='Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.',Gr={placement:'bottom',modifiers:[],strategy:'absolute'};function Wr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&'function'==typeof e.getBoundingClientRect)}))}function jr(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,i=t.defaultOptions,o=void 0===i?Gr:i;return function(e,t,n){void 0===n&&(n=o);var i,a,s={placement:'bottom',orderedModifiers:[],options:Object.assign({},Gr,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},c=[],u=!1,l={state:s,setOptions:function(n){var i='function'==typeof n?n(s.options):n;d(),s.options=Object.assign({},o,s.options,i),s.scrollParents={reference:jn(e)?yr(e):e.contextElement?yr(e.contextElement):[],popper:yr(t)};var a,u,h,p=function(e){var t=Dr(e);return Un.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,s.options.modifiers)));if(s.orderedModifiers=p.filter((function(e){return e.enabled})),'production'!==process.env.NODE_ENV){if(function(e){e.forEach((function(t){[].concat(Object.keys(t),Lr).filter((function(e,t,n){return n.indexOf(e)===t})).forEach((function(n){switch(n){case'name':'string'!=typeof t.name&&console.error(Pr(xr,String(t.name),'"name"','"string"','"'+String(t.name)+'"'));break;case'enabled':'boolean'!=typeof t.enabled&&console.error(Pr(xr,t.name,'"enabled"','"boolean"','"'+String(t.enabled)+'"'));break;case'phase':Un.indexOf(t.phase)<0&&console.error(Pr(xr,t.name,'"phase"','either '+Un.join(', '),'"'+String(t.phase)+'"'));break;case'fn':'function'!=typeof t.fn&&console.error(Pr(xr,t.name,'"fn"','"function"','"'+String(t.fn)+'"'));break;case'effect':null!=t.effect&&'function'!=typeof t.effect&&console.error(Pr(xr,t.name,'"effect"','"function"','"'+String(t.fn)+'"'));break;case'requires':null==t.requires||Array.isArray(t.requires)||console.error(Pr(xr,t.name,'"requires"','"array"','"'+String(t.requires)+'"'));break;case'requiresIfExists':Array.isArray(t.requiresIfExists)||console.error(Pr(xr,t.name,'"requiresIfExists"','"array"','"'+String(t.requiresIfExists)+'"'));break;case'options':case'data':break;default:console.error('PopperJS: an invalid property has been provided to the "'+t.name+'" modifier, valid properties are '+Lr.map((function(e){return'"'+e+'"'})).join(', ')+'; but "'+n+'" was provided.')}t.requires&&t.requires.forEach((function(n){null==e.find((function(e){return e.name===n}))&&console.error(Pr('Popper: modifier "%s" requires "%s", but "%s" modifier is not available',String(t.name),n,n))}))}))}))}((a=[].concat(p,s.options.modifiers),u=function(e){return e.name},h=new Set,a.filter((function(e){var t=u(e);if(!h.has(t))return h.add(t),!0})))),Hn(s.options.placement)===An)s.orderedModifiers.find((function(e){return'flip'===e.name}))||console.error(['Popper: "auto" placements require the "flip" modifier be','present and enabled to work.'].join(' '));var f=Xn(t);[f.marginTop,f.marginRight,f.marginBottom,f.marginLeft].some((function(e){return parseFloat(e)}))&&console.warn(['Popper: CSS "margin" styles cannot be used to apply padding','between the popper and its reference element or boundary.','To replicate margin, use the `offset` modifier, as well as','the `padding` option in the `preventOverflow` and `flip`','modifiers.'].join(' '))}return s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,i=e.effect;if('function'==typeof i){var o=i({state:s,name:t,instance:l,options:r}),a=function(){};c.push(o||a)}})),l.update()},forceUpdate:function(){if(!u){var e=s.elements,t=e.reference,n=e.popper;if(Wr(t,n)){s.rects={reference:kr(t,tr(n),'fixed'===s.options.strategy),popper:Jn(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0,i=0;i<s.orderedModifiers.length;i++){if('production'!==process.env.NODE_ENV&&(r+=1)>100){console.error('Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.');break}if(!0!==s.reset){var o=s.orderedModifiers[i],a=o.fn,c=o.options,d=void 0===c?{}:c,h=o.name;'function'==typeof a&&(s=a({state:s,options:d,name:h,instance:l})||s)}else s.reset=!1,i=-1}}else'production'!==process.env.NODE_ENV&&console.error(Ur)}},update:(i=function(){return new Promise((function(e){l.forceUpdate(),e(s)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(i())}))}))),a}),destroy:function(){d(),u=!0}};if(!Wr(e,t))return'production'!==process.env.NODE_ENV&&console.error(Ur),l;function d(){c.forEach((function(e){return e()})),c=[]}return l.setOptions(n).then((function(e){!u&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var Mr=jr({defaultModifiers:[{name:'eventListeners',enabled:!0,phase:'write',fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,o=void 0===i||i,a=r.resize,s=void 0===a||a,c=Wn(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&u.forEach((function(e){e.addEventListener('scroll',n.update,lr)})),s&&c.addEventListener('resize',n.update,lr),function(){o&&u.forEach((function(e){e.removeEventListener('scroll',n.update,lr)})),s&&c.removeEventListener('resize',n.update,lr)}},data:{}},{name:'popperOffsets',enabled:!0,phase:'read',fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=Ir({reference:t.rects.reference,element:t.rects.popper,strategy:'absolute',placement:t.placement})},data:{}},{name:'computeStyles',enabled:!0,phase:'beforeWrite',fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,o=n.adaptive,a=void 0===o||o,s=n.roundOffsets,c=void 0===s||s;if('production'!==process.env.NODE_ENV){var u=Xn(t.elements.popper).transitionProperty||'';a&&['transform','top','right','bottom','left'].some((function(e){return u.indexOf(e)>=0}))&&console.warn(['Popper: Detected CSS transitions on at least one of the following','CSS properties: "transform", "top", "right", "bottom", "left".','\n\n','Disable the "computeStyles" modifier\'s `adaptive` option to allow','for smooth transitions, or remove these properties from the CSS','transition declaration on the popper element if only transitioning','opacity or background-color for example.','\n\n','We recommend using the popper element as a wrapper around an inner','element that can have any CSS property transitioned for animations.'].join(' '))}var l={placement:Hn(t.placement),variation:sr(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:'fixed'===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ur(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ur(Object.assign({},l,{offsets:t.modifiersData.arrow,position:'absolute',adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{'data-popper-placement':t.placement})},data:{}},Vn,Nr,Or,Cr,ar,{name:'hide',enabled:!0,phase:'main',requiresIfExists:['preventOverflow'],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,a=Rr(t,{elementContext:'reference'}),s=Rr(t,{altBoundary:!0}),c=Sr(a,r),u=Sr(s,i,o),l=Ar(c),d=Ar(u);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:l,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{'data-popper-reference-hidden':l,'data-popper-escaped':d})}}]});window.process={env:{NODE_ENV:'production'}};var Br=function(e){s(f,e);var t,i,u,l,d,h=g(f);function f(e){var t;return r(this,f),a(p(t=h.call(this,e)),'_lightbox',void 0),a(p(t),'_popper',void 0),t._lightbox=new ht,t}return o(f,[{key:'_destroy',value:function(){this._widget.trigger.destroy(),v(c(f.prototype),'_destroy',this).call(this)}},{key:'render',value:(d=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleFirstTimeLoading();case 2:return e.abrupt('return',v(c(f.prototype),'render',this).call(this,t));case 3:case'end':return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:'handleFirstTimeLoading',value:(l=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this._widget.getLastPublicationSeen().size){e.next=15;break}return e.next=4,this._widget.getWidgetData();case 4:if(!((t=e.sent).widgetViewSettings.firstVisitUnreadUnseenCount>=0)){e.next=15;break}if(!(t.widgetViewSettings.firstVisitUnreadUnseenCount<t.widgetViewSettings.maxPublicationCount)){e.next=15;break}return e.next=10,this._widget.getPublicationData();case 10:for(n=e.sent,r=new ve,i=n.length-1;i>=t.widgetViewSettings.firstVisitUnreadUnseenCount;i--)o=n[i],r.add(o.id);return e.next=15,this._widget.identity.setLastPublicationReadSeen(this._widget.projectId,new ve(r.toArray()),new ve(r.toArray()),!0,!0,!0);case 15:return e.next=17,this._widget.getPublicationState();case 17:a=e.sent,this._widget.eventRegistry.dispatchEvent(this._widget.id,R.WIDGET_PUBLICATION_UNREAD_COUNT_CHANGED,{value:a.unreadCount}),this._widget.eventRegistry.dispatchEvent(this._widget.id,R.WIDGET_PUBLICATION_UNSEEN_COUNT_CHANGED,{value:a.unseenCount});case 20:case'end':return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:'_render',value:(u=n(regeneratorRuntime.mark((function e(t){var n,r,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._widget.trigger.render({root:null==t?void 0:t.root,selector:null==t?void 0:t.selector}),this._element.src='https://widgets.noticeable.io/popup/index.html',this._element.style.boxShadow='rgba(0, 0, 0, 0.16) 0 5px 40px',this._element.style.position='fixed',this._zIndex='2147482999',document.body.appendChild(this._element),e.next=8,v(c(f.prototype),'_render',this).call(this,t);case 8:return this._childConnection=ct({iframe:this._element,methods:{close:function(){return o._widget.close()},dispatchEvent:function(e,t){return o.dispatchEvent(e,t)},getLastPublicationRead:function(){return o._widget.getLastPublicationRead()},getWidgetId:function(){return o._widget.id},getWindowLocationHref:function(){return window.location.href},openUrl:function(e,t){window.open(e,t)},setPublicationRead:function(e){return o._widget.setPublicationRead([e],{merge:!0})},setPublicationSeen:function(e){return o._widget.setPublicationSeen([e],{merge:!0})},zoom:function(e,t){return o._lightbox.open(e,t)}}}),e.next=11,this._childConnection.promise;case 11:return this._child=e.sent,e.next=14,this.refresh();case 14:return i=e.sent,e.next=17,r;case 17:return null===(n=this._popper)||void 0===n||n.forceUpdate(),e.abrupt('return',i);case 19:case'end':return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:'_refresh',value:(i=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d,h,p,f,g,_,v,m,y,E,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this._widget.getProjectData(),c=this._widget.getPublicationData(),u=this._widget.getWidgetData(),l=L(),e.next=6,s;case 6:return d=e.sent,e.next=9,c;case 9:return h=e.sent,e.next=12,u;case 12:if(p=e.sent,null===(t=this._child)||void 0===t||t.refresh(d,h,p.widgetViewSettings,l),f=p.triggerView,this._backdrop=null!==(n=p.widgetViewSettings.backdrop)&&void 0!==n&&n,this._backdropClickable=null!==(r=p.widgetViewSettings.backdropClickable)&&void 0!==r&&r,this._backdrop?(this._backdropElement.style.background=null!==(g=p.widgetViewSettings.backdropColor)&&void 0!==g?g:'#00000099',this._widget.opened&&!this._backdropElement.isConnected?document.body.prepend(this._backdropElement):!this._widget.opened&&this._backdropElement.isConnected&&this._backdropElement.remove()):this._backdropElement.isConnected&&this._backdropElement.remove(),this._element.style.borderRadius=G(null!==(i=p.widgetViewSettings.borderRadius)&&void 0!==i?i:8),this._element.style.height=G(null!==(o=p.widgetViewSettings.height)&&void 0!==o?o:520),this._element.style.width=G(null!==(a=p.widgetViewSettings.width)&&void 0!==a?a:420),_=null==p?void 0:p.triggerViewSettings,v=null==_?void 0:_.placement,_&&U(d.language)&&(v=_.placement===an.BOTTOM_END?an.BOTTOM_START:an.BOTTOM_END),!l){e.next=37;break}this._popper&&(this._popper.destroy(),this._popper=void 0),this._element.style.width='100%',this._element.style.borderRadius=G(0),this._element.style.bottom=G(0),this._element.style.height='100%',this._element.style.left=G(0),this._element.style.position='fixed',this._element.style.right=G(0),this._element.style.top=G(0),this._element.style.transform='none',e.next=50;break;case 37:if(bn.BADGE!==f&&bn.CUSTOM!==f&&bn.ICON!==f){e.next=49;break}if(m=this._widget.trigger.view.element,bn.BADGE===f&&(m=this._widget.trigger.view.container),y={modifiers:[{name:'offset',options:{offset:function(){return[p.widgetViewSettings.horizontalOffset,p.widgetViewSettings.verticalOffset]}}}],placement:p.widgetViewSettings.placement},this._popper){e.next=45;break}this._popper=Mr(m,this._element,y),e.next=47;break;case 45:return e.next=47,this._popper.setOptions(y);case 47:e.next=50;break;case 49:bn.FLOATING_BUTTON===f&&(this._element.style.bottom=G(82+p.widgetViewSettings.verticalOffset),this._element.style.left=v===an.BOTTOM_END?'unset':G(null!==(E=(null==_?void 0:_.horizontalOffset)+p.widgetViewSettings.horizontalOffset)&&void 0!==E?E:20),this._element.style.overflow='hidden',this._element.style.right=v===an.BOTTOM_START?'unset':G(null!==(b=(null==_?void 0:_.horizontalOffset)+p.widgetViewSettings.horizontalOffset)&&void 0!==b?b:20),this._element.style.top='unset');case 50:return e.abrupt('return',{publications:h});case 51:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'_show',value:(t=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._widget.getPublicationData();case 2:return t=e.sent,e.next=5,v(c(f.prototype),'_show',this).call(this);case 5:return e.next=7,this.refresh();case 7:return e.abrupt('return',this._widget.setPublicationSeen(t.map((function(e){return e.id})),{merge:!0}));case 8:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),f}(mt),Vr=function(e){s(h,e);var t,i,u,l,d=g(h);function h(e){var t;return r(this,h),a(p(t=d.call(this,e)),'_displayAfterTimeout',void 0),t._element.style.display='none',t}return o(h,[{key:'publicationFetchLimit',get:function(){return 1}},{key:'segmentsOperator',get:function(){return'and'}},{key:'_destroy',value:function(){v(c(h.prototype),'_destroy',this).call(this),this._displayAfterTimeout&&(clearTimeout(this._displayAfterTimeout),this._displayAfterTimeout=void 0)}},{key:'_hide',value:(l=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._element.style.display='none',e.abrupt('return',v(c(h.prototype),'_hide',this).call(this));case 2:case'end':return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:'_render',value:(u=n(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._element.height='0',this._element.src='https://widgets.noticeable.io/top-banner/index.html',this._element.width='100%',e.next=5,this._widget.getWidgetData();case 5:return'bottom'===(n=e.sent).widgetViewSettings.position?(this._element.style.bottom='0',this._element.style.position='relative',this._element.style.top='unset',document.body.appendChild(this._element)):'bottom-sticky'===n.widgetViewSettings.position?(this._element.style.bottom='0',this._element.style.position='sticky',this._element.style.top='unset',this._element.style.zIndex='2147483646',document.body.appendChild(this._element)):'top'===n.widgetViewSettings.position?(this._element.style.bottom='unset',this._element.style.position='relative',this._element.style.top='0',document.body.insertBefore(this._element,document.body.firstChild)):(this._element.style.bottom='unset',this._element.style.position='sticky',this._element.style.top='0',this._element.style.zIndex='2147483646',document.body.insertBefore(this._element,document.body.firstChild)),e.next=9,v(c(h.prototype),'_render',this).call(this,t);case 9:return this._childConnection=ct({iframe:this._element,methods:{closeAndMarkPublicationRead:function(e){r._widget.setPublicationRead([e],{merge:!0}),r._widget.close()},dispatchEvent:function(e,t){return r.dispatchEvent(e,t)},getWidgetId:function(){return r._widget.id},getWindowLocationHref:function(){return window.location.href},openUrl:function(e,t){window.open(e,t)},setHeight:function(e){return r._element.height=e?G(e):'0'},setPublicationSeenAndRead:function(e){return Promise.allSettled([r._widget.setPublicationSeen([e],{merge:!0}),r._widget.setPublicationRead([e],{merge:!0})])}}}),e.next=12,this._childConnection.promise;case 12:return this._child=e.sent,e.abrupt('return',this.refresh());case 14:case'end':return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:'_refresh',value:(i=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._widget.getProjectData(),r=this._widget.getPublicationData(),i=this._widget.getWidgetData(),o=L(),e.next=6,n;case 6:return a=e.sent,e.next=9,r;case 9:return s=e.sent,e.next=12,i;case 12:return c=e.sent,e.next=15,null===(t=this._child)||void 0===t?void 0:t.refresh(a,s,c.widgetViewSettings,o);case 15:if(u=c.widgetViewSettings.displayAfter,s&&!(s.length<=0)){e.next=19;break}return A.info('Widget '.concat(this._widget.id,' not opening because there are no publications to display')),e.abrupt('return');case 19:if(l=s[0].id,this._widget.getLastPublicationRead().has(l)||!c.widgetViewSettings.mobile&&L()){e.next=29;break}if(this._widget.opened){e.next=27;break}if(!(u<=0)){e.next=26;break}return e.abrupt('return',this._widget.open());case 26:this._displayAfterTimeout=setTimeout((function(){return d._widget.open()}),u);case 27:e.next=31;break;case 29:return e.next=31,this._widget.close();case 31:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'_show',value:(t=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._widget.getPublicationData();case 2:return t=e.sent,this._element.style.display='block',e.next=6,v(c(h.prototype),'_show',this).call(this);case 6:return e.abrupt('return',this._widget.setPublicationSeen([t[0].id],{merge:!0}));case 7:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),h}(mt),Hr=function(e){s(h,e);var t,i,u,l,d=g(h);function h(e){var t;return r(this,h),a(p(t=d.call(this,e)),'_container',void 0),a(p(t),'_containerOldStyles',void 0),t._clickListener=function(){t.dispatchEvent(R.WIDGET_TRIGGER_VIEW_CLICKED),t._trigger.widget.toggle()},t}return o(h,[{key:'container',get:function(){return this._container}},{key:'_destroy',value:function(){this._container&&(this._containerOldStyles&&(this._container.style.cursor=this._containerOldStyles.cursor,this._container.style.display=this._containerOldStyles.display,this._container.style.paddingLeft=this._containerOldStyles.paddingLeft,this._container.style.paddingRight=this._containerOldStyles.paddingRight,this._container.style.position=this._containerOldStyles.position,this._container.style.userSelect=this._containerOldStyles.userSelect,this._containerOldStyles=void 0),this._container=void 0)}},{key:'_render',value:(l=n(regeneratorRuntime.mark((function e(t){var n,r,i,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._trigger.getSettings();case 2:return i=e.sent,o=null!==(n=null!==(r=t.selector)&&void 0!==r?r:i.selector)&&void 0!==n?n:bt,this._container=wt(o,t.root),this._container.addEventListener('click',this._clickListener),this._container.classList.remove('noticeable-badge_visible'),this._containerOldStyles={cursor:this._container.style.cursor,display:this._container.style.display,paddingLeft:this._container.style.paddingLeft,paddingRight:this._container.style.paddingRight,position:this._container.style.position,userSelect:this._container.style.userSelect},this._container.style.cursor='pointer',this._container.style.display='inline-block',this._container.style.position='relative',this._container.style.userSelect='none',this._element.src='https://widgets.noticeable.io/triggers/badge/index.html',this._element.height='0',this._element.width='0','start'===i.placement?this._container.prepend(this._element):this._container.appendChild(this._element),this._childConnection=ct({iframe:this._element,methods:{getWidgetId:function(){return a._trigger.widget.id},getWindowLocationHref:function(){return window.location.href},toggle:function(){return a._trigger.widget.toggle()}}}),e.next=19,this._childConnection.promise;case 19:return this._child=e.sent,e.next=22,this.refresh();case 22:case'end':return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:'_refresh',value:(u=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d,h,p,f,g,_,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this._trigger.widget.getProjectLanguage(),a=this._trigger.getPublicationState(),s=this._trigger.getSettings(),c=getComputedStyle(this._container),u=parseFloat(null!==(t=null===(n=c.fontSize)||void 0===n?void 0:n.replace('px',''))&&void 0!==t?t:16),l=Math.round(u+.25*u),e.next=8,o;case 8:return d=e.sent,e.next=11,s;case 11:h=e.sent,p=h.placement,U(d)&&(p=h.placement===nn.START?nn.END:nn.START),f=null!==(r=h.horizontalOffset)&&void 0!==r?r:0,this._element.style.bottom='0',this._element.style.margin='auto 0',this._element.style.position='absolute',this._element.style.top='0',g=this._container,e.t0=h.animation,e.next=e.t0===en.BOUNCE?23:e.t0===en.PULSE?29:e.t0===en.NONE?35:e.t0===en.SHAKE?39:43;break;case 23:return _=Math.ceil(.2*l),v=2*(6+.2*(l+6)),this._element.height=l+v+'px',this._element.width=l+_+'px',p===nn.END?(this._element.style.left='unset',this._element.style.right='0',g.style.paddingLeft=this._containerOldStyles.paddingLeft,g.style.paddingRight=f+l+_+this._containerOldStyles.paddingRight+'px'):p===nn.START&&(this._element.style.left='0',this._element.style.right='unset',g.style.paddingLeft=f+l+_+this._containerOldStyles.paddingLeft+'px',g.style.paddingRight=this._containerOldStyles.paddingRight),e.abrupt('break',43);case 29:return _=Math.ceil(1.5*l),v=Math.ceil(1.5*l),this._element.height=l+v+'px',this._element.width=l+_+'px',p===nn.END?(this._element.style.left='unset',this._element.style.right='0',g.style.paddingLeft=this._containerOldStyles.paddingLeft,g.style.paddingRight=f+l+_/2+this._containerOldStyles.paddingRight+'px'):p===nn.START&&(this._element.style.left='0',this._element.style.right='unset',g.style.paddingLeft=f+l+_/2+this._containerOldStyles.paddingLeft+'px',g.style.paddingRight=this._containerOldStyles.paddingRight),e.abrupt('break',43);case 35:return this._element.height=l+'px',this._element.width=l+'px',p===nn.END?(this._element.style.left='unset',this._element.style.right='0',g.style.paddingLeft=this._containerOldStyles.paddingLeft,g.style.paddingRight=f+l+this._containerOldStyles.paddingRight+'px'):p===nn.START&&(this._element.style.left='0',this._element.style.right='unset',g.style.paddingLeft=f+l+this._containerOldStyles.paddingLeft+'px',g.style.paddingRight=this._containerOldStyles.paddingRight),e.abrupt('break',43);case 39:return this._element.height=l+'px',this._element.width=l+6+'px',p===nn.END?(this._element.style.left='unset',this._element.style.right='0',g.style.paddingLeft=this._containerOldStyles.paddingLeft,g.style.paddingRight=f+l+6+this._containerOldStyles.paddingRight+'px'):p===nn.START&&(this._element.style.left='0',this._element.style.right='unset',g.style.paddingLeft=f+l+6+this._containerOldStyles.paddingLeft+'px',g.style.paddingRight=this._containerOldStyles.paddingRight),e.abrupt('break',43);case 43:return h.fontSize=u,h.size=l,e.next=47,a;case 47:if(m=e.sent,h.hideBehavior!==En.WHEN_ALL_READ||0!==m.unreadCount){e.next=53;break}return e.next=51,this.hide();case 51:case 56:e.next=60;break;case 53:if(h.hideBehavior!==En.WHEN_ALL_SEEN||0!==m.unseenCount){e.next=58;break}return e.next=56,this.hide();case 58:return e.next=60,this.show();case 60:return e.next=62,null===(i=this._child)||void 0===i?void 0:i.refresh(h,m,d);case 62:if(this.setBadgeVisibilityClass(),!m.openWidgets){e.next=65;break}return e.abrupt('return',this._trigger.widget.open());case 65:case'end':return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:'setBadgeVisibilityClass',value:function(){var e,t=null===(e=this._container)||void 0===e?void 0:e.classList;t&&(this._visible?(null==t||t.add('noticeable-badge_visible'),null==t||t.remove('noticeable-badge_hidden')):(null==t||t.add('noticeable-badge_hidden'),null==t||t.remove('noticeable-badge_visible')))}},{key:'_hide',value:(i=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(c(h.prototype),'_hide',this).call(this);case 2:this.setBadgeVisibilityClass();case 3:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'_show',value:(t=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(c(h.prototype),'_show',this).call(this);case 2:this.setBadgeVisibilityClass();case 3:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),h}(gt),Fr=function(e){s(c,e);var t,i,a=g(c);function c(e){var t;return r(this,c),t=a.call(this,e,document.createElement('div'),(function(){t._trigger.eventRegistry.hasListener(t._trigger.widget.id,R.WIDGET_TRIGGER_VIEW_CLICKED)?t.dispatchEvent(R.WIDGET_TRIGGER_VIEW_CLICKED):t._trigger.widget.toggle()}),(function(){return t.dispatchEvent(R.WIDGET_TRIGGER_VIEW_MOUSE_ENTERED)}),(function(){return t.dispatchEvent(R.WIDGET_TRIGGER_VIEW_MOUSE_LEFT)}))}return o(c,[{key:'_destroy',value:function(){var e;null===(e=this._element)||void 0===e||e.removeEventListener('click',this._clickListener)}},{key:'_render',value:(i=n(regeneratorRuntime.mark((function e(t){var n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._trigger.getSettings();case 2:return i=e.sent,o=null!==(n=null!==(r=t.selector)&&void 0!==r?r:i.selector)&&void 0!==n?n:bt,this._element=wt(o,t.root),this._element.addEventListener('click',this._clickListener),e.abrupt('return',{});case 7:case'end':return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:'_refresh',value:(t=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._trigger.getPublicationState();case 2:if(!e.sent.openWidgets){e.next=6;break}return e.next=6,this._trigger.widget.open();case 6:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),c}(ft),zr=function(e){s(c,e);var t,i,a=g(c);function c(){return r(this,c),a.apply(this,arguments)}return o(c,[{key:'_render',value:(i=n(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._element.src='https://widgets.noticeable.io/triggers/floating-button/index.html',this._element.style.height='124px',this._element.style.position='fixed',this._element.style.width='124px',this._element.style.zIndex='2147483000',document.body.appendChild(this._element),this._childConnection=ct({iframe:this._element,methods:{getWidgetId:function(){return n._trigger.widget.id},getWindowLocationHref:function(){return window.location.href},toggle:function(){return n._trigger.widget.toggle()}}}),e.next=9,this._childConnection.promise;case 9:return this._child=e.sent,e.next=12,this.refresh();case 12:case'end':return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:'_refresh',value:(t=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._trigger.widget.getProjectLanguage(),o=this._trigger.getSettings(),a=this._trigger.widget.getWidgetData(),e.next=5,a;case 5:return e.sent.widgetViewSettings.mobile?this._element.style.zIndex='2147482999':this._element.style.zIndex='2147483000',e.next=9,i;case 9:return s=e.sent,e.next=12,o;case 12:return c=e.sent,u=null==c?void 0:c.placement,U(s)&&(u=(null==c?void 0:c.placement)===an.BOTTOM_START?an.BOTTOM_END:an.BOTTOM_START),this._element.style.bottom=null!=c&&c.verticalOffset?G(-32+c.verticalOffset):G(-32),this._element.style.left=u===an.BOTTOM_START?G(-32+(null!==(t=null==c?void 0:c.horizontalOffset)&&void 0!==t?t:20)):'unset',this._element.style.right=u===an.BOTTOM_END?G(-32+(null!==(n=null==c?void 0:c.horizontalOffset)&&void 0!==n?n:20)):'unset',e.next=20,this._trigger.getPublicationState();case 20:if(l=e.sent,c.hideBehavior!==En.WHEN_ALL_READ||0!==l.unreadCount){e.next=26;break}return e.next=24,this.hide();case 24:case 29:e.next=33;break;case 26:if(c.hideBehavior!==En.WHEN_ALL_SEEN||0!==l.unseenCount){e.next=31;break}return e.next=29,this.hide();case 31:return e.next=33,this.show();case 33:return e.next=35,null===(r=this._child)||void 0===r?void 0:r.refresh(c,l,s);case 35:if(!l.openWidgets){e.next=38;break}return e.next=38,this._trigger.widget.open();case 38:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),c}(gt),Yr='object'==typeof global&&global&&global.Object===Object&&global,Kr='object'==typeof self&&self&&self.Object===Object&&self,Jr=Yr||Kr||Function('return this')(),Zr=Jr.Symbol,Xr=Object.prototype,$r=Xr.hasOwnProperty,qr=Xr.toString,Qr=Zr?Zr.toStringTag:void 0;var ei=Object.prototype.toString;var ti=Zr?Zr.toStringTag:void 0;function ni(e){return null==e?void 0===e?'[object Undefined]':'[object Null]':ti&&ti in Object(e)?function(e){var t=$r.call(e,Qr),n=e[Qr];try{e[Qr]=void 0;var r=!0}catch(e){}var i=qr.call(e);return r&&(t?e[Qr]=n:delete e[Qr]),i}(e):function(e){return ei.call(e)}(e)}function ri(e){return null!=e&&'object'==typeof e}var ii=Array.isArray;function oi(e){var t=typeof e;return null!=e&&('object'==t||'function'==t)}function ai(e){return e}function si(e){if(!oi(e))return!1;var t=ni(e);return'[object Function]'==t||'[object GeneratorFunction]'==t||'[object AsyncFunction]'==t||'[object Proxy]'==t}var ci,ui=Jr['__core-js_shared__'],li=(ci=/[^.]+$/.exec(ui&&ui.keys&&ui.keys.IE_PROTO||''))?'Symbol(src)_1.'+ci:'';var di=Function.prototype.toString;function hi(e){if(null!=e){try{return di.call(e)}catch(e){}try{return e+''}catch(e){}}return''}var pi=/^\[object .+?Constructor\]$/,fi=Function.prototype,gi=Object.prototype,_i=fi.toString,vi=gi.hasOwnProperty,mi=RegExp('^'+_i.call(vi).replace(/[\\^$.*+?()[\]{}|]/g,'\\$&').replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,'$1.*?')+'$');function yi(e){return!(!oi(e)||(t=e,li&&li in t))&&(si(e)?mi:pi).test(hi(e));var t}function Ei(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return yi(n)?n:void 0}var bi=Ei(Jr,'WeakMap'),wi=Object.create,Ii=function(){function e(){}return function(t){if(!oi(t))return{};if(wi)return wi(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Ri(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Ti(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Oi=Date.now;var Si,Ai,Ni,Ci=function(){try{var e=Ei(Object,'defineProperty');return e({},'',{}),e}catch(e){}}(),ki=Ci,Di=ki?function(e,t){return ki(e,'toString',{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:ai,Pi=(Si=Di,Ai=0,Ni=0,function(){var e=Oi(),t=16-(e-Ni);if(Ni=e,t>0){if(++Ai>=800)return arguments[0]}else Ai=0;return Si.apply(void 0,arguments)}),xi=Pi;var Li=/^(?:0|[1-9]\d*)$/;function Ui(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&('number'==n||'symbol'!=n&&Li.test(e))&&e>-1&&e%1==0&&e<t}function Gi(e,t,n){'__proto__'==t&&ki?ki(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Wi(e,t){return e===t||e!=e&&t!=t}var ji=Object.prototype.hasOwnProperty;function Mi(e,t,n){var r=e[t];ji.call(e,t)&&Wi(r,n)&&(void 0!==n||t in e)||Gi(e,t,n)}function Bi(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?Gi(n,s,c):Mi(n,s,c)}return n}var Vi=Math.max;function Hi(e,t){return xi(function(e,t,n){return t=Vi(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Vi(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),Ri(e,this,s)}}(e,t,ai),e+'')}function Fi(e){return'number'==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function zi(e){return null!=e&&Fi(e.length)&&!si(e)}var Yi=Object.prototype;function Ki(e){var t=e&&e.constructor;return e===('function'==typeof t&&t.prototype||Yi)}function Ji(e){return ri(e)&&'[object Arguments]'==ni(e)}var Zi=Object.prototype,Xi=Zi.hasOwnProperty,$i=Zi.propertyIsEnumerable,qi=Ji(function(){return arguments}())?Ji:function(e){return ri(e)&&Xi.call(e,'callee')&&!$i.call(e,'callee')},Qi=qi;var eo='object'==typeof exports&&exports&&!exports.nodeType&&exports,to=eo&&'object'==typeof module&&module&&!module.nodeType&&module,no=to&&to.exports===eo?Jr.Buffer:void 0,ro=(no?no.isBuffer:void 0)||function(){return!1},io={};function oo(e){return function(t){return e(t)}}io['[object Float32Array]']=io['[object Float64Array]']=io['[object Int8Array]']=io['[object Int16Array]']=io['[object Int32Array]']=io['[object Uint8Array]']=io['[object Uint8ClampedArray]']=io['[object Uint16Array]']=io['[object Uint32Array]']=!0,io['[object Arguments]']=io['[object Array]']=io['[object ArrayBuffer]']=io['[object Boolean]']=io['[object DataView]']=io['[object Date]']=io['[object Error]']=io['[object Function]']=io['[object Map]']=io['[object Number]']=io['[object Object]']=io['[object RegExp]']=io['[object Set]']=io['[object String]']=io['[object WeakMap]']=!1;var ao='object'==typeof exports&&exports&&!exports.nodeType&&exports,so=ao&&'object'==typeof module&&module&&!module.nodeType&&module,co=so&&so.exports===ao&&Yr.process,uo=function(){try{var e=so&&so.require&&so.require('util').types;return e||co&&co.binding&&co.binding('util')}catch(e){}}(),lo=uo&&uo.isTypedArray,ho=lo?oo(lo):function(e){return ri(e)&&Fi(e.length)&&!!io[ni(e)]},po=Object.prototype.hasOwnProperty;function fo(e,t){var n=ii(e),r=!n&&Qi(e),i=!n&&!r&&ro(e),o=!n&&!r&&!i&&ho(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var u in e)!t&&!po.call(e,u)||a&&('length'==u||i&&('offset'==u||'parent'==u)||o&&('buffer'==u||'byteLength'==u||'byteOffset'==u)||Ui(u,c))||s.push(u);return s}function go(e,t){return function(n){return e(t(n))}}var _o=go(Object.keys,Object),vo=Object.prototype.hasOwnProperty;function mo(e){return zi(e)?fo(e):function(e){if(!Ki(e))return _o(e);var t=[];for(var n in Object(e))vo.call(e,n)&&'constructor'!=n&&t.push(n);return t}(e)}var yo=Object.prototype.hasOwnProperty;function Eo(e){if(!oi(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Ki(e),n=[];for(var r in e)('constructor'!=r||!t&&yo.call(e,r))&&n.push(r);return n}function bo(e){return zi(e)?fo(e,!0):Eo(e)}var wo=Ei(Object,'create');var Io=Object.prototype.hasOwnProperty;var Ro=Object.prototype.hasOwnProperty;function To(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Oo(e,t){for(var n=e.length;n--;)if(Wi(e[n][0],t))return n;return-1}To.prototype.clear=function(){this.__data__=wo?wo(null):{},this.size=0},To.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},To.prototype.get=function(e){var t=this.__data__;if(wo){var n=t[e];return'__lodash_hash_undefined__'===n?void 0:n}return Io.call(t,e)?t[e]:void 0},To.prototype.has=function(e){var t=this.__data__;return wo?void 0!==t[e]:Ro.call(t,e)},To.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=wo&&void 0===t?'__lodash_hash_undefined__':t,this};var So=Array.prototype.splice;function Ao(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ao.prototype.clear=function(){this.__data__=[],this.size=0},Ao.prototype.delete=function(e){var t=this.__data__,n=Oo(t,e);return!(n<0)&&(n==t.length-1?t.pop():So.call(t,n,1),--this.size,!0)},Ao.prototype.get=function(e){var t=this.__data__,n=Oo(t,e);return n<0?void 0:t[n][1]},Ao.prototype.has=function(e){return Oo(this.__data__,e)>-1},Ao.prototype.set=function(e,t){var n=this.__data__,r=Oo(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var No=Ei(Jr,'Map');function Co(e,t){var n,r,i=e.__data__;return('string'==(r=typeof(n=t))||'number'==r||'symbol'==r||'boolean'==r?'__proto__'!==n:null===n)?i['string'==typeof t?'string':'hash']:i.map}function ko(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Do(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}ko.prototype.clear=function(){this.size=0,this.__data__={hash:new To,map:new(No||Ao),string:new To}},ko.prototype.delete=function(e){var t=Co(this,e).delete(e);return this.size-=t?1:0,t},ko.prototype.get=function(e){return Co(this,e).get(e)},ko.prototype.has=function(e){return Co(this,e).has(e)},ko.prototype.set=function(e,t){var n=Co(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var Po=go(Object.getPrototypeOf,Object),xo=Function.prototype,Lo=Object.prototype,Uo=xo.toString,Go=Lo.hasOwnProperty,Wo=Uo.call(Object);function jo(e){var t=this.__data__=new Ao(e);this.size=t.size}jo.prototype.clear=function(){this.__data__=new Ao,this.size=0},jo.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},jo.prototype.get=function(e){return this.__data__.get(e)},jo.prototype.has=function(e){return this.__data__.has(e)},jo.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ao){var r=n.__data__;if(!No||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ko(r)}return n.set(e,t),this.size=n.size,this};var Mo='object'==typeof exports&&exports&&!exports.nodeType&&exports,Bo=Mo&&'object'==typeof module&&module&&!module.nodeType&&module,Vo=Bo&&Bo.exports===Mo?Jr.Buffer:void 0,Ho=Vo?Vo.allocUnsafe:void 0;function Fo(e,t){if(t)return e.slice();var n=e.length,r=Ho?Ho(n):new e.constructor(n);return e.copy(r),r}function zo(){return[]}var Yo=Object.prototype.propertyIsEnumerable,Ko=Object.getOwnPropertySymbols,Jo=Ko?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}(Ko(e),(function(t){return Yo.call(e,t)})))}:zo;var Zo=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Do(t,Jo(e)),e=Po(e);return t}:zo;function Xo(e,t,n){var r=t(e);return ii(e)?r:Do(r,n(e))}function $o(e){return Xo(e,mo,Jo)}function qo(e){return Xo(e,bo,Zo)}var Qo=Ei(Jr,'DataView'),ea=Ei(Jr,'Promise'),ta=Ei(Jr,'Set'),na='[object Map]',ra='[object Promise]',ia='[object Set]',oa='[object WeakMap]',aa='[object DataView]',sa=hi(Qo),ca=hi(No),ua=hi(ea),la=hi(ta),da=hi(bi),ha=ni;(Qo&&ha(new Qo(new ArrayBuffer(1)))!=aa||No&&ha(new No)!=na||ea&&ha(ea.resolve())!=ra||ta&&ha(new ta)!=ia||bi&&ha(new bi)!=oa)&&(ha=function(e){var t=ni(e),n='[object Object]'==t?e.constructor:void 0,r=n?hi(n):'';if(r)switch(r){case sa:return aa;case ca:return na;case ua:return ra;case la:return ia;case da:return oa}return t});var pa=ha,fa=Object.prototype.hasOwnProperty;var ga=Jr.Uint8Array;function _a(e){var t=new e.constructor(e.byteLength);return new ga(t).set(new ga(e)),t}var va=/\w*$/;var ma=Zr?Zr.prototype:void 0,ya=ma?ma.valueOf:void 0;function Ea(e,t){var n=t?_a(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ba(e,t,n){var r,i,o,a=e.constructor;switch(t){case'[object ArrayBuffer]':return _a(e);case'[object Boolean]':case'[object Date]':return new a(+e);case'[object DataView]':return function(e,t){var n=t?_a(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case'[object Float32Array]':case'[object Float64Array]':case'[object Int8Array]':case'[object Int16Array]':case'[object Int32Array]':case'[object Uint8Array]':case'[object Uint8ClampedArray]':case'[object Uint16Array]':case'[object Uint32Array]':return Ea(e,n);case'[object Map]':case'[object Set]':return new a;case'[object Number]':case'[object String]':return new a(e);case'[object RegExp]':return(o=new(i=e).constructor(i.source,va.exec(i))).lastIndex=i.lastIndex,o;case'[object Symbol]':return r=e,ya?Object(ya.call(r)):{}}}function wa(e){return'function'!=typeof e.constructor||Ki(e)?{}:Ii(Po(e))}var Ia=uo&&uo.isMap,Ra=Ia?oo(Ia):function(e){return ri(e)&&'[object Map]'==pa(e)};var Ta=uo&&uo.isSet,Oa=Ta?oo(Ta):function(e){return ri(e)&&'[object Set]'==pa(e)},Sa='[object Arguments]',Aa='[object Function]',Na='[object Object]',Ca={};function ka(e,t,n,r,i,o){var a,s=1&t,c=2&t,u=4&t;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!oi(e))return e;var l=ii(e);if(l){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&'string'==typeof e[0]&&fa.call(e,'index')&&(n.index=e.index,n.input=e.input),n}(e),!s)return Ti(e,a)}else{var d=pa(e),h=d==Aa||'[object GeneratorFunction]'==d;if(ro(e))return Fo(e,s);if(d==Na||d==Sa||h&&!i){if(a=c||h?{}:wa(e),!s)return c?function(e,t){return Bi(e,Zo(e),t)}(e,function(e,t){return e&&Bi(t,bo(t),e)}(a,e)):function(e,t){return Bi(e,Jo(e),t)}(e,function(e,t){return e&&Bi(t,mo(t),e)}(a,e))}else{if(!Ca[d])return i?e:{};a=ba(e,d,s)}}o||(o=new jo);var p=o.get(e);if(p)return p;o.set(e,a),Oa(e)?e.forEach((function(r){a.add(ka(r,t,n,r,e,o))})):Ra(e)&&e.forEach((function(r,i){a.set(i,ka(r,t,n,i,e,o))}));var f=l?void 0:(u?c?qo:$o:c?bo:mo)(e);return function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););}(f||e,(function(r,i){f&&(r=e[i=r]),Mi(a,i,ka(r,t,n,i,e,o))})),a}Ca[Sa]=Ca['[object Array]']=Ca['[object ArrayBuffer]']=Ca['[object DataView]']=Ca['[object Boolean]']=Ca['[object Date]']=Ca['[object Float32Array]']=Ca['[object Float64Array]']=Ca['[object Int8Array]']=Ca['[object Int16Array]']=Ca['[object Int32Array]']=Ca['[object Map]']=Ca['[object Number]']=Ca[Na]=Ca['[object RegExp]']=Ca['[object Set]']=Ca['[object String]']=Ca['[object Symbol]']=Ca['[object Uint8Array]']=Ca['[object Uint8ClampedArray]']=Ca['[object Uint16Array]']=Ca['[object Uint32Array]']=!0,Ca['[object Error]']=Ca[Aa]=Ca['[object WeakMap]']=!1;function Da(e){return ka(e,5)}var Pa,xa=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[Pa?a:++r];if(!1===t(i[s],s,i))break}return e};function La(e,t,n){(void 0!==n&&!Wi(e[t],n)||void 0===n&&!(t in e))&&Gi(e,t,n)}function Ua(e,t){if(('constructor'!==t||'function'!=typeof e[t])&&'__proto__'!=t)return e[t]}function Ga(e,t,n,r,i,o,a){var s=Ua(e,n),c=Ua(t,n),u=a.get(c);if(u)La(e,n,u);else{var l,d=o?o(s,c,n+'',e,t,a):void 0,h=void 0===d;if(h){var p=ii(c),f=!p&&ro(c),g=!p&&!f&&ho(c);d=c,p||f||g?ii(s)?d=s:ri(l=s)&&zi(l)?d=Ti(s):f?(h=!1,d=Fo(c,!0)):g?(h=!1,d=Ea(c,!0)):d=[]:function(e){if(!ri(e)||'[object Object]'!=ni(e))return!1;var t=Po(e);if(null===t)return!0;var n=Go.call(t,'constructor')&&t.constructor;return'function'==typeof n&&n instanceof n&&Uo.call(n)==Wo}(c)||Qi(c)?(d=s,Qi(s)?d=function(e){return Bi(e,bo(e))}(s):oi(s)&&!si(s)||(d=wa(c))):h=!1}h&&(a.set(c,d),i(d,c,r,o,a),a.delete(c)),La(e,n,d)}}function Wa(e,t,n,r,i){e!==t&&xa(t,(function(o,a){if(i||(i=new jo),oi(o))Ga(e,t,a,n,Wa,r,i);else{var s=r?r(Ua(e,a),o,a+'',e,t,i):void 0;void 0===s&&(s=o),La(e,a,s)}}),bo)}var ja,Ma=(ja=function(e,t,n){Wa(e,t,n)},Hi((function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:void 0,o=r>2?t[2]:void 0;for(i=ja.length>3&&'function'==typeof i?(r--,i):void 0,o&&function(e,t,n){if(!oi(n))return!1;var r=typeof t;return!!('number'==r?zi(n)&&Ui(t,n.length):'string'==r&&t in n)&&Wi(n[t],e)}(t[0],t[1],o)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var a=t[n];a&&ja(e,a,n,i)}return e}))),Ba=function(e){s(u,e);var t,i,c=g(u);function u(e){var t;return r(this,u),a(p(t=c.call(this,e)),'_container',void 0),a(p(t),'_containerOldStyles',void 0),t}return o(u,[{key:'container',get:function(){return this._container}},{key:'_destroy',value:function(){this._container&&(this._containerOldStyles&&(this._container.style.position=this._containerOldStyles.position,this._containerOldStyles=void 0),this._container=void 0)}},{key:'_render',value:(i=n(regeneratorRuntime.mark((function e(t){var n,r,i,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._trigger.getSettings();case 2:return i=e.sent,o=null!==(n=null!==(r=t.selector)&&void 0!==r?r:i.selector)&&void 0!==n?n:bt,this._container=wt(o,t.root),this._containerOldStyles={position:this._container.style.position},this._element.src='https://widgets.noticeable.io/triggers/icon/index.html',this._container.style.position='relative',this._container.appendChild(this._element),this._childConnection=ct({iframe:this._element,methods:{getWidgetId:function(){return a._trigger.widget.id},getWindowLocationHref:function(){return window.location.href},toggle:function(){return a._trigger.widget.toggle()}}}),e.next=12,this._childConnection.promise;case 12:return this._child=e.sent,e.next=15,this.refresh();case 15:case'end':return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:'_refresh',value:(t=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,l,d,h,p,f,g,_,v,m,y,E,b,w,I,R,T,O,S,A;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._trigger.widget.getProjectLanguage(),o=this._trigger.getPublicationState(),a=this._trigger.getSettings(),s=0,l=0,d=0,e.t0=Da,e.next=9,a;case 9:return e.t1=e.sent,h=(0,e.t0)(e.t1),e.next=13,i;case 13:p=e.sent,f=h.badge.placement,U(p)&&(f=h.badge.placement===nn.START?nn.END:nn.START),g=h.badge.horizontalOffset,_=h.badge.verticalOffset,v=h.badge.counter===tn.NONE,m=v?10:20,y=0,E=0,b=0,w=0,I=0,e.t2=h.badge.animation,e.next=e.t2===en.BOUNCE?28:e.t2===en.PULSE?36:e.t2===en.NONE?44:e.t2===en.SHAKE?52:60;break;case 28:return s=1,c=Math.ceil((1.2*m-m)/2),l=c,d=Math.ceil(1.2*m+6.001-m),y=u.computeHeight(h.size,m,s,d,_),w=Math.max(0,_+d),I=u.computeWidth(h.size,f,m,l,c,g),e.abrupt('break',60);case 36:return s=Math.ceil(1.5*(1.625*m-m)/2+2),c=s,l=s,d=s,y=u.computeHeight(h.size,m,s,d,_),w=Math.max(0,_+d),I=u.computeWidth(h.size,f,m,l,c,g),e.abrupt('break',60);case 44:return s=0,c=0,l=0,d=0,y=u.computeHeight(h.size,m,s,d,_),w=Math.max(0,_+d),I=u.computeWidth(h.size,f,m,0,0,g),e.abrupt('break',60);case 52:return s=0,c=3,l=2,d=0,y=u.computeHeight(h.size,m,s,d,_),w=Math.max(0,_+d),I=u.computeWidth(h.size,f,m,l,c,g),e.abrupt('break',60);case 60:return R=h.size-m+g-l,f===nn.END?R<0?(E=-R,b=0):(E=0,b=g-l):f===nn.START&&(R<0?(E=0,b=0):(E=g+l,b=0)),S=0,(O=_+d)>0&&(S-=O),(T=_-m-s)<-h.size&&(S+=-h.size-T),null!==(t=this._element)&&void 0!==t&&null!==(n=t.parentElement)&&void 0!==n&&n.style&&(this._element.parentElement.style.marginTop='0px'),this._element.style.height=G(y),this._element.style.marginTop=G(S),this._element.style.width=G(I),this._element.style.zIndex='2147482942',h.marginLeft=E,h.marginRight=b,h.marginTop=w,e.next=77,o;case 77:if(A=e.sent,h.hideBehavior!==En.WHEN_ALL_READ||0!==A.unreadCount){e.next=83;break}return e.next=81,this.hide();case 81:case 86:e.next=90;break;case 83:if(h.hideBehavior!==En.WHEN_ALL_SEEN||0!==A.unseenCount){e.next=88;break}return e.next=86,this.hide();case 88:return e.next=90,this.show();case 90:return e.next=92,null===(r=this._child)||void 0===r?void 0:r.refresh(h,A,p);case 92:if(!A.openWidgets){e.next=95;break}return e.next=95,this._trigger.widget.open();case 95:case'end':return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:'computeHeight',value:function(e,t,n,r,i){var o=i-t-n,a=i+r,s=-e;return Math.max(a,0)-Math.min(o,s)}},{key:'computeWidth',value:function(e,t,n,r,i,o){var a=e-n+o+n+i,s=e-n+o-r;t===nn.START&&(a=-o+n+i,s=-o-r);var c=e;return Math.max(a,c)-Math.min(s,0)}}]),u}(gt),Va=function(e){s(c,e);var t,i,a=g(c);function c(e){return r(this,c),a.call(this,e,document.createElement('div'),(function(){}),(function(){}),(function(){}))}return o(c,[{key:'_render',value:(i=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',{});case 1:case'end':return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:'_refresh',value:(t=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',{});case 1:case'end':return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),c}(ft),Ha=function(){function e(t,n){r(this,e),a(this,'_view',void 0),a(this,'_widget',void 0),this._view=this._createView(n),this._widget=t}var t,i,s,c;return o(e,[{key:'areAllPublicationRead',value:(c=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',this._widget.areAllPublicationRead());case 1:case'end':return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:'destroy',value:function(){this._view.destroy()}},{key:'eventRegistry',get:function(){return this._widget.eventRegistry}},{key:'view',get:function(){return this._view}},{key:'widget',get:function(){return this._widget}},{key:'getPublicationState',value:(s=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt('return',this._widget.getPublicationState());case 1:case'end':return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:'getSettings',value:(i=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._widget.getWidgetData();case 2:return t=e.sent,e.abrupt('return',t.triggerViewSettings);case 4:case'end':return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:'hide',value:function(){this._view.hide()}},{key:'render',value:(t=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._view.render(t);case 2:case'end':return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:'show',value:function(){this._view.show()}},{key:'visible',get:function(){return this._view.visible}},{key:'_createView',value:function(e){switch(e){case'badge':return new Hr(this);case'custom':return new Fr(this);case'floating-button':return new zr(this);case'icon':return new Ba(this);case'none':return new Va(this);default:throw new Error('Unknown trigger type: '.concat(e))}}}]),e}(),Fa=function(){function e(t,n,i,o,s,c){r(this,e),a(this,'_dataRepository',void 0),a(this,'_eventRegistry',void 0),a(this,'_id',void 0),a(this,'_identity',void 0),a(this,'_loading',void 0),a(this,'_opened',void 0),a(this,'_projectId',void 0),a(this,'_publicationFetchOptions',void 0),a(this,'_renderOptions',void 0),a(this,'_trigger',void 0),a(this,'_view',void 0),this._dataRepository=i,this._eventRegistry=o,this._id=t,this._identity=s,this._loading=!1,this._opened=!1,this._projectId=n.projectId,this._renderOptions={},this._trigger=new Ha(this,n.triggerView),this._view=this._createView(c)}var t,i,s,c,u,l,d,h,p,f,g,_,v,m,y,E,b,I,T,O;return o(e,[{key:'alreadyRendered',value:(O=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._trigger.view.alreadyRendered(t);case 2:return e.abrupt('return',this._view.alreadyRendered(t));case 3:case'end':return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:'areAllPublicationRead',value:(T=n(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPublicationData();case 2:return t=e.sent,e.next=5,this.getLastPublicationRead();case 5:return n=e.sent,e.abrupt('return',t.every((function(e){return n.has(e.id)})));case 7:case'end':return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:'close',value:(I=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._opened){e.next=2;break}return e.abrupt('return');case 2:return this._opened=!1,e.next=5,this.hide();case 5:this.eventRegistry.dispatchEvent(this.id,R.WIDGET_CLOSED);case 6:case'end':return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:'destroy',value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&this._eventRegistry.removeListeners(this._id),this._trigger.destroy(),this._view.destroy()}},{key:'eventRegistry',get:function(){return this._eventRegistry}},{key:'identity',get:function(){return this._identity}},{key:'opened',get:function(){return this._opened}},{key:'visible',get:function(){return this._trigger.visible&&this._view.visible}},{key:'getProjectLanguage',value:(b=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProjectData();case 2:return e.abrupt('return',e.sent.language);case 3:case'end':return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:'getLastPublicationRead',value:function(){return this._identity.getLastPublicationRead(this._projectId)}},{key:'getLastPublicationSeen',value:function(){return this._identity.getLastPublicationSeen(this._projectId)}},{key:'getProjectData',value:(E=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dataRepository.getProjectData(this._projectId);case 2:if(t=e.sent){e.next=5;break}throw new Error('Error while retrieving project data: '+this._projectId);case 5:return t.id=this._projectId,e.abrupt('return',t);case 7:case'end':return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:'getPublicationData',value:(y=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dataRepository.getPublicationData(this._projectId,this._publicationFetchOptions);case 2:if(t=e.sent){e.next=5;break}throw new Error('Error while retrieving publication data for project '+this._projectId);case 5:return e.abrupt('return',t);case 6:case'end':return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:'getPublicationState',value:(m=n(regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d,h,p,f,g,_,v,m,y,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.getPublicationData(),a=this.getWidgetData(),s=this.getLastPublicationRead(),c=this.getLastPublicationSeen(),u=null,l=0,d=0,e.next=9,a;case 9:return h=e.sent,p=(null==h||null===(t=h.widgetViewSettings)||void 0===t?void 0:t.maxPublicationCount)||9,e.next=13,o;case 13:f=e.sent,g=0,_=w(f),e.prev=16,_.s();case 18:if((v=_.n()).done){e.next=28;break}if(y=v.value,!(g>=p)){e.next=22;break}return e.abrupt('break',28);case 22:(null==u||null!==(m=y.publicationTimestamp>u.publicationTimestamp)&&void 0!==m&&m)&&(u=y),s.has(y.id)||l++,c.has(y.id)||d++,g++;case 26:e.next=18;break;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(16),_.e(e.t0);case 33:return e.prev=33,_.f(),e.finish(33);case 36:return E=null!==(n=null===(r=u)||void 0===r?void 0:r.openWidgets)&&void 0!==n&&n,e.abrupt('return',{lastPublicationRead:s,lastPublicationSeen:c,openWidgets:E&&d>0,publicationIds:f.map((function(e){return e.id})),unreadCount:Math.min(l,p),unseenCount:c.has(null===(i=u)||void 0===i?void 0:i.id)?0:Math.min(d,p)});case 38:case'end':return e.stop()}}),e,this,[[16,30,33,36]])}))),function(){return m.apply(this,arguments)})},{key:'getTriggerSettings',value:(v=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getWidgetData();case 2:return e.abrupt('return',e.sent.triggerViewSettings);case 3:case'end':return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:'getWidgetData',value:(_=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dataRepository.getWidgetData(this._id);case 2:if(t=e.sent){e.next=5;break}throw new Error('Error while retrieving widget data: '+this._id);case 5:return e.abrupt('return',t);case 6:case'end':return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:'hide',value:(g=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._view.visible){e.next=2;break}return e.abrupt('return');case 2:return e.next=4,this._view.hide();case 4:this.eventRegistry.dispatchEvent(this.id,R.WIDGET_HIDDEN);case 5:case'end':return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:'id',get:function(){return this._id}},{key:'open',value:(f=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._opened){e.next=2;break}return e.abrupt('return');case 2:return this._opened=!0,e.next=5,this.show();case 5:this.eventRegistry.dispatchEvent(this.id,R.WIDGET_OPENED);case 6:case'end':return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:'projectId',get:function(){return this._projectId}},{key:'toggle',value:(p=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._opened){e.next=5;break}return e.next=3,this.close();case 3:e.next=7;break;case 5:return e.next=7,this.open();case 7:case'end':return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:'trigger',get:function(){return this._trigger}},{key:'render',value:(h=n(regeneratorRuntime.mark((function e(t){var n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getWidgetData();case 2:return o=e.sent,this._publicationFetchOptions={limit:this._view.publicationFetchLimit},null!=t&&t.labels?this._publicationFetchOptions.labels=t.labels:null!==(n=o.widgetViewSettings)&&void 0!==n&&n.labels&&(this._publicationFetchOptions.labels=null===(a=o.widgetViewSettings)||void 0===a?void 0:a.labels),null!=t&&t.segments?this._publicationFetchOptions.segments=t.segments:null!==(r=o.widgetViewSettings)&&void 0!==r&&r.segments&&(this._publicationFetchOptions.segments=o.widgetViewSettings.segments),null!=t&&t.segmentsOperator?this._publicationFetchOptions.segmentsOperator=t.segmentsOperator:null!==(i=o.widgetViewSettings)&&void 0!==i&&i.segmentsOperator?this._publicationFetchOptions.segmentsOperator=o.widgetViewSettings.segmentsOperator:this._view.segmentsOperator&&(this._publicationFetchOptions.segmentsOperator=this._view.segmentsOperator),this._renderOptions=t||{},e.next=10,this._view.render(t);case 10:case'end':return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:'refresh',value:(d=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._opened){e.next=7;break}return e.next=3,this.trigger.getPublicationState();case 3:if(!((t=e.sent).unseenCount>0)){e.next=7;break}return e.next=7,this.setPublicationSeen(t.publicationIds,{merge:!0});case 7:return e.next=9,Promise.allSettled([this.trigger.view.refresh(),this._view.refresh()]);case 9:case'end':return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:'renderOptions',get:function(){return this._renderOptions}},{key:'reset',value:(l=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.destroy(!1),e.abrupt('return',this.render(this._renderOptions));case 2:case'end':return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:'setPublicationRead',value:(u=n(regeneratorRuntime.mark((function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPublicationState();case 2:return r=e.sent,i=this._identity.setLastPublicationRead(this._projectId,t,n),o=this.trigger.view.refresh(),e.next=7,Promise.allSettled([i,o]);case 7:return e.next=9,this.getPublicationState();case 9:return a=e.sent,r.unreadCount!==a.unreadCount&&this._eventRegistry.dispatchEvent(this.id,R.WIDGET_PUBLICATION_UNREAD_COUNT_CHANGED,{value:a.unreadCount}),e.abrupt('return',i);case 12:case'end':return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:'setPublicationSeen',value:(c=n(regeneratorRuntime.mark((function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPublicationState();case 2:return r=e.sent,i=this._identity.setLastPublicationSeen(this._projectId,t,n),o=this.trigger.view.refresh(),e.next=7,Promise.allSettled([i,o]);case 7:return e.next=9,this.getPublicationState();case 9:return a=e.sent,r.unseenCount!==a.unseenCount&&this._eventRegistry.dispatchEvent(this.id,R.WIDGET_PUBLICATION_UNSEEN_COUNT_CHANGED,{value:a.unseenCount}),e.abrupt('return',i);case 12:case'end':return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:'show',value:(s=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._view.visible){e.next=2;break}return e.abrupt('return');case 2:return e.next=4,this._view.show();case 4:this.eventRegistry.dispatchEvent(this.id,R.WIDGET_VISIBLE);case 5:case'end':return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:'updateTriggerViewSettings',value:(i=n(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dataRepository.getWidgetData(t);case 2:(r=e.sent)&&(r.triggerViewSettings=Ma(r.triggerViewSettings,n));case 4:case'end':return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:'updateWidgetViewSettings',value:(t=n(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dataRepository.getWidgetData(t);case 2:(r=e.sent)&&(r.widgetViewSettings=Ma(r.widgetViewSettings,n));case 4:case'end':return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:'_createView',value:function(e){switch(e){case'modal':return new Et(this);case'newspage-embed':return new Gt(this);case'popup':return new Br(this);case'top-banner':return new Vr(this);default:throw new Error('Unknown view type: '.concat(e))}}},{key:'_updateViewsWithNewIdentity',value:function(){var e=this.identity.getUserId(this._projectId),t=this.identity.getUserTraits(this._projectId),n=this.identity.getVisitorId(this._projectId);this._trigger.view._onIdentityChange(e,t,n),this._view._onIdentityChange(e,t,n)}}]),e}(),za=function(){function t(){r(this,t),a(this,'version','2.0.0 (commit 4751956)'),a(this,'_autoRefresher',void 0),a(this,'_dataRepository',void 0),a(this,'_eventRegistry',void 0),a(this,'_identity',void 0),a(this,'_preferences',void 0),a(this,'_renderedWidgets',void 0),a(this,'_widgets',void 0),this._eventRegistry=new S,this._preferences={crossDeviceSynchronization:void 0,firstPartyCookies:{localStorage:!0,retentionPeriod:31536e6}},this._renderedWidgets=new Set,this._widgets=new Map,this._autoRefresher=new C(this._widgets),this._dataRepository=new H(this._autoRefresher),this._identity=new Xe(this._dataRepository,this._preferences)}var i,s,c,u,l,d,h,p,f,g,_;return o(t,[{key:'initialize',value:(_=n(regeneratorRuntime.mark((function e(n){var r,i,o,a,s,c,u,l,d,h,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!/baidu|bing|bot|duckduckbot|exabot|facebook|google|ia_archiver|msn|qwant|teoma|slurp|sogou|yandex/i.test(navigator.userAgent)){e.next=3;break}return A.warn('Noticeable SDK initialization aborted because the request seems to come from a bot.'),e.abrupt('return');case 3:window.noticeable=this,r=[],i=w(n),e.prev=6,i.s();case 8:if((o=i.n()).done){e.next=19;break}if('set'!==(a=o.value)[0]||'preferences'!==a[1]){e.next=16;break}return a.shift(),e.next=14,this._reifySetCommand(a);case 14:e.next=17;break;case 16:r.push(a);case 17:e.next=8;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(6),i.e(e.t0);case 24:return e.prev=24,i.f(),e.finish(24);case 27:for(this._identity.initialize(),s=[],u=0,l=r;u<l.length;u++)'ready'===(d=l[u])[0]?(void 0!==c&&A.warn('Multiple \'ready\' callback registered. Only the last one before the SDK initialization will be used'),d.shift(),c=t._reifyReadyCommand(d)):s.push(d);void 0!==c&&c(),h=0,p=s;case 32:if(!(h<p.length)){e.next=39;break}return f=p[h],e.next=36,this._reifyCommand(f);case 36:h++,e.next=32;break;case 39:return e.abrupt('return');case 40:case'end':return e.stop()}}),e,this,[[6,21,24,27]])}))),function(e){return _.apply(this,arguments)})},{key:'debug',value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t._checkCommandParameterType('debug',e,0,1,'boolean'),A.setLevel(e?O.DEBUG:O.INFO),A.info('Debug mode '.concat(e?'enabled':'disabled'))}},{key:'destroy',value:(g=n(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._checkCommandParameterType('destroy',n,0,2,'string'),t._checkCommandParameterType('destroy',r,1,2,'string'),A.debug('Calling destroy('.concat(n,', ').concat(r,')')),e.t0=n,e.next=e.t0===Fe.WIDGET?6:9;break;case 6:return e.next=8,this._destroyWidget(r);case 8:return e.abrupt('return');case 9:T('Unknown component: '.concat(n));case 10:case'end':return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:'do',value:function(e,n){var r,i,o,a,s,c;switch(t._checkCommandParameterType('do',e,0,2,'string'),t._checkCommandParameterType('do',n,1,2),Object.values(W).includes(e)||T('Unknown \'do\' action: '.concat(e)),A.debug('Calling do('.concat(e,', ').concat(JSON.stringify(n),')')),e){case W.IDENTITY_PUBLICATION_READ_INVALIDATE:return void this._identity.clearLastPublicationRead();case W.IDENTITY_PUBLICATION_SEEN_INVALIDATE:return void this._identity.clearLastPublicationSeen();case W.PROJECT_DATA_INVALIDATE:return void this._dataRepository.invalidateProjectData(n);case W.PUBLICATION_DATA_INVALIDATE:return void this._dataRepository.invalidatePublicationData(n);case W.WIDGET_DATA_INVALIDATE:return void this._dataRepository.invalidateWidgetData(n);case W.WIDGET_CLOSE:return void(null===(r=this._getWidget(n,'do',e))||void 0===r||r.close());case W.WIDGET_HIDE:return void(null===(i=this._getWidget(n,'do',e))||void 0===i||i.hide());case W.WIDGET_OPEN:return void(null===(o=this._getWidget(n,'do',e))||void 0===o||o.open());case W.WIDGET_REFRESH:return void(null===(a=this._getWidget(n,'do',e))||void 0===a||a.refresh());case W.WIDGET_SHOW:return void(null===(s=this._getWidget(n,'do',e))||void 0===s||s.show());case W.WIDGET_TOGGLE:return void(null===(c=this._getWidget(n,'do',e))||void 0===c||c.toggle())}A.warn('Unknown property for \'do\' action: '.concat(e))}},{key:'help',value:function(){A.info('Visit the next page to learn more about the Noticeable JavaScript SDK:\nhttps://help.noticeable.io/en-us/article/how-to-use-noticeable-javascript-sdk-7k5kc2')}},{key:'get',value:function(){var e=n(regeneratorRuntime.mark((function e(n,r){var i,o,a,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._checkCommandParameterType('is',n,0,2,'string'),t._checkCommandParameterType('is',r,1,2,'string'),A.debug('Calling get('.concat(n,', ').concat(r,')')),e.t0=n,e.next=e.t0===j.WIDGET_PUBLICATION_READ?6:e.t0===j.WIDGET_PUBLICATION_SEEN?7:e.t0===j.WIDGET_PUBLICATION_UNREAD_COUNT?8:e.t0===j.WIDGET_PUBLICATION_UNSEEN_COUNT?12:16;break;case 6:return e.abrupt('return',null===(i=this._getWidget(r,'get',n))||void 0===i?void 0:i.getLastPublicationRead());case 7:return e.abrupt('return',null===(o=this._getWidget(r,'get',n))||void 0===o?void 0:o.getLastPublicationSeen());case 8:return e.next=10,null===(a=this._getWidget(r,'get',n))||void 0===a?void 0:a.getPublicationState();case 10:return c=e.sent,e.abrupt('return',c.unreadCount);case 12:return e.next=14,null===(s=this._getWidget(r,'get',n))||void 0===s?void 0:s.getPublicationState();case 14:return c=e.sent,e.abrupt('return',c.unseenCount);case 16:return A.warn('Unknown get action: '.concat(n)),e.abrupt('return',null);case 18:case'end':return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:'identify',value:(f=n(regeneratorRuntime.mark((function e(n,r){var i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._checkCommandParameterType('identify',n,0,2,'string'),t._checkCommandParameterType('identify',r,1,2,'object'),A.debug('Calling identity('.concat(n,', ').concat(JSON.stringify(r),')')),e.next=5,this._identity.update(n,r);case 5:i=w(this._widgets.values());try{for(i.s();!(o=i.n()).done;)o.value._updateViewsWithNewIdentity()}catch(e){i.e(e)}finally{i.f()}case 7:case'end':return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:'is',value:function(e,n){var r,i,o,a,s,c,u,l;switch(t._checkCommandParameterType('is',e,0,2,'string'),t._checkCommandParameterType('is',n,1,2,'string'),A.debug('Calling is('.concat(e,', ').concat(n,')')),e){case M.WIDGET_CLOSED:return null!==(r=!(null!==(i=this._getWidget(n,'is',e))&&void 0!==i&&i.opened))&&void 0!==r&&r;case M.WIDGET_HIDDEN:return null!==(o=!(null!==(a=this._getWidget(n,'is',e))&&void 0!==a&&a.visible))&&void 0!==o&&o;case M.WIDGET_OPENED:return null!==(s=null===(c=this._getWidget(n,'is',e))||void 0===c?void 0:c.opened)&&void 0!==s&&s;case M.WIDGET_VISIBLE:return null!==(u=null===(l=this._getWidget(n,'is',e))||void 0===l?void 0:l.visible)&&void 0!==u&&u}return A.warn('Unknown property for is action: '.concat(e)),!1}},{key:'off',value:function(e,t){if(e||t)return e&&t?(A.debug('Calling off('.concat(e,', ').concat(t,')')),void this._eventRegistry.removeListener(t,e)):e&&!t?(A.debug('Calling off('.concat(e,')')),void this._eventRegistry.removeListenersByEventType(e)):(A.debug('Calling off('.concat(e,', ').concat(t,')')),void this._eventRegistry.removeListeners(t));A.debug('Calling off()');var n,r=w(this._widgets.keys());try{for(r.s();!(n=r.n()).done;){var i=n.value;this._eventRegistry.removeListeners(i)}}catch(e){r.e(e)}finally{r.f()}}},{key:'on',value:function(e,n,r){t._checkCommandParameterType('on',e,0,3,'string'),t._checkCommandParameterType('on',n,1,3,'string'),t._checkCommandParameterType('on',r,2,3,'function'),A.debug('Calling on('.concat(e,', ').concat(n,', callback)')),this._eventRegistry.setListener(e,n,r)}},{key:'ready',value:function(e){t._checkCommandParameterType('ready',e,0,1,'function'),A.warn('Skipping ready callback invoked after SDK initialization')}},{key:'render',value:(p=n(regeneratorRuntime.mark((function e(n,r){var i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=o.length>2&&void 0!==o[2]?o[2]:{},t._checkCommandParameterType('render',n,0,3,'string'),t._checkCommandParameterType('render',r,1,3,'string'),t._checkCommandParameterType('render',i,2,3,'object'),A.debug('Calling render(%s, %s, %o)',n,r,i),e.t0=n,e.next=e.t0===Fe.WIDGET?8:11;break;case 8:return e.next=10,this._renderWidget(r,i);case 10:return e.abrupt('return');case 11:T('Unknown component: '.concat(n));case 12:case'end':return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:'refresh',value:(h=n(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=w(this._widgets);try{for(n.s();!(r=n.n()).done;)i=r.value,t.push(i[1].refresh())}catch(e){n.e(e)}finally{n.f()}return e.abrupt('return',Promise.all(t));case 4:case'end':return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:'reset',value:(d=n(regeneratorRuntime.mark((function e(t){var n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A.debug('Calling reset()'),this._identity.reset(t),n=[],r=w(this._widgets);try{for(r.s();!(i=r.n()).done;)(o=m(i.value,2))[0],a=o[1],t&&a.projectId!==t||n.push(a.reset())}catch(e){r.e(e)}finally{r.f()}return e.abrupt('return',Promise.all(n));case 6:case'end':return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:'safe',value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t._checkCommandParameterType('debug',e,0,1,'boolean'),A.debug('Calling safe('.concat(e,')')),A.setLevel(O.ERROR)}},{key:'set',value:(l=n(regeneratorRuntime.mark((function e(n,r,i,o){var a,s,c,u,l,d,h,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._checkCommandParameterType('set',r,1,4),A.debug('Calling set(%s, %s, %o)',n,r,i),e.t0=n,e.next=e.t0===B.PREFERENCES?5:e.t0===B.WIDGET_PUBLICATION_READ||e.t0===B.WIDGET_PUBLICATION_SEEN?12:e.t0===B.WIDGET_TRIGGER_VIEW_SETTINGS?28:e.t0===B.WIDGET_WIDGET_VIEW_SETTINGS?34:40;break;case 5:return'boolean'==typeof(null==r||null===(a=r.cacheControl)||void 0===a?void 0:a.projects)&&this._dataRepository.setProjectCacheControl(r.cacheControl.projects),'boolean'==typeof(null==r||null===(s=r.cacheControl)||void 0===s?void 0:s.publications)&&this._dataRepository.setPublicationCacheControl(r.cacheControl.publications),'boolean'==typeof(null==r||null===(c=r.cacheControl)||void 0===c?void 0:c.widgets)&&this._dataRepository.setWidgetCacheControl(r.cacheControl.widgets),'boolean'==typeof(null==r?void 0:r.crossDeviceSynchronization)&&(this._preferences.crossDeviceSynchronization=r.crossDeviceSynchronization),'boolean'==typeof(null==r||null===(u=r.firstPartyCookies)||void 0===u?void 0:u.localStorage)&&(this._preferences.firstPartyCookies.localStorage=r.firstPartyCookies.localStorage),'number'==typeof(null==r||null===(l=r.firstPartyCookies)||void 0===l?void 0:l.retentionPeriod)&&(this._preferences.firstPartyCookies.retentionPeriod=r.firstPartyCookies.retentionPeriod),e.abrupt('return');case 12:if('string'==typeof i&&(i=[i]),'string'==typeof i||Array.isArray(i)){e.next=16;break}return A.error('Invalid value \''.concat(i,'\' set for action \'').concat(n,'\'')),e.abrupt('return');case 16:if(!(d=this._getWidget(r,'set',n))){e.next=27;break}if(n!==B.WIDGET_PUBLICATION_READ){e.next=23;break}return e.next=21,d.setPublicationRead(i,{merge:null!==(h=null==o?void 0:o.merge)&&void 0!==h&&h});case 21:e.next=26;break;case 23:if(n!==B.WIDGET_PUBLICATION_SEEN){e.next=26;break}return e.next=26,d.setPublicationSeen(i,{merge:null!==(p=null==o?void 0:o.merge)&&void 0!==p&&p});case 26:return e.abrupt('return',d.refresh());case 27:return e.abrupt('return');case 28:if(!(d=this._getWidget(r,'set',n))){e.next=33;break}return e.next=32,d.updateTriggerViewSettings(r,i);case 32:return e.abrupt('return',d.refresh());case 33:return e.abrupt('return');case 34:if(!(d=this._getWidget(r,'set',n))){e.next=39;break}return e.next=38,d.updateWidgetViewSettings(r,i);case 38:return e.abrupt('return',d.refresh());case 39:return e.abrupt('return');case 40:A.warn('Unknown set action \''.concat(n,'\''));case 41:case'end':return e.stop()}}),e,this)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:'_destroyWidget',value:(u=n(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._widgets.get(t)){e.next=4;break}return A.warn('Could not find widget '.concat(t,' for destruction')),e.abrupt('return');case 4:return e.next=6,n.destroy();case 6:this._widgets.delete(t),this._renderedWidgets.delete(t);case 8:case'end':return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:'_getWidget',value:function(e,t,n){var r=this._widgets.get(e);if(r)return r;A.debug('Could not find widget '.concat(e,' for ').concat(t,' ').concat(n))}},{key:'_renderWidget',value:(c=n(regeneratorRuntime.mark((function t(n,r){var i,o,a,s,c,u,l,d,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.segments){Array.isArray(r.segments)||T('Incorrect segments value for widget \''.concat(n,'\': expected array, received ')+e(r.segments)),i=w(r.segments);try{for(i.s();!(o=i.n()).done;)'string'!=typeof(a=o.value)&&T('Invalid segment value for widget \''.concat(n,'\': expected string, received ')+e(a)),a.startsWith('Noticeable:')&&A.warn('Segments starting with \'Noticeable:\' are reserved for internal purposes. Your segment will be ignored: '.concat(a))}catch(e){i.e(e)}finally{i.f()}}if(this._renderedWidgets.has(n)){t.next=40;break}return this._renderedWidgets.add(n),t.next=5,this._dataRepository.getWidgetData(n);case 5:if(s=t.sent){t.next=9;break}return this.abortWidgetRendering(n,'Skipping widget rendering due to missing widget data for ID '.concat(n,'. Are you sure your widget ID is correct?'),I.WIDGET_DATA_MISSING),t.abrupt('return');case 9:if(s.enabled){t.next=12;break}return this.abortWidgetRendering(n,'Skipping rendering because widget '.concat(n,' is disabled'),I.WIDGET_DISABLED),t.abrupt('return');case 12:if('boolean'!=typeof s.widgetViewSettings.mobile||s.widgetViewSettings.mobile||!L()){t.next=15;break}return this.abortWidgetRendering(n,'Skipping rendering for widget '.concat(n,' because the current device is detected as a mobile and the widget is configured to not display on such devices'),I.WIDGET_DISABLED_MOBILE),t.abrupt('return');case 15:return t.next=17,this._dataRepository.getProjectData(s.projectId);case 17:if(c=t.sent){t.next=21;break}return this.abortWidgetRendering(n,'Skipping rendering due to missing project data for widget '.concat(n),I.PROJECT_DATA_MISSING),t.abrupt('return');case 21:if(p=s.widgetView,u=In[p],ge.from(c.planId).includes(u)){t.next=25;break}return this.abortWidgetRendering(n,'Skipping rendering for widget '.concat(n,' of type ').concat(s.widgetView,' because you need to upgrade to the ').concat(ge.include(u)[0].title,' plan or higher to get this widget working.'),I.PLAN_UPGRADE_REQUIRED),t.abrupt('return');case 25:if(l=new Fa(n,s,this._dataRepository,this._eventRegistry,this._identity,s.widgetView),this._widgets.set(n,l),!(d=this._identity.getPendingIdentityUpdate(s.projectId))){t.next=33;break}return t.next=31,d;case 31:t.next=35;break;case 33:return t.next=35,this._identity.remoteIdentityUpdate(s.projectId);case 35:return t.next=37,l.render(r);case 37:l._updateViewsWithNewIdentity(),t.next=41;break;case 40:null===(h=this._widgets.get(n))||void 0===h||h.alreadyRendered(r);case 41:case'end':return t.stop()}var p}),t,this)}))),function(e,t){return c.apply(this,arguments)})},{key:'abortWidgetRendering',value:function(e,t,n){A.warn(t),this._renderedWidgets.delete(e),this._eventRegistry.dispatchEvent(e,R.WIDGET_RENDERING_ABORTED,{reason:n})}},{key:'_reifyCommand',value:(s=n(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n[0],n.shift(),e.t0=r,e.next='debug'===e.t0?5:'destroy'===e.t0?7:'do'===e.t0?9:'help'===e.t0?11:'identify'===e.t0?13:'off'===e.t0?15:'on'===e.t0?17:'ready'===e.t0?19:'render'===e.t0?21:'reset'===e.t0?24:'safe'===e.t0?26:'set'===e.t0?28:30;break;case 5:return this._reifyDebugCommand(n),e.abrupt('break',31);case 7:return this._reifyDestroyCommand(n),e.abrupt('break',31);case 9:return this._reifyDoCommand(n),e.abrupt('break',31);case 11:return this._reifyHelpCommand(n),e.abrupt('break',31);case 13:return this._reifyIdentifyCommand(n),e.abrupt('break',31);case 15:return this._reifyOffCommand(n),e.abrupt('break',31);case 17:return this._reifyOnCommand(n),e.abrupt('break',31);case 19:return t._reifyReadyCommand(n),e.abrupt('break',31);case 21:return e.next=23,this._reifyRenderCommand(n);case 23:return e.abrupt('break',31);case 24:return this._reifyResetCommand(n),e.abrupt('break',31);case 26:return this._reifySafeCommand(n),e.abrupt('break',31);case 28:return this._reifySetCommand(n),e.abrupt('break',31);case 30:A.error('Unknown command:',r);case 31:case'end':return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:'_reifyDebugCommand',value:function(e){t._checkCommandArity('debug',e,0,1),0===e.length?this.debug():this.debug(e[0])}},{key:'_reifyDestroyCommand',value:function(e){t._checkCommandArity('destroy',e,2),this.destroy(e[0],e[1])}},{key:'_reifyDoCommand',value:function(e){t._checkCommandArity('do',e,2),this.do(e[0],e[1])}},{key:'_reifyHelpCommand',value:function(e){t._checkCommandArity('help',e,0),this.help()}},{key:'_reifyIdentifyCommand',value:function(e){t._checkCommandArity('identify',e,2),this.identify(e[0],e[1])}},{key:'_reifyIsCommand',value:function(e){t._checkCommandArity('is',e,2),this.is(e[0],e[1])}},{key:'_reifyOffCommand',value:function(e){t._checkCommandArity('off',e,0,2),0!==e.length?1!==e.length?this.off(e[0],e[1]):this.off(e[0]):this.off()}},{key:'_reifyOnCommand',value:function(e){t._checkCommandArity('on',e,3),this.on(e[0],e[1],e[2])}},{key:'_reifyRenderCommand',value:(i=n(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._checkCommandArity('render',n,2,3),e.abrupt('return',this.render(n[0],n[1],3===n.length?n[2]:void 0));case 2:case'end':return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:'_reifyResetCommand',value:function(e){return t._checkCommandArity('reset',e,0,1),0===e.length?this.reset():this.reset(e[0])}},{key:'_reifySafeCommand',value:function(e){t._checkCommandArity('safe',e,0,1),0===e.length?this.safe():this.safe(e[0])}},{key:'_reifySetCommand',value:function(e){return t._checkCommandArity('set',e,2,4),this.set(e[0],e[1],e[2],e[3])}}],[{key:'_checkCommandArity',value:function(e,t,n,r){void 0===r&&(r=n),(t.length<n||t.length>r)&&T('Invalid arity for command \''.concat(e,'\': expected between ').concat(n,' and ').concat(r,' arguments but received ').concat(t.length))}},{key:'_checkCommandParameterType',value:function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,a=e(n);r>=i||void 0!==o&&a!==o&&T('Invalid argument type at index '.concat(r,' for command \'').concat(t,'\': expected ').concat(o,' but received ').concat(a))}},{key:'_reifyReadyCommand',value:function(e){return t._checkCommandArity('ready',e,1),e[0]}}]),t}();if(window.noticeable instanceof za)console.error('Noticeable SDK included twice');else{var Ya=window.noticeable;(new za).initialize(Ya)}}();
